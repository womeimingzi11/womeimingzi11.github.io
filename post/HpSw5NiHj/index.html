<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Using R for everything: æ–¹å·®åˆ†è§£ï¼ˆVariation partitionï¼‰å˜é‡ç­›é€‰ä¸æ˜¾è‘—æ€§æ ‡æ³¨ | æ´—è¡£æœºç”¨æˆ·ä¸ä¼šç”¨æ´—è¡£æœº</title>
<meta name="description" content="Why be a researcher if you can be an Engineer?">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://womeimingzi11.github.io/favicon.ico?v=1600980679242">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://womeimingzi11.github.io/styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />



  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://womeimingzi11.github.io">
        <img src="https://womeimingzi11.github.io/images/avatar.png?v=1600980679242" class="site-logo">
        <h1 class="site-title">æ´—è¡£æœºç”¨æˆ·ä¸ä¼šç”¨æ´—è¡£æœº</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      Why be a researcher if you can be an Engineer?
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://womeimingzi11.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Using R for everything: æ–¹å·®åˆ†è§£ï¼ˆVariation partitionï¼‰å˜é‡ç­›é€‰ä¸æ˜¾è‘—æ€§æ ‡æ³¨</h2>
            <div class="post-date">2020-05-11</div>
            
              <div class="feature-container" style="background-image: url('https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/output_5_1.png')">
              </div>
            
            <div class="post-content">
              <h2 id="ä½•ä¸ºæ–¹å·®åˆ†è§£">ä½•ä¸ºæ–¹å·®åˆ†è§£ï¼Ÿ</h2>
<p>å…³äºæ–¹å·®åˆ†è§£çš„æ•°å­¦åŸç†ï¼Œåœ¨ GUSTA ME è¿™ç¯‡æ–‡ç«  <strong><a href="https://mb3is.megx.net/gustame/constrained-analyses/variation-partitioning">Variation partitioning</a></strong> æœ‰éå¸¸æ¸…æ™°ä¸”å®¹æ˜“ç†è§£çš„ä»‹ç»ã€‚</p>
<p>å¼•ç”¨ç»ç®¡ä¹‹å®¶ç½‘å‹ <a href="https://bbs.pinggu.org/home.php?mod=space&amp;uid=1801145">lovecather668</a> åœ¨**<a href="https://bbs.pinggu.org/thread-1125443-1-1.html">varä¸­æ–¹å·®åˆ†è§£çš„æ„ä¹‰</a>** ä¸­çš„å›ç­”ï¼š</p>
<blockquote>
<p>VARä¸­çš„æ–¹å·®åˆ†è§£æ˜¯åˆ†æå½±å“å†…ç”Ÿå˜é‡çš„ç»“æ„å†²å‡»çš„è´¡çŒ®åº¦ã€‚ä¾‹å¦‚ï¼Œæœ‰å¥½å¤šè¡Œä¸šäº§å“çš„éœ€æ±‚å˜åŠ¨ä¼šå¯¹é’¢é“è¡Œä¸šäº§å“çš„éœ€æ±‚å˜åŠ¨äº§ç”Ÿå½±å“ï¼Œåƒå»ºæè¡Œä¸šã€æ±½è½¦è¡Œä¸šã€æœºæ¢°è¡Œä¸šã€å®¶ç”µè¡Œä¸šã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³è¦çŸ¥é“è¿™4ä¸ªè¡Œä¸šçš„éœ€æ±‚å˜åŒ–å¯¹é’¢é“è¡Œä¸šçš„éœ€æ±‚å˜åŒ–äº§ç”Ÿçš„å½±å“å“ªä¸ªå¤§ã€å“ªä¸ªå°å‘¢ï¼Œå°±å¯ä»¥ç”¨æ–¹å·®åˆ†è§£æ¥åšã€‚åšå‡ºæ¥çš„ç»“æœæ˜¯ç”¨è´¡çŒ®ç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰æ¥è¡¨ç¤ºçš„ï¼Œå¦‚å‡è®¾ç»“æœæ˜¯ä»¥ä¸Š4ä¸ªè¡Œä¸šåœ¨æŸä¸ªæ—¶ç‚¹ä¸Šçš„è´¡çŒ®ç‡åˆ†åˆ«ä¸º10%ï¼Œ12%ï¼Œ16%ï¼Œ20%ï¼ˆéšæ—¶é—´çš„å˜åŒ–ï¼Œè¿™ä¸ªè´¡çŒ®ç‡ä¹Ÿæ˜¯åœ¨å˜åŒ–çš„ï¼‰ï¼Œå…¶æ„æ€æ˜¯åœ¨è¯¥æ—¶ç‚¹é’¢é“è¡Œä¸šéœ€æ±‚çš„å˜åŠ¨ï¼Œ10%æ˜¯å»ºæè¡Œä¸šçš„éœ€æ±‚å˜åŠ¨å¼•èµ·çš„ï¼Œ12%æ˜¯æ±½è½¦è¡Œä¸šçš„éœ€æ±‚å˜åŠ¨å¼•èµ·çš„ï¼Œä»¥æ­¤ç±»æ¨.....</p>
</blockquote>
<p>åœ¨ç”Ÿå‘½ç§‘å­¦çš„å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥åŸºäº RDA ç»“æœå¾—å‡ºä¸åŒç±»å‹çš„ç¯å¢ƒå› ç´ ï¼ˆå¦‚ä½•æ°”å€™ã€åœŸå£¤æ€§è´¨ä»¥åŠæ¤ç‰©ï¼‰å¯¹ç”Ÿç‰©ç¾¤è½ç»„æˆï¼ˆå¦‚åœŸå£¤çº¿è™«ç¾¤è½ã€å¾®ç”Ÿç‰©ç¾¤è½ï¼‰çš„è§£é‡Šç¨‹åº¦ã€‚</p>
<p>Singh et al.(2018) åœ¨ Scientific Report ä¸Šå‘è¡¨çš„æ–‡ç« <a href="https://doi.org/10.1038/s41598-019-42333-4">ã€Štropical forest conversion to rubber plantation affects soil micro- &amp; mesofaunal community &amp; diversityã€‹</a>ä¸­æåˆ°äº†ä¸€å¥—å®Œæ•´çš„åŸºäº RDA çš„æ–¹å·®åˆ†è§£æ“ä½œï¼š</p>
<blockquote>
<p>We performed a redundancy analysis (RDA) based variation partitioning analysis 57 to assess the relative effects of environmental and spatial variables on community composition. We used Hellinger transformed OTU abundance data as the response variable and two sets of explanatory variables which included environmental variables (pH, Ele, TOC, AP, GSW, SX, TN, and ST) and spatial variables (geographical co-ordinates for sampling sites), respectively. Before the RDA, the environmental variables with high variance inflation factor (VIF) &gt;10 were eliminated to avoid collinearity among factors. The importance of environmental and spatial variables in explaining species composition was determined by an RDA analysis using Monte Carlo permutation tests (999 unrestricted permutations) followed by forward selection to remove the non-significant variables from each of the explanatory sets.</p>
</blockquote>
<p>å¦‚ä½•è¿›è¡Œè¿™æ ·çš„æ–¹å·®åˆ†è§£æµç¨‹ï¼ˆåŒ…æ‹¬å˜é‡ç­›é€‰ä»¥åŠå˜é‡é›†çš„æ˜¾è‘—æ€§æ ‡æ³¨ï¼‰å°±æ˜¯ä»Šå¤©è¿™ç¯‡æ–‡ç« çš„é‡ç‚¹ã€‚</p>
<h2 id="ä½¿ç”¨-r-è¿›è¡Œæ–¹å·®åˆ†è§£">ä½¿ç”¨ R è¿›è¡Œæ–¹å·®åˆ†è§£</h2>
<p>æ­£å¦‚å¤§å¤šæ•°åŸºäºç¾¤è½çš„åˆ†ææ–¹æ³•ç›¸åŒï¼Œåœ¨ R ä¸­è¿›è¡Œæ–¹å·®åˆ†è§£åŒæ ·ç¦»ä¸å¼€ <a href="https://cran.r-project.org/web/packages/vegan/vegan.pdf">vegan åŒ…</a>ï¼Œä¸»è¦ä¾èµ–ä¸¤ä¸ªåŠŸèƒ½ï¼š</p>
<ol>
<li><a href="https://www.rdocumentation.org/packages/vegan/versions/2.4-2/topics/ordistep">ordistep</a> - å˜é‡ç­›é€‰</li>
<li><a href="https://www.rdocumentation.org/packages/vegan/versions/2.4-2/topics/varpart">varpart</a> - æ–¹å·®åˆ†è§£</li>
</ol>
<p>æ•°æ®ç»§ç»­ä½¿ç”¨ä¹‹å‰çš„æ–‡ç« <a href="https://womeimingzi11.github.io/post/vY312ek1B/">ã€Šä½¿ç”¨ ggplot2 å¯è§†åŒ– RDA ç»“æœã€‹</a>ä¸­ä½¿ç”¨çš„æ¼”ç¤ºæ•°æ®ã€‚</p>
<pre><code class="language-R"># suppressMessages will hide message from loading package, it makes the output clearer
suppressMessages(library(tidyverse))
# col_types = cols() will suppress message about the column type to make the output clearer
df_com &lt;- read_csv('df_com_smp.csv', col_types = cols())
df_env &lt;- read_csv('df_env_smp.csv', col_types = cols())

# Take a glimpse about the structure of data frame
glimpse(df_com)
glimpse(df_env)

</code></pre>
<pre><code>Rows: 150
Columns: 5
$ pp [3m[38;5;246m&lt;dbl&gt;[39m[23m 2.5500000, 1.3110456, 8.2500000, 102.4900000, 21.3500000, 2.490000â€¦
$ ba [3m[38;5;246m&lt;dbl&gt;[39m[23m 28.010000, 7.316707, 13.255000, 18.516667, 52.720000, 4.965000, 61â€¦
$ fu [3m[38;5;246m&lt;dbl&gt;[39m[23m 2.5500000, 1.3378838, 3.3550000, 20.9466667, 14.8466667, 1.2450000â€¦
$ pr [3m[38;5;246m&lt;dbl&gt;[39m[23m 2.5500000, 1.3378838, 0.0000000, 0.0000000, 0.0000000, 0.0000000, â€¦
$ om [3m[38;5;246m&lt;dbl&gt;[39m[23m 15.280000, 5.953381, 14.850000, 23.500000, 5.623333, 2.475000, 31.â€¦
Rows: 150
Columns: 13
$ pH  [3m[38;5;246m&lt;dbl&gt;[39m[23m -1.63965465, 0.94291257, -1.33875709, -1.20359469, -1.17624072, 0â€¦
$ MOI [3m[38;5;246m&lt;dbl&gt;[39m[23m -0.1610384, -0.5549069, -0.2762522, -0.1658411, 1.0043821, 0.5467â€¦
$ TN  [3m[38;5;246m&lt;dbl&gt;[39m[23m -0.116240631, -0.791972999, 0.199881689, -0.260084650, 0.29187495â€¦
$ TP  [3m[38;5;246m&lt;dbl&gt;[39m[23m -0.44892589, 0.02952209, -0.14900328, -0.45606691, -0.47748995, -â€¦
$ AP  [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.17966965, -0.78701735, -0.10273314, 0.09277663, 2.24338416, 0.5â€¦
$ NH4 [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.4471754, -0.3426843, 0.7179844, -0.1328073, 0.7924569, -0.36525â€¦
$ NO3 [3m[38;5;246m&lt;dbl&gt;[39m[23m -0.51485153, -0.41977560, -0.49221441, -0.16774892, -0.58276291, â€¦
$ SOC [3m[38;5;246m&lt;dbl&gt;[39m[23m -0.292278803, -0.697789311, 0.461059956, -0.007572046, 0.03580922â€¦
$ MAT [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.84202205, -1.55196703, -0.84801694, 0.78335952, -0.28932636, -0â€¦
$ MAP [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.02487222, 0.27013035, 1.21243154, -0.87351309, -0.22471654, 1.2â€¦
$ PBM [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.17638650, -0.02465146, 0.73829039, -0.80968336, 0.12645186, 2.1â€¦
$ PCV [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.426595458, 0.008333099, -0.793336422, -0.514494850, 0.182609082â€¦
$ PSR [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.22757812, -0.83529465, 0.83493399, -1.29081156, 0.98677296, 0.6â€¦
</code></pre>
<p>æŒ‰ç…§ varpart åœ¨æ–‡æ¡£ä¸­çš„è¯´æ˜ï¼š</p>
<blockquote>
<p>The functions partition the variation in Y into components accounted for by two to four explanatory tables and their combined effects. If Y is a multicolumn data frame or matrix, the partitioning is based on redundancy analysis (RDA, see rda), and if Y is a single variable, the partitioning is based on linear regression. If Y are dissimilarities, the decomposition is based on distance-based redundancy analysis (db-RDA, see capscale) following McArdle &amp; Anderson (2001). The input dissimilarities must be compatible to the results of dist. Vegan functions vegdist, designdist, raupcrick and betadiver produce such objects, as do many other dissimilarity functions in R packages. However, symmetric square matrices are not recognized as dissimilarities but must be transformed with as.dist. Partitioning will be made to squared dissimilarities analogously to using variance with rectangular data -- unless sqrt.dist = TRUE was specified.</p>
</blockquote>
<p>å¯¹äºç¾¤è½çŸ©é˜µï¼Œæ–¹å·®åˆ†è§£æ˜¯æŒ‰ç…§ RDA ç»“æœæ¥è¿›è¡Œå¤„ç†çš„ï¼Œå› æ­¤ç­›é€‰å˜é‡çš„æµç¨‹å¯åœ¨ RDA åˆ†æçš„è¿‡ç¨‹ä¸­å®Œæˆã€‚</p>
<h3 id="ä¸ºä½•è¦ç­›é€‰å˜é‡">ä¸ºä½•è¦ç­›é€‰å˜é‡ï¼Ÿ</h3>
<p>åœ¨å¤šå› ç´ çš„åˆ†æä¸­ï¼Œä¾‹å¦‚ RDA åˆ†æå’Œå¤šå…ƒçº¿æ€§å›å½’ï¼Œä»»ä½•å¢åŠ æ–°çš„å˜é‡ï¼Œéƒ½ä¼šä½¿å¾—æ¨¡å‹ã€Œçœ‹èµ·æ¥ã€æ‹Ÿåˆå¾—æ›´å¥½ï¼Œç„¶è€Œå®é™…æƒ…å†µæ˜¾ç„¶å¹¶éå¦‚æ­¤ï¼Œä¸ºäº†è§£å†³è¿‡æ‹Ÿåˆé—®é¢˜<strong>è°ƒæ•´ R æ–¹</strong>æ˜¯ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„æŒ‡æ ‡ï¼Œå…·ä½“çš„è§£é‡Šå¯ä»¥æŸ¥çœ‹ <a href="https://www.statisticshowto.com/adjusted-r2/">Adjusted R2 / Adjusted R-Squared: What is it used for?</a>ã€‚</p>
<p>å›åˆ°æ­£é¢˜ï¼Œå¯¹äº RDA åˆ†æé€‰æ‹©å˜é‡ï¼Œordistep æä¾›äº†ä¸‰ç§æ–¹æ³• backward, forward, bothï¼Œå³ä»å…¨æ¨¡å‹é€æ¸æ¶ˆé™¤å˜é‡ã€ä»é›¶æ¨¡å‹é€æ¸å¢åŠ å˜é‡ä»¥åŠåŒå‘é€‰æ‹©å˜é‡ã€‚è¿™é‡Œæˆ‘ä»¬åŒæ—¶è¿›è¡Œä¸‰ç§å˜é‡é€‰æ‹©çš„æ–¹å¼ã€‚</p>
<pre><code class="language-R"># suppressMessages will hide message from loading package, it makes the output clearer
suppressMessages(library(vegan))

# Create the full model
rda_full &lt;- rda(df_com~., data = df_env)

# Create the zero model
rda_null &lt;- rda(df_com~1, data = df_env)

# backward selection
# trace = 0 prevent ordistep print the selection progress from outputing to the console
# it makes the output clearer.
rda_back &lt;- ordistep(rda_full, direction = 'backward',trace = 0)

# forward selection
rda_frwd &lt;- ordistep(rda_null, formula(rda_full), direction = 'forward',trace = 0)

# bothward selection 
rda_both &lt;- ordistep(rda_null, formula(rda_full), direction = 'both',trace = 0)

rda_back
rda_frwd
rda_both
</code></pre>
<pre><code>Call: rda(formula = df_com ~ pH + MOI + TN + TP + NO3 + SOC + MAT, data
= df_env)

                Inertia Proportion Rank
Total         2031.7341     1.0000     
Constrained    860.1782     0.4234    5
Unconstrained 1171.5559     0.5766    5
Inertia is variance 

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4  RDA5 
747.1  77.3  32.2   2.5   1.0 

Eigenvalues for unconstrained axes:
  PC1   PC2   PC3   PC4   PC5 
755.6 247.3 108.6  46.6  13.5 




Call: rda(formula = df_com ~ MOI + NO3 + TN + SOC, data = df_env)

                Inertia Proportion Rank
Total         2031.7341     1.0000     
Constrained    790.2092     0.3889    4
Unconstrained 1241.5248     0.6111    5
Inertia is variance 

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4 
714.8  70.1   4.3   1.0 

Eigenvalues for unconstrained axes:
  PC1   PC2   PC3   PC4   PC5 
787.6 277.0 114.1  48.7  14.0 




Call: rda(formula = df_com ~ MOI + NO3 + TN + SOC, data = df_env)

                Inertia Proportion Rank
Total         2031.7341     1.0000     
Constrained    790.2092     0.3889    4
Unconstrained 1241.5248     0.6111    5
Inertia is variance 

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4 
714.8  70.1   4.3   1.0 

Eigenvalues for unconstrained axes:
  PC1   PC2   PC3   PC4   PC5 
787.6 277.0 114.1  48.7  14.0 
</code></pre>
<p>æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©æœ€ç»ˆçš„æ¨¡å‹ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©å‘åæ¶ˆé™¤æ³•é€‰æ‹©çš„æ¨¡å‹ä½œä¸º RDA æœ€ç»ˆçš„ç»“æœã€‚åŒæ—¶è¿™ä¹Ÿæ˜¯æ–¹å·®åˆ†è§£çš„æœ€ç»ˆæ¨¡å‹ï¼Œå³ <code>df_com ~ pH + MOI + TN + TP + NO3 + SOC + MAT</code>ï¼Œå…¶ä¸­ MAT æ˜¯æ°”å€™å› ç´ ï¼Œæˆ‘ä»¬å°†å…¶é€‰å…¥æ°”å€™å› ç´ é›† df_climï¼Œ å…¶ä½™å‡ä¸ºåœŸå£¤æ€§è´¨å› ç´ é›† df_soilï¼Œæ¤ç‰©å› ç´ æ²¡æœ‰é€‰å…¥æ¨¡å‹ã€‚</p>
<pre><code class="language-R"># Divide the environmental data.frame by different categories.
df_clim &lt;- df_env %&gt;% select(MAT)
df_soil &lt;- df_env %&gt;% select(pH,MOI,TN,TP,NO3,SOC)

# Perform variation partitioning analysis, the first variable is the community matrix
# the second and third variables are climate variable set and soil property variable set
vpt &lt;- varpart(df_com, df_clim, df_soil)

vpt

plot(
    vpt,
    bg = 2:5,
    id.size = 1.1,
    cex = 1.2,
    Xnames = c('Climate', 'Soil properties')
)
title('Variation partitioning by varpart from vegan')
</code></pre>
<pre><code>Partition of variance in RDA 

Call: varpart(Y = df_com, X = df_clim, df_soil)

Explanatory tables:
X1:  df_clim
X2:  df_soil 

No. of explanatory tables: 2 
Total variation (SS): 302728 
            Variance: 2031.7 
No. of observations: 150 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1            1   0.00855       0.00186     TRUE
[b+c] = X2            6   0.41263       0.38799     TRUE
[a+b+c] = X1+X2       7   0.42337       0.39495     TRUE
Individual fractions                                    
[a] = X1|X2           1                 0.00696     TRUE
[b]                   0                -0.00510    FALSE
[c] = X2|X1           6                 0.39309     TRUE
[d] = Residuals                         0.60505    FALSE
---
Use function â€˜rdaâ€™ to test significance of fractions of interest
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/output_5_1.png" alt="" loading="lazy"></figure>
<p>æ ¹æ® RDA å’Œæ–¹å·®åˆ†è§£çš„ç»“æœï¼ˆå®é™…ä¸Šæ˜¯ç›¸åŒçš„ç»“æœï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ°”å€™å› ç´ ä¸åœŸå£¤æ€§è´¨å…±åŒè§£é‡Šäº† 39.5% çš„ç¾¤è½ç»“æ„å˜å¼‚ï¼Œå…¶ä¸­åœŸå£¤æ€§è´¨è§£é‡Šäº† 38.8% çš„ç¾¤è½ç»„æˆå˜å¼‚ï¼Œæ°”å€™è§£é‡Šäº† 0.2% çš„ç¾¤è½ç»„æˆå˜å¼‚ã€‚ç„¶è€Œå¯¹äºäºŒè€…æ˜¯å¦æ˜¾è‘—ï¼Œè¿˜éœ€è¦è¿›ä¸€æ­¥æ£€éªŒã€‚</p>
<pre><code class="language-R"># Define formula of soil property set and climate set to test.
# Set the variable from other category as condition
formula_soil &lt;- formula(df_com ~ pH+MOI+TN+TP+NO3+SOC + Condition(MAT))
formula_clim &lt;- formula(df_com ~ Condition(pH)+Condition(MOI)+Condition(TN)+Condition(TP)+Condition(NO3)+Condition(SOC) + MAT)

anova(rda(formula_soil, data = df_env))
anova(rda(formula_clim, data = df_env))
</code></pre>
<table>
<caption>A anova.cca: 2 Ã— 4</caption>
<thead>
	<tr><th></th><th scope=col>Df</th><th scope=col>Variance</th><th scope=col>F</th><th scope=col>Pr(&gt;F)</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>Model</th><td>  6</td><td> 842.7984</td><td>17.02542</td><td>0.001</td></tr>
	<tr><th scope=row>Residual</th><td>142</td><td>1171.5559</td><td>      NA</td><td>   NA</td></tr>
</tbody>
</table>
<table>
<caption>A anova.cca: 2 Ã— 4</caption>
<thead>
	<tr><th></th><th scope=col>Df</th><th scope=col>Variance</th><th scope=col>F</th><th scope=col>Pr(&gt;F)</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>Model</th><td>  1</td><td>  21.81623</td><td>2.644266</td><td>0.083</td></tr>
	<tr><th scope=row>Residual</th><td>142</td><td>1171.55586</td><td>      NA</td><td>   NA</td></tr>
</tbody>
</table>
<p>ç»“åˆå•å› ç´ æ–¹å·®åˆ†æ ANOVA å¾—åˆ°çš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºæœ€ç»ˆç»“è®ºï¼ŒåœŸå£¤æ€§è´¨èƒ½å¤Ÿæ˜¾è‘—è§£é‡Š 38.8% çš„ç¾¤è½ç»„æˆå˜å¼‚ï¼Œæ°”å€™å› ç´ å¯¹äºç¾¤è½ç»“æ„å˜å¼‚çš„è§£é‡Šä¸æ˜¾è‘—ã€‚</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://womeimingzi11.github.io/tag/KdG5Wnx_L/" class="tag">
                    æ–¹å·®åˆ†è§£
                  </a>
                
                  <a href="https://womeimingzi11.github.io/tag/26adNTJTQm/" class="tag">
                    variation partitioning
                  </a>
                
                  <a href="https://womeimingzi11.github.io/tag/Nk4WS6mkP5/" class="tag">
                    RDA
                  </a>
                
                  <a href="https://womeimingzi11.github.io/tag/6kcUjhK3re/" class="tag">
                    æ•°æ®åˆ†æ
                  </a>
                
                  <a href="https://womeimingzi11.github.io/tag/X1VkNLzBV/" class="tag">
                    R
                  </a>
                
                  <a href="https://womeimingzi11.github.io/tag/ENAyDyZ5tK/" class="tag">
                    ecology
                  </a>
                
                  <a href="https://womeimingzi11.github.io/tag/NOVxTpueqQ/" class="tag">
                    using-r-for-everything
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://womeimingzi11.github.io/post/vY312ek1B/">
                  <h3 class="post-title">
                    Using R for Everything: ä½¿ç”¨ ggplot2 å¯è§†åŒ– RDA ç»“æœ
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
