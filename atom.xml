<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://womeimingzi11.github.io</id>
    <title>æ´—è¡£æœºç”¨æˆ·ä¸ä¼šç”¨æ´—è¡£æœº</title>
    <updated>2020-10-10T04:15:56.339Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://womeimingzi11.github.io"/>
    <link rel="self" href="https://womeimingzi11.github.io/atom.xml"/>
    <subtitle>Why be a researcher if you can be an Engineer?</subtitle>
    <logo>https://womeimingzi11.github.io/images/avatar.png</logo>
    <icon>https://womeimingzi11.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, æ´—è¡£æœºç”¨æˆ·ä¸ä¼šç”¨æ´—è¡£æœº</rights>
    <entry>
        <title type="html"><![CDATA[amapGeocode: ä½¿ç”¨Rè¿›è¡Œé«˜å¾·åœ°å›¾åœ°ç†ç¼–ç /é€†ç¼–ç ]]></title>
        <id>https://womeimingzi11.github.io/post/dG9esk683/</id>
        <link href="https://womeimingzi11.github.io/post/dG9esk683/">
        </link>
        <updated>2020-10-08T16:13:37.000Z</updated>
        <summary type="html"><![CDATA[<!-- Place this tag in your head or just before your close body tag. -->
<script async defer src="https://buttons.github.io/buttons.js"></script>
<p>åœ¨æœ€è¿‘çš„å­¦ä¹ ä¸­ï¼Œå¤§é‡ä½¿ç”¨åˆ°äº†åœ°ç†ç¼–ç ä¸åœ°ç†é€†ç¼–ç ï¼Œç„¶è€Œä¸å¹¸çš„æ˜¯ç›®å‰å¹¿æ³›åœ¨ R ä¸­ä»‹ç»çš„èƒ½å®Œæˆè¯¥ä»»åŠ¡çš„åŒ…å› ä¸º API çš„ Breaking Upgrade å¾ˆå¤šåŠŸèƒ½å·²ç»å¤±æ•ˆäº†ã€‚å°¤å…¶æ˜¯æ„å¤–çš„å‘ç°ï¼Œç›®å‰çš„åŒ…ä¸»è¦ç”±ç™¾åº¦åœ°å›¾ API ä½œæ•°æ®æºï¼Œäºæ˜¯ä¸ºäº†æ»¡è¶³åœ¨ R ä¸­ä½¿ç”¨é«˜å¾·åœ°å›¾ API è¿›è¡Œåœ°ç†ç¼–ç ä¸é€†ç¼–ç çš„éœ€æ±‚ï¼Œå¼€å‘äº† <a href="https://github.com/womeimingzi11/amapGeocode"><code>amapGeocode</code></a> è¿™æ¬¾åŒ…ï¼Œå¦‚æœèƒ½å¯¹æœ‰åŒæ ·éœ€æ±‚çš„åŒå­¦æœ‰ä»»ä½•å¸®åŠ©ï¼Œå°†ä¸èƒœè£å¹¸ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<!-- Place this tag in your head or just before your close body tag. -->
<script async defer src="https://buttons.github.io/buttons.js"></script>
<p>åœ¨æœ€è¿‘çš„å­¦ä¹ ä¸­ï¼Œå¤§é‡ä½¿ç”¨åˆ°äº†åœ°ç†ç¼–ç ä¸åœ°ç†é€†ç¼–ç ï¼Œç„¶è€Œä¸å¹¸çš„æ˜¯ç›®å‰å¹¿æ³›åœ¨ R ä¸­ä»‹ç»çš„èƒ½å®Œæˆè¯¥ä»»åŠ¡çš„åŒ…å› ä¸º API çš„ Breaking Upgrade å¾ˆå¤šåŠŸèƒ½å·²ç»å¤±æ•ˆäº†ã€‚å°¤å…¶æ˜¯æ„å¤–çš„å‘ç°ï¼Œç›®å‰çš„åŒ…ä¸»è¦ç”±ç™¾åº¦åœ°å›¾ API ä½œæ•°æ®æºï¼Œäºæ˜¯ä¸ºäº†æ»¡è¶³åœ¨ R ä¸­ä½¿ç”¨é«˜å¾·åœ°å›¾ API è¿›è¡Œåœ°ç†ç¼–ç ä¸é€†ç¼–ç çš„éœ€æ±‚ï¼Œå¼€å‘äº† <a href="https://github.com/womeimingzi11/amapGeocode"><code>amapGeocode</code></a> è¿™æ¬¾åŒ…ï¼Œå¦‚æœèƒ½å¯¹æœ‰åŒæ ·éœ€æ±‚çš„åŒå­¦æœ‰ä»»ä½•å¸®åŠ©ï¼Œå°†ä¸èƒœè£å¹¸ã€‚</p>
<!-- more -->
<h2 id="ä»€ä¹ˆæ˜¯åœ°ç†ç¼–ç é€†ç¼–ç ">ä»€ä¹ˆæ˜¯åœ°ç†ç¼–ç /é€†ç¼–ç </h2>
<p>æ ¹æ®<a href="https://www.zhihu.com/people/di-li-xiao-zi">åœ°ç†å°å­</a>åœ¨æ–‡ç« <a href="https://zhuanlan.zhihu.com/p/22095359">ã€Šåœ°ç†ç¼–ç ä¸é€†åœ°ç†ç¼–ç ï¼ˆä¸Šï¼‰â€”â€”ç†è§£åœ°ç†ç¼–ç ã€‹</a>ä¸­çš„é™ˆè¿°ï¼š</p>
<blockquote>
<p>åœ°ç†ç¼–ç æŒ‡å°†åœ°åçš„è¯¦ç»†åœ°å€ä»¥åœ°ç†åæ ‡ï¼ˆå¦‚ç»çº¬åº¦)è¡¨ç¤ºçš„è¿‡ç¨‹ã€‚å…¶ä¸­ï¼Œå°†åœ°å€ä¿¡æ¯æ˜ å°„ä¸ºåœ°ç†åæ ‡çš„è¿‡ç¨‹ç§°ä¹‹ä¸ºåœ°ç†ç¼–ç ï¼›å°†åœ°ç†åæ ‡è½¬æ¢ä¸ºåœ°å€ä¿¡æ¯çš„è¿‡ç¨‹ç§°ä¹‹ä¸ºé€†åœ°ç†ç¼–ç ã€‚å¦‚å›¾1.1æ‰€ç¤ºä¸ºåœ°ç†ç¼–ç å’Œé€†åœ°ç†ç¼–ç çš„å…³ç³»ã€‚</p>
</blockquote>
<figure data-type="image" tabindex="1"><img src="https://pic3.zhimg.com/80/d2e918ce2b6e6f44d72e2d7659d60566_1440w.jpg" alt="å›¾1.1-åœ°ç†å°å­-ã€Šåœ°ç†ç¼–ç ä¸é€†åœ°ç†ç¼–ç ï¼ˆä¸Šï¼‰â€”â€”ç†è§£åœ°ç†ç¼–ç ã€‹" loading="lazy"></figure>
<p>æ— è®ºæ˜¯åœ¨ç§‘å­¦ç ”ç©¶è¿˜æ˜¯æ•°æ®å¤„ç†çš„è¿‡ç¨‹ä¸­ï¼Œå‡¡æ˜¯æ¶‰åŠåˆ°ä½ç½®ä¿¡æ¯çš„æƒ…å†µï¼Œç»å¸¸ä¼šä½¿ç”¨åˆ°åœ°ç†ç¼–ç ä¸é€†ç¼–ç ï¼šä¾‹å¦‚ç»™å®šæ ·æœ¬çš„åœ°å€ï¼Œå°†å…¶è½¬æ¢ä¸ºç»çº¬åº¦ä»¥ä¾¿è¿›è¡Œé‡åŒ–è®¡ç®—å¹¶è¿›è¡Œå¯è§†åŒ–ï¼›äº¦æˆ–è€…ç»™å®šæ ·æœ¬åœ°å€ä¿¡æ¯ï¼Œå°†å…¶æŒ‰ç…§è¡Œæ”¿åŒºåŸŸè¿›è¡Œåˆ†ç±»ä»¥ä¾¿è¿›è¡Œåˆ†ç»„å¹¶ç»Ÿè®¡ã€‚</p>
<h2 id="å¦‚ä½•åœ¨-r-ä¸­è¿›è¡Œåœ°ç†ç¼–ç é€†ç¼–ç ">å¦‚ä½•åœ¨ R ä¸­è¿›è¡Œåœ°ç†ç¼–ç /é€†ç¼–ç </h2>
<p>ç›®å‰è¿›è¡Œåœ°ç†ç¼–ç /é€†ç¼–ç çš„æ–¹æ³•é€šå¸¸æ˜¯ä½¿ç”¨åœ°å›¾ä¾›åº”å•†æä¾›çš„ API è·å–ä¿¡æ¯ã€‚åœ¨ R ä¸­ç›®å‰å¸¸ä½¿ç”¨ <a href="https://CRAN.R-project.org/package=tidygeocoder">tidygeocoder</a>ï¼Œ<a href="https://github.com/badbye/baidumap">baidumap</a> ä»¥åŠ <a href="https://github.com/ChrisMuir/baidugeo">baidugeo</a> ç­‰ Package å®Œæˆè¿™ç±»ä»»åŠ¡ã€‚ç„¶è€Œï¼Œå…¶ä¸­ <a href="https://CRAN.R-project.org/package=tidygeocoder">tidygeocoder</a> ä½¿ç”¨å›½é™…åœ°ç†ä¿¡æ¯ä¾›åº”å•†ï¼Œå…¶å‡†ç¡®åº¦ä»¥åŠä¿¡æ¯è¦†ç›–ç¨‹åº¦å°šä¸èƒ½ä»¤äººæ»¡æ„ï¼›è€Œåä¸¤è€…å› ä¸ºç™¾åº¦åœ°å›¾ API çš„å‡çº§ï¼Œå¯¼è‡´ç›®å‰ Package ä¸èƒ½è¢«æ–°ç”¨æˆ·è°ƒç”¨ï¼ˆå…¶ä¸­å‰è€…ç¬”è€…å·²ç»æäº¤äº† <a href="https://github.com/badbye/baidumap/pull/20">Request</a>ï¼Œä¸è¿‡æ˜¯å¦ä¼šè¢«åˆå¹¶è¿˜éœ€è¦è¿›ä¸€æ­¥ç­‰å¾…ï¼›åè€…<a href="https://github.com/ChrisMuir/baidugeo/pull/4">ç¬”è€…æ­£åœ¨å’Œå¼€å‘è€…è¿›è¡Œæ›´æ–°</a>ï¼Œå…·ä½“ä¿®å¤æ—¶é—´è¿˜éœ€ç­‰å¾…ï¼‰ã€‚</p>
<p>æ­¤å¤–ï¼Œé€šè¿‡ç¬”è€…åœ¨å®é™…é¡¹ç›®çš„ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°ï¼Œåœ¨ç›¸å½“å¤šçš„æƒ…å†µä¸‹ï¼Œé«˜å¾·åœ°å›¾æä¾›çš„åœ°ç†ç¼–ç /é€†ç¼–ç ä¿¡æ¯ä¼¼ä¹å¥½äºç™¾åº¦åœ°å›¾ï¼Œå½“ç„¶å› ä¸ºæ²¡æœ‰è¿›è¡Œå®¢è§‚çš„å¯¹ç…§åˆ†æï¼Œä»…ä½œä¸ºä¸ªäººä½“éªŒä»¥ä½œå‚è€ƒ<s>ï¼Œå¦‚æœ‰è°¬è¯¯ï¼Œæ‚¨è¯´çš„å¯¹</s>ã€‚</p>
<h2 id="amapgeocode">amapGeocode</h2>
<p>åŸºäºä»¥ä¸ŠåŸå› ï¼Œç¬”è€…ä½¿ç”¨<a href="https://lbs.amap.com/api/webservice/guide/api/georegeo">é«˜å¾·å¼€æ”¾å¹³å°</a> API ç¼–å†™äº†ç”¨äº R çš„åœ°ç†ç¼–ç /é€†ç¼–ç çš„ Package <a href="https://cran.r-project.org/package=amapGeocode">amapGeocode</a>ã€‚ä»£ç æ‰˜ç®¡äº <a href="https://github.com/womeimingzi11/amapGeocode">Github</a>ã€‚å…·ä½“çš„é«˜å¾·æ–‡æ¡£å¯ä»¥æŸ¥çœ‹<a href="https://lbs.amap.com/">è¿™é‡Œ</a>å’Œ<a href="https://lbs.amap.com/api/webservice/summary/">è¿™é‡Œ</a>ã€‚</p>
<p>ç›®å‰ amapGeocode æ”¯æŒé€šè¿‡ <code>getCoord()</code> è¿›è¡Œåœ°ç†ç¼–ç ï¼Œå³æ ¹æ®åœ°å€è·å–åæ ‡ç­‰ä¿¡æ¯ï¼›ä»¥åŠé€šè¿‡ <code>getLocation()</code> è¿›è¡Œåœ°ç†é€†ç¼–ç ï¼Œå³æ ¹æ®ç»çº¬åº¦è·å–åœ°å€ç­‰ä¿¡æ¯ã€‚æ­¤å¤–è¿˜å¯ä»¥é€šè¿‡ <code>getAdmin()</code> è·å–ç»™å®šè¡Œæ”¿åŒºå…¶ä¸‹å±è¡Œæ”¿åŒºï¼ˆ<code>JSON</code> å’Œ <code>XML</code> æ”¯æŒå¤šçº§è¡Œæ”¿åŒºï¼‰ã€‚</p>
<p>ä¸Šè¿° function æ”¯æŒè¾“å…¥å•æ¡çš„æ–‡æœ¬åœ°å€/åæ ‡/è¡Œæ”¿åŒºï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒæ‰¹é‡è¾“å…¥ä¿¡æ¯ï¼Œå…¶é»˜è®¤è¿”å›ç»“æœä¸º <a href="https://tibble.tidyverse.org/">tibble</a>ï¼Œ åŒæ—¶ä¹Ÿå¯ä»¥è¿”å›åŸç”Ÿçš„ <code>JSON</code> æ ¼å¼ä»¥åŠ <code>XML</code> æ ¼å¼ï¼Œæ­¤æ—¶æ‰¹é‡æŸ¥è¯¢çš„åœ°å€å°†ä»¥ <code>list</code> çš„ç»“æ„ä¿å­˜ã€‚</p>
<h3 id="å®‰è£…">å®‰è£…</h3>
<p>ç›®å‰å¯ä»¥é€šè¿‡ä¸‹åˆ—å‘½ä»¤ä» CRAN å®‰è£…ç¨³å®šç‰ˆï¼š</p>
<pre><code class="language-r">install.packages(&quot;amapGeocode&quot;)
</code></pre>
<p>æ­¤å¤–ä¹Ÿå¯ä»¥é€šè¿‡ Github å®‰è£…å¼€å‘ç‰ˆï¼š</p>
<pre><code class="language-r">remotes::install_github('womeimingzi11/amapGeocode')
</code></pre>
<h3 id="ç”³è¯·-api-key">ç”³è¯· API Key</h3>
<p>ç”±äº amapGeocode ä½¿ç”¨äº†é«˜çš„å¼€æ”¾å¹³å°çš„çš„ API æœåŠ¡ï¼Œå› æ­¤åœ¨ä½¿ç”¨ amapGeocode ä¹‹å‰ï¼Œç”¨æˆ·<strong>å¿…é¡»é¦–å…ˆç”³è¯·</strong> API Keyï¼Œç”³è¯·åœ°å€å¦‚ä¸‹ <a href="https://console.amap.com/dev/index" class="uri">https://console.amap.com/dev/index</a></p>
<figure data-type="image" tabindex="2"><img src="http://hansblog.test.upcdn.net/Snipaste_2020-10-09_23-14-44.png" alt="" loading="lazy"></figure>
<p>ç‚¹å‡»<code>ç®¡ç†Key</code>è¿›å…¥ç®¡ç†é¡µé¢ï¼Œé€‰æ‹©<code>åˆ›å»ºæ–°åº”ç”¨</code>ï¼Œåº”ç”¨åç§°å’Œç”¨é€”å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…ç”¨é€”å¡«å†™ã€‚ä¹‹ååœ¨åˆšåˆšåˆ›å»ºçš„åº”ç”¨å³ä¾§ç‚¹å‡»æ·»åŠ æŒ‰é’®æ·»åŠ ä¸€ä¸ªæ–°çš„ API Keyï¼ŒKey åç§°å¯ä»¥è‡ªè¡Œå‘½åï¼Œä½†æ˜¯æ³¨æ„ä¸€å®šè¦æŠŠæœåŠ¡å¹³å°é€‰ä¸º <code>WebæœåŠ¡</code>ã€‚ä¹‹åå°±èƒ½æŸ¥çœ‹ç”³è¯·åˆ°çš„ Key äº†ã€‚<strong>è¯·æ³¨æ„ï¼ŒKey çš„ä½œç”¨ç›¸å½“äºè®¿é—®é«˜å¾·æœåŠ¡çš„å¯†ç ï¼Œåˆ‡å‹¿åˆ†äº«ç»™å…¶ä»–äººä½¿ç”¨ã€‚å¦‚æœæ€€ç–‘ Key æ³„éœ²ï¼Œå¯ä»¥é€šè¿‡<code>åˆ é™¤</code>æŒ‰é’®æ’¤é”€è¯¥ Keyï¼Œä½†åŒæ—¶ä¹Ÿæ„å‘³ç€æ‚¨ä¹‹å‰åœ¨ç¨‹åºä¸­å¼•ç”¨çš„è¯¥ Key ä¹Ÿéœ€è¦ä¸€å¹¶æ›´æ¢ï¼Œå¦è€… amapGeocode æ— æ³•æ­£å¸¸å·¥ä½œã€‚</strong></p>
<figure data-type="image" tabindex="3"><img src="http://hansblog.test.upcdn.net/Snipaste_2020-10-09_23-32-41.png" alt="" loading="lazy"></figure>
<p>æ­¤å¤–ï¼Œæˆªæ­¢åˆ° 2020 å¹´ 10 æœˆ 9 æ—¥ï¼Œæ ¹æ®<a href="https://console.amap.com/dev/flow/manage">é«˜å¾·å¼€æ”¾å¹³å°é…é¢ç®¡ç†é¡µé¢æ˜¾ç¤º</a>ï¼šé«˜å¾·å¼€æ”¾å¹³å°<strong>åœ°ç†ç¼–ç /é€†åœ°ç†ç¼–ç /è¡Œæ”¿åŒºæŸ¥è¯¢æœåŠ¡</strong>å¯¹äºå®åè®¤è¯å…è´¹ç”¨æˆ·åˆ†åˆ«æä¾›äº†<strong>å•æ—¥</strong> 300,000æ¬¡/300,000æ¬¡/30,000 æ¬¡çš„ä½¿ç”¨é¢åº¦ï¼Œè¶…è¿‡æ­¤é¢åº¦åï¼Œå½“æ—¥æ— æ³•ç»§ç»­ä½¿ç”¨æŸ¥è¯¢æœåŠ¡ã€‚ç†è®ºä¸Šæ¥è®²ï¼Œé™¤éä¸»åŠ¨è´­ä¹°é¢å¤–çš„æŸ¥è¯¢æ¬¡æ•°ï¼Œå¦åˆ™ä¸ä¼šäº§ç”Ÿè´¹ç”¨ï¼Œä½† amapGeocode å¼€å‘è€…æš¨ç¬”è€…ä¸å¯¹é«˜å¾·å¼€æ”¾å¹³å°å…¶è§„å®šä¸æ”¶è´¹æ”¿ç­–ä½œä»»ä½•ä¿è¯ï¼Œè¯·ç”¨æˆ·è‡ªè¡Œåˆ¤æ–­ã€‚</p>
<h2 id="ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</h2>
<h3 id="åœ°ç†ç¼–ç ">åœ°ç†ç¼–ç </h3>
<pre><code class="language-r">library(amapGeocode)
</code></pre>
<p>åŠ è½½ amapGeocode åï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©æ¯æ¬¡æ‰§è¡Œå‘½ä»¤ä¹‹æ—¶æ‰‹åŠ¨æŒ‡å®š <code>key</code> å‚æ•°æ¥è®¾å®šä¹‹å‰ç”³è¯·åˆ°çš„ Keyï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹åˆ—å‘½ä»¤å°† key è®¾ç½®ä¸ºå…¨å±€å¯ç”¨ï¼Œåˆ™å•æ¡å‘½ä»¤æ— éœ€å†æ¬¡æ‰‹åŠ¨è¾“å…¥ä¹‹å‰ç”³è¯·åˆ°çš„ Key</p>
<pre><code>options(amap_key = 'REPLACE THIS BY YOUR KEY')
</code></pre>
<p>é€šè¿‡ <code>getCoord()</code> æ¥è·å–ç»™å®šåœ°å€çš„ç»çº¬åº¦ï¼š</p>
<pre><code class="language-r">getCoord(c(&quot;å››å·çœä¸­åŒ»é™¢&quot;, &quot;å››å·çœäººæ°‘åŒ»é™¢&quot;, &quot;å…°å·å¤§å­¦ç›˜æ—‹è·¯æ ¡åŒº&quot;, &quot;æˆéƒ½ä¸­åŒ»è¯å¤§å­¦åäºŒæ¡¥æ ¡åŒº&quot;))
</code></pre>
<pre><code>## # A tibble: 4 x 12
##     lng   lat formatted_addre~ country province city  district township street
##   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;    &lt;lgl&gt;    &lt;lgl&gt; 
## 1  104.  30.7 å››å·çœæˆéƒ½å¸‚é‡‘ç‰›åŒºå››å·çœä¸­åŒ»é™¢~ ä¸­å›½    å››å·çœ   æˆéƒ½å¸‚~ é‡‘ç‰›åŒº   NA       NA    
## 2  104.  30.7 å››å·çœæˆéƒ½å¸‚é’ç¾ŠåŒºå››å·çœäººæ°‘åŒ»~ ä¸­å›½    å››å·çœ   æˆéƒ½å¸‚~ é’ç¾ŠåŒº   NA       NA    
## 3  104.  36.0 ç”˜è‚ƒçœå…°å·å¸‚åŸå…³åŒºå…°å·å¤§å­¦ç›˜æ—‹~ ä¸­å›½    ç”˜è‚ƒçœ   å…°å·å¸‚~ åŸå…³åŒº   NA       NA    
## 4  104.  30.7 å››å·çœæˆéƒ½å¸‚é‡‘ç‰›åŒºæˆéƒ½ä¸­åŒ»è¯å¤§~ ä¸­å›½    å››å·çœ   æˆéƒ½å¸‚~ é‡‘ç‰›åŒº   NA       NA    
## # ... with 3 more variables: number &lt;lgl&gt;, citycode &lt;chr&gt;, adcode &lt;chr&gt;
</code></pre>
<p>åœ¨é»˜è®¤çŠ¶æ€ä¸‹ï¼Œè¯¥å‘½ä»¤å°†è¿”å›æŒ‰è¾“å…¥é¡ºåºæ’åºçš„ tibble è¡¨æ ¼ã€‚ä¸è¿‡ç”¨æˆ·ä¾ç„¶å¯ä»¥é€šè¿‡æŒ‡å®š <code>output = 'JSON'</code> æˆ– <code>output = 'XML'</code> å¹¶é…åˆ <code>to_table = FALSE</code> æ¥ç›´æ¥è·å¾—é«˜å¾·åœ°å›¾ API è¿”å›çš„ <code>JSON/XML</code> æ ¼å¼çš„ç»“æœã€‚</p>
<pre><code class="language-r"># An individual request
res &lt;- getCoord(&quot;æˆéƒ½ä¸­åŒ»è¯å¤§å­¦&quot;, output = &quot;XML&quot;, to_table = FALSE)
res
</code></pre>
<pre><code>## {xml_document}
## &lt;response&gt;
## [1] &lt;status&gt;1&lt;/status&gt;
## [2] &lt;info&gt;OK&lt;/info&gt;
## [3] &lt;infocode&gt;10000&lt;/infocode&gt;
## [4] &lt;count&gt;1&lt;/count&gt;
## [5] &lt;geocodes type=&quot;list&quot;&gt;\n  &lt;geocode&gt;\n    &lt;formatted_address&gt;å››å·çœæˆéƒ½å¸‚é‡‘ç‰›åŒºæˆéƒ½ä¸­åŒ» ...
</code></pre>
<p>è¿™ç±»ç»“æœå¯ä»¥ä½¿ç”¨ amapGeocode å†…ç½®çš„ <code>extractCoord()</code> å¤„ç†ä¸ºä¸ä¹‹å‰æ ¼å¼ç›¸åŒçš„ <code>tibble</code> æ ¼å¼ã€‚</p>
<pre><code class="language-r">extractCoord(res)
</code></pre>
<pre><code>## # A tibble: 1 x 12
##     lng   lat formatted_addre~ country province city  district township street
##   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;    &lt;lgl&gt;    &lt;lgl&gt; 
## 1  104.  30.7 å››å·çœæˆéƒ½å¸‚é‡‘ç‰›åŒºæˆéƒ½ä¸­åŒ»è¯å¤§~ ä¸­å›½    å››å·çœ   æˆéƒ½å¸‚~ é‡‘ç‰›åŒº   NA       NA    
## # ... with 3 more variables: number &lt;lgl&gt;, citycode &lt;chr&gt;, adcode &lt;chr&gt;
</code></pre>
<h3 id="åœ°ç†é€†ç¼–ç ">åœ°ç†é€†ç¼–ç </h3>
<p>ä¸åœ°ç†ç¼–ç çš„ä½¿ç”¨æ–¹æ³•åŸºæœ¬ç›¸åŒï¼Œ<code>getLocation()</code> ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-r">coord &lt;- tibble::tribble(~lat, ~lon, 104.043284, 30.666864, 104.039, 30.66362)
getLocation(coord$lat, coord$lon)
</code></pre>
<pre><code>## # A tibble: 2 x 8
##   formatted_address   country province city  district township citycode towncode
##   &lt;chr&gt;               &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;   
## 1 å››å·çœæˆéƒ½å¸‚é‡‘ç‰›åŒºè¥¿å®‰è·¯è¡—é“æˆéƒ½ä¸­åŒ»~ ä¸­å›½    å››å·çœ   æˆéƒ½å¸‚~ é‡‘ç‰›åŒº   è¥¿å®‰è·¯è¡—é“~ 028      5101060~
## 2 å››å·çœæˆéƒ½å¸‚é’ç¾ŠåŒºè‰å ‚è¡—é“å››å·çœåŒ»å­¦~ ä¸­å›½    å››å·çœ   æˆéƒ½å¸‚~ é’ç¾ŠåŒº   è‰å ‚è¡—é“ 028      5101050~
</code></pre>
<h3 id="è¡Œæ”¿åŒºè·å–">è¡Œæ”¿åŒºè·å–</h3>
<p>ä¸åœ°ç†ç¼–ç /é€†ç¼–ç æ–¹æ³•åŸºæœ¬ç›¸åŒï¼Œ<code>getAdmin()</code>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-r">getAdmin(c(&quot;å››å·çœ&quot;, &quot;å…°å·å¸‚&quot;, &quot;æµå®å¸‚&quot;))
</code></pre>
<pre><code>## [[1]]
## # A tibble: 21 x 6
##      lng   lat name   level citycode adcode
##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; 
##  1  107.  31.9 å·´ä¸­å¸‚ city  0827     511900
##  2  104.  30.7 æˆéƒ½å¸‚ city  028      510100
##  3  104.  31.1 å¾·é˜³å¸‚ city  0838     510600
##  4  106.  32.4 å¹¿å…ƒå¸‚ city  0839     510800
##  5  106.  30.5 é‚å®å¸‚ city  0825     510900
##  6  105.  30.1 èµ„é˜³å¸‚ city  0832     512000
##  7  105.  31.5 ç»µé˜³å¸‚ city  0816     510700
##  8  107.  30.5 å¹¿å®‰å¸‚ city  0826     511600
##  9  108.  31.2 è¾¾å·å¸‚ city  0818     511700
## 10  106.  30.8 å—å……å¸‚ city  0817     511300
## # ... with 11 more rows
## 
## [[2]]
## # A tibble: 8 x 6
##     lng   lat name     level    citycode adcode
##   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt; 
## 1  103.  36.7 æ°¸ç™»å¿   district 0931     620121
## 2  104.  36.3 çš‹å…°å¿   district 0931     620122
## 3  104.  36.1 è¥¿å›ºåŒº   district 0931     620104
## 4  103.  36.3 çº¢å¤åŒº   district 0931     620111
## 5  104.  36.1 å®‰å®åŒº   district 0931     620105
## 6  104.  36.0 åŸå…³åŒº   district 0931     620102
## 7  104.  36.1 ä¸ƒé‡Œæ²³åŒº district 0931     620103
## 8  104.  35.8 æ¦†ä¸­å¿   district 0931     620123
## 
## [[3]]
## # A tibble: 11 x 6
##      lng   lat name   level    citycode adcode
##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt; 
##  1  116.  35.7 æ±¶ä¸Šå¿ district 0537     370830
##  2  117.  35.4 é‚¹åŸå¸‚ district 0537     370883
##  3  117.  35.7 æ³—æ°´å¿ district 0537     370831
##  4  117.  35.6 æ›²é˜œå¸‚ district 0537     370881
##  5  117.  35.4 ä»»åŸåŒº district 0537     370811
##  6  116.  35.4 å˜‰ç¥¥å¿ district 0537     370829
##  7  116.  35.8 æ¢å±±å¿ district 0537     370832
##  8  117.  35.0 é±¼å°å¿ district 0537     370827
##  9  116.  35.1 é‡‘ä¹¡å¿ district 0537     370828
## 10  117.  34.8 å¾®å±±å¿ district 0537     370826
## 11  117.  35.6 å…–å·åŒº district 0537     370812
</code></pre>
<p>æ³¨æ„ï¼Œç”±äº <code>getAdmin()</code> å¯ä»¥å¯¹äº’ç›¸ç‹¬ç«‹çš„è¡Œæ”¿åŒºåŸŸè¿›è¡Œæ‰¹é‡æŸ¥è¯¢ï¼Œå› æ­¤é»˜è®¤å°†æŸ¥è¯¢ç»“æœä¹Ÿè®¸å¹¶æ— æ„ä¹‰ï¼Œå› æ­¤éœ€è¦ç”¨æˆ·è‡ªè¡Œä» list ä¸­æå–å…ƒç´ ä»¥ä¾¿è¿›ä¸€æ­¥ä½¿ç”¨ã€‚</p>
<h3 id="å®éªŒæ€§åŠŸèƒ½åæ ‡è½¬æ¢">å®éªŒæ€§åŠŸèƒ½â€”â€”åæ ‡è½¬æ¢</h3>
<p>ç”±äºä¸åŒçš„åœ°å›¾æœåŠ¡ï¼Œå…¶åæ ‡æœ‰æ—¶ä¼šåŠ å…¥ä¸€å®šç¨‹åº¦çš„åç§»ï¼Œå› æ­¤ä¸ºäº†ä½¿åæ ‡åœ¨é«˜å¾·åœ°å›¾ä¸­æŸ¥è¯¢å‡†ç¡®ï¼Œå¯ä»¥é¦–å…ˆå¯¹åŸå§‹åæ ‡è¿›è¡Œè½¬æ¢ï¼Œ<a href="https://lbs.amap.com/api/webservice/guide/api/convert">ç›®å‰é«˜å¾·å¼€æ”¾å¹³å° API æä¾›å°† GPS åæ ‡ã€mapbar åæ ‡ã€baidu åæ ‡è½¬æ¢ä¸ºé«˜å¾·åæ ‡</a>ã€‚</p>
<p><strong>ä½†æ˜¯å› ä¸ºå¼€å‘è€…ç›®å‰å¹¶æ²¡æœ‰çœŸæ­£ä½¿ç”¨è¿‡è¿™ç±»åŠŸèƒ½ï¼Œå› æ­¤ç›®å‰è¯¥æ–¹æ³•å°šå¤„äºå®éªŒé˜¶æ®µã€‚æ— è®ºæ˜¯ç»“æœå‡†ç¡®æ€§ï¼Œä»¥åŠä½¿ç”¨çš„ä¾¿æ·ç¨‹åº¦ä»¥åŠåˆç†æ€§å‡ä¸ä½œä»»ä½•ä¿è¯ã€‚åŒæ—¶åœ¨å°†æ¥ä¹Ÿè®¸ä¼šè¿›è¡Œ Breaking Upgrade é€ æˆç›®å‰çš„è°ƒç”¨æ–¹å¼ä¸å¯ç”¨ï¼Œå› æ­¤æä¸æ¨èå°†è¯¥ function å¼•å…¥ç”Ÿäº§ç¯å¢ƒã€‚åŒæ—¶ä¹Ÿå¸Œæœ›å¤§å®¶å¯¹äºè¯¥åŠŸèƒ½çš„å®Œå–„ç»™å‡ºå»ºè®®ã€‚</strong></p>
<pre><code class="language-r">convertCoord(&quot;116.481499,39.990475&quot;, coordsys = &quot;gps&quot;)
</code></pre>
<pre><code>## # A tibble: 1 x 2
##     lng   lat
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  116.  40.0
</code></pre>
<p>æ›´å¤šåŠŸèƒ½ä»¥åŠæ”¹è¿›è¿˜åœ¨å¼€å‘ä¸­ã€‚</p>
<h2 id="å¸¸è§é—®é¢˜">å¸¸è§é—®é¢˜</h2>
<h3 id="ä¼šå¼•å…¥å¹¶è¡Œè¯·æ±‚å—">ä¼šå¼•å…¥å¹¶è¡Œè¯·æ±‚å—ï¼Ÿ</h3>
<p>è™½ç„¶åœ¨å¼€å‘ä¹‹åˆï¼Œç¬”è€…è®¤ä¸ºå°†æ¥ä¸ä¼šåŠ å…¥å¹¶è¡Œï¼Œä¸è¿‡ç°åœ¨çš„è®¡åˆ’ï¼Œå¤§æ¦‚æ˜¯ä¼šå§ï¼Œè°çŸ¥é“å‘¢ï¼Ÿ <s>Unfortunately, there is no plan to add internal parallel support to amapGeocode. Here are some reasons:</s></p>
<p><s>1. The aim of amapGeocode is to create a package which is easy to use. Indeed, the parallel operation can make many times performance improvement, especially there are half million queries. However, the parallel operation often platform limited, I donâ€™t have enough time and machine to test on different platforms. In fact even in macOS, the system Iâ€™m relatively familiar with, I have already encountered a lot of weird parallel issues and I donâ€™t have the intention or the experience to fix them.</s></p>
<p><s>2. The queries limitation. For most of free users or developers, the daily query limitation and queries per second is absolutely enough: 30,000 queries per day and 200 queries per second. But for parallel operation, the limitation is relatively easy to exceed. For purchase developers, it may cause serious financial troubles.</s></p>
<p><s>So for anybody who wants to send millions of request by amapGeocode, you are welcomed to make the parallel operations manually.</s></p>
<h2 id="bug-report">Bug Report</h2>
<p>å¯¹äº API Wrap ç±»å‹çš„åŒ…ï¼Œä¸Šæ¸¸ API æ›´æ–°é€ æˆçš„åŠŸèƒ½ä¸å¯ç”¨åœ¨æ‰€éš¾å…ã€‚å¦‚æœä½ é‡åˆ°è¿™ç±»æ•…éšœæˆ–è€…ä»»ä½•å…¶å®ƒ Bugï¼Œè¯·ç¬¬ä¸€æ—¶é—´è®©æˆ‘çŸ¥é“ <a class="github-button" href="https://github.com/womeimingzi11/amapGeocode/issues" data-color-scheme="no-preference: light; light: light; dark: dark;" data-size="large" aria-label="Issue womeimingzi11/amapGeocode on GitHub">Issue</a>ï¼</p>
<p>å¦‚æœ amapGeocode å¯¹ä½ æœ‰ä»»ä½•å¸®åŠ©ï¼Œå¸Œæœ›å¯ä»¥å¸®æˆ‘ <a class="github-button" href="https://github.com/womeimingzi11/amapGeocode" data-color-scheme="no-preference: light; light: light; dark: dark;" data-size="large" aria-label="Star womeimingzi11/amapGeocode on GitHub">Star</a></p>
<hr>
<p>æ¬¢è¿é€šè¿‡<a href="mailto://chenhan28@gmail.com">é‚®ç®±</a>ï¼Œ<a href="https://weibo.com/womeimingzi11">å¾®åš</a>, <a href="https://twitter.com/chenhan1992">Twitter</a>ä»¥åŠ<a href="https://www.zhihu.com/people/womeimingzi">çŸ¥ä¹</a>ä¸æˆ‘è”ç³»ã€‚ä¹Ÿæ¬¢è¿å…³æ³¨<a href="https://https://blog.washman.top/">æˆ‘çš„åšå®¢</a>ã€‚å¦‚æœèƒ½å¯¹<a href="https://github.com/womeimingzi11">æˆ‘çš„ Github</a> æ„Ÿå…´è¶£ï¼Œå°±å†æ¬¢è¿ä¸è¿‡å•¦ï¼</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[R for Everything ç•ªå¤–: R åŒ…å¼€å‘ä¸­ vignette/test token çš„å¤„ç†]]></title>
        <id>https://womeimingzi11.github.io/post/mEmVc9Hsx/</id>
        <link href="https://womeimingzi11.github.io/post/mEmVc9Hsx/">
        </link>
        <updated>2020-09-24T20:51:38.000Z</updated>
        <summary type="html"><![CDATA[<p>skip_on_cran() for testhat and NOT_CRAN for vignette</p>
]]></summary>
        <content type="html"><![CDATA[<p>skip_on_cran() for testhat and NOT_CRAN for vignette</p>
<!-- more -->
<p>ä½œä¸ºä¸€ä¸ªä¸æ€ä¹ˆ Skr çš„ API Wrapperï¼Œæœ€è¿‘èŠ±å¼çš„ç”¨åˆ°äº†é«˜å¾·åœ°å›¾çš„åœ°ç†ç¼–ç /é€†ç¼–ç æœåŠ¡ï¼Œä¸å…¶æ•£ä¹±å„å¤„æ¯æ¬¡éƒ½è¦åå¤ä¿®æ”¹ function ä»£ç ï¼Œä¸å¦‚å¹²è„†å°±å°è£…æˆ packageï¼Œè¿˜èƒ½æ–¹ä¾¿è‡ªå·±å’Œå›¢é˜Ÿä»Šåçš„ä½¿ç”¨ã€‚</p>
<p>ä½œä¸ºå¹´è½»äººï¼ˆå¹¶ä¸ï¼‰çš„ç¬¬ä¸€ä¸ª Packageï¼Œå½“ç„¶æ˜¯å‚è€ƒ Hadley çš„ç»å…¸æ‰‹å†Œ<a href="https://r-pkgs.org/">ã€ŠR Packageã€‹</a>ï¼Œæ­¤å¤–è¿˜å‚è€ƒäº†æ¥è‡ª Fong Chun Chanâ€™s Blog çš„ <a href="https://tinyheero.github.io/jekyll/update/2015/07/26/making-your-first-R-package.html">Making Your First R Package</a> ä½œä¸ºå¿«é€Ÿæ‰‹å†Œã€‚Functions ç¼–å†™çš„è¿‡ç¨‹éå¸¸çš„æ„‰å¿«ï¼Œæ¯•ç«Ÿåªæ˜¯ url ä¸ reques body çš„ç»„è£…ï¼Œåœ¨ <a href="https://CRAN.R-project.org/package=httr">httr</a>, <a href="https://arxiv.org/abs/1403.2805">jsonlite</a> ä»¥åŠ <a href="https://CRAN.R-project.org/package=xml2">XML2</a> ç­‰ä¸‰ä¸ªä¸»è¦åŒ…çš„å¸®åŠ©ä¸‹ï¼ŒAPI Wrap åªä¸è¿‡æ˜¯ä½“åŠ›æ´»ã€‚ç›®å‰åŒ…æ­£åœ¨ CRAN å®¡æ ¸ï¼Œå¦‚æœä¸Šçº¿äº†åº”è¯¥åˆèƒ½æ°´ä¸€ç¯‡æ–‡ç« ï¼Œä¸è¿‡æ²¡ä¸Šçº¿ä¹Ÿåº”è¯¥ä¼šæ°´ä¸€ç¯‡â€¦â€¦è®°è´¦ä¸Šå§å…ˆã€‚</p>
<p>ç„¶è€Œï¼Œä¸å†™ä¸šåŠ¡ä»£ç ç›¸æ¯”ï¼Œæäº¤åŒ…åˆ° CRAN æ²¡æƒ³åˆ°æ˜¯æœ€ç—›è‹¦çš„ã€‚æœ€ä¸»è¦çš„åŸå› ä¹‹ä¸€ï¼Œå°±æ˜¯ä½œä¸ºä¸€ä¸ª API è°ƒç”¨çš„åŒ…ï¼Œå‡ ä¹æ‰€æœ‰çš„æ“ä½œéƒ½éœ€è¦è°ƒç”¨ tokenï¼š</p>
<ol>
<li>å†™ functionï¼Œéœ€è¦æä¾› key å‚æ•°ï¼ˆ<em>é«˜å¾·æä¾› tokenï¼Œå®˜æ–¹æ–‡æ¡£ç§°ä¸º keyï¼Œä¸ºäº†ç»Ÿä¸€ï¼Œä¸€å¹¶ç§°ä¸ºkeyï¼Œä¸‹åŒ</em>ï¼‰ï¼Œè¿™ä¸ªå¾ˆç®€å•ï¼Œå•ç‹¬èµ‹å€¼æˆ–è€…ä» <code>getOption('amap_key')</code> ä¸­è·å–ï¼ˆ<em>æ­¤ä¸º function ä¸­çš„é€»è¾‘ï¼Œé R ç¼ºçœæ“ä½œï¼Œä¸‹åŒ</em>ï¼‰å‡å¯ï¼Œæ— è®ºæ˜¯æµ‹è¯•è¿˜å®é™…ä¸šåŠ¡éƒ½èƒ½è½»æ¾å®Œæˆï¼Œä¹Ÿæ— éœ€æš´éœ² keyï¼›</li>
<li>å†™ READMEï¼Œè™½ç„¶ä¸æ˜¯ CRAN å¼ºåˆ¶è¦æ±‚çš„ï¼Œä½†æ˜¯ä½œä¸ºè‚¯å®šä¼šåœ¨ GITHUB å¼€æºçš„é¡¹ç›®ï¼ŒREADME å¿…ä¸å¯å°‘ï¼Œä» Rmarkdown åˆ° Markdownï¼Œå› ä¸ºæ˜¯åœ¨æœ¬åœ°ç¼–è¯‘ï¼Œä¹Ÿå¯ä»¥ä» Option ä¸­è·å–ï¼Œå› æ­¤ç¼–è¯‘æˆçš„ Markdown å’ŒåŸå§‹ Rmarkdown æ–‡ä»¶ä¸­å‡å¯éšå» keyï¼›</li>
<li>å†™å•å…ƒæµ‹è¯•ï¼Œè¿™ä¸ªå°±å¼€å§‹æœ‰å‘äº†ã€‚è™½ç„¶<code>devtools::test</code>å¯ä»¥é€šè¿‡æµ‹è¯•ï¼Œä½†æ˜¯åœ¨<code>devtools::check()</code>ä¸­å› ä¸ºæ¯æ¬¡æµ‹è¯•éƒ½æ˜¯åœ¨ç‹¬ç«‹çš„ NAMESPACE ä¸­è¿›è¡Œçš„ï¼Œå› æ­¤å³ä¾¿æ˜¯è®¾ç½®äº† <code>option(var1 = value1)</code>ï¼Œåœ¨æµ‹è¯•ä¸­çš„ <code>getOption('var1')</code> ä¾ç„¶è¿”å› <code>NULL</code>ï¼Œå› æ­¤éœ€è¦åœ¨æµ‹è¯•ä¸­åŠ å…¥ key çš„å€¼ï¼Œè¿™å°±ä½¿å¾— token ä¼šéšç€ package çš„åˆ†å‘ï¼Œå¯¹æ‰€æœ‰çš„ç”¨æˆ·å¯è§ï¼›</li>
<li>å†™ vignetteï¼Œè¿™ä¸ªå‘å’Œå•å…ƒæµ‹è¯•æƒ…å†µç›¸ä¼¼ï¼Œå³ä¾¿æ˜¯ option ä¸­åŠ å…¥äº†å˜é‡ï¼Œä¾ç„¶ä¸èƒ½ä¿è¯å¯ä»¥æ­£ç¡®ç¼–è¯‘ï¼Œå¹¶ä¸”æ¯”è¾ƒç„å­¦çš„æ˜¯æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ä» option ä¸­è¯»å–å˜é‡ï¼Œä½†æ˜¯åœ¨ R Studio çš„ Build é¡µé¢ä¸­è¿è¡Œ check åˆä¸å¯ä»¥è·å–ï¼Œæœ€ç»ˆæŠ¥é”™ã€‚è€Œä¸”å³ä¾¿æ˜¯æœ¬åœ°ç¼–è¯‘æˆåŠŸï¼Œå¦‚æœä¸åšä»»ä½•é¢å¤–çš„æ“ä½œï¼Œå‘é€åˆ°è¿œç«¯æœåŠ¡å™¨åä¾ç„¶æ— æ³•ç¼–è¯‘æˆåŠŸï¼ŒåŸå› ä¹Ÿå¾ˆç®€å•å¯¹æ–¹çš„ç¯å¢ƒä¸­æ¯•ç«Ÿæ²¡æœ‰ key å˜é‡ï¼Œå› æ­¤éœ€è¦åœ¨ vignette ç›¸å…³éƒ¨åˆ†åŠ å…¥ key çš„å€¼ï¼Œå†æ¬¡ä¼šé€ æˆ key çš„æ³„éœ²ã€‚</li>
</ol>
<p>è™½ç„¶ï¼Œä½œä¸ºå…è´¹çš„ tokenï¼Œå¤§æ¦‚æœ‰å¿ƒç›—ç”¨çš„äººä¹Ÿä¸ä¼šå¤ªå¤šï¼Œå†µä¸” package æœ‰äººç”¨æ²¡äººç”¨è¿˜æ˜¯å¾ˆéš¾ä¹è§‚çš„è®®é¢˜ã€‚ç„¶è€Œï¼Œä¿¡æ¯æ³„éœ²æ€»å½’æ˜¯ä¸å¥½çš„ã€‚</p>
<p>ä¸ºäº†è§£å†³é—®é¢˜ 3ã€4ï¼ŒèŠ±è´¹äº†æ¯”å†™ä¸šåŠ¡ä»£ç è¿˜ä¹…çš„æ—¶é—´ï¼Œè™½ç„¶æœ‰å¾ˆå¤§çš„æ¦‚ç‡ä¸æ˜¯æœ€ä¼˜ï¼Œå¹¶ä¸”å…¶å®ä¹¦é‡Œé¢æœ‰æåˆ°ã€‚ä½†æ—¢ç„¶è‡ªå·±é‡åˆ°äº†ï¼Œå¹¶ä¸”<br>
Stackoverflow ä¹Ÿæœ‰äººæå®Œï¼Œä¸å¦‚ä¾ç„¶åšä¸ªè®°å½•ï¼Œä¸‡ä¸€èƒ½å¸®åˆ°åŒæ ·æ²¡è®¤çœŸçœ‹ä¹¦çš„æœ‹å‹å‘¢?</p>
<h2 id="no-vignette-no-test-no-trouble">No vignette, No test, No Trouble?</h2>
<p>æœ€å…ˆæƒ³åˆ°çš„æ–¹æ³•ï¼Œå½“ç„¶æ˜¯æ”¾å¼ƒã€‚æ¯•ç«Ÿæˆ‘ä»¬å¹³æ—¥å†™ functionï¼Œè¿æ³¨é‡Šéƒ½æ²¡æœ‰ï¼Œå†™ä¸€ä¸ªä¸æ€ä¹ˆæ ·çš„åŒ…ï¼Œæ€ä¹ˆè¿˜è¦å†™æ–‡æ¡£äº†å‘¢?è‡ªå·±å»æ‚Ÿä¸å¥½ä¹ˆ?</p>
<p>å…³äº vignette å’Œ test çš„å¿…è¦æ€§ï¼Œè¿™é‡Œå°±ä¸å†åšç§‘æ™®äº†ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥å‚è€ƒã€ŠR Packageã€‹ä¸­çš„ç« èŠ‚ <a href="https://r-pkgs.org/vignettes.html"><em>Vignettes: long-form documentation</em></a> ä»¥åŠ <a href="https://r-pkgs.org/tests.html"><em>Testing</em></a>ã€‚ç„¶è€Œå…¶å®ä¹¦é‡Œé¢<strong>å¥½åƒæ˜¯</strong>æ²¡è®²åˆ°çš„é—®é¢˜æ˜¯ï¼Œè¿œç¨‹æ£€æŸ¥ä»£ç çš„è¿‡ç¨‹ä¸­ä¼šå›æŠ¥ä¸€ä¸ª Warningï¼š<br>
<img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/Fig01_no_e_no_t_no_v.png" alt="" loading="lazy"></p>
<p>è¯šç„¶ï¼ŒWarning ~= Canâ€™t be betterï¼Œç„¶è€Œåœ¨ CRAN æäº¤çš„è¿‡ç¨‹ä¸­ï¼ŒWARNING ~= ERROR</p>
<blockquote>
<p>Check results: I always state that there were no errors or warnings. Any NOTEs go in a bulleted list. For each NOTE, I include the message from R CMD check and a brief description of why I think it's OK. If there were no NOTEs, I'd say â€œThere were no ERRORs, WARNINGs or NOTEs â€”â€” R Package: Chapter 20.3 The submission processâ€</p>
</blockquote>
<p>è™½ç„¶å¯ä»¥é€‰æ‹© Upload åˆ° CRANï¼Œä¸è¿‡åœ¨ Review æ­¥éª¤ä¹Ÿå¾ˆå®¹æ˜“è¢«è¿”å›ã€‚å› æ­¤è¿™ç§è±è¾¾çš„æ“ä½œæ˜¯è¡Œä¸é€šçš„ã€‚</p>
<h2 id="skip_on_cran-for-testthat">skip_on_cran() for testthat</h2>
<p>åœ¨ test éƒ¨åˆ†æƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®å¯ä»¥åœ¨ test èµ·å§‹éƒ¨åˆ†åŠ å…¥ skip_on_cran() æ–¹æ³•ï¼ˆä¸‹åˆ—ä»£ç ç¬¬äºŒè¡Œï¼‰</p>
<pre><code class="language-r"># Test whether getAdmin can retrun right class withou to_tibble
test_that(&quot;Reuturn raw respone with correct location&quot;, {
    skip_on_cran()
    res &lt;- getAdmin(&quot;å››å·çœ&quot;, to_table = F)
    res_class &lt;- class(res)
    
    expect_equal(any(stringr::str_detect(res_class, &quot;list&quot;)), TRUE)
})
</code></pre>
<p>è¿™ä¸ªæ–¹æ³•å…¶å®åœ¨ R Package: Chapter 12.5 CRAN notes æœ‰æåˆ°ï¼š</p>
<blockquote>
<p>Tests need to run relatively quickly - aim for under a minute. Place  skip_on_cran() at the beginning of long-running tests that shouldn't be run on CRAN - they'll still be run locally, but not on CRAN.</p>
</blockquote>
<p>ä¸è¿‡ä¸€æ–¹é¢æ˜¯å› ä¸ºçœ‹ä¹¦ä¸è®¤çœŸï¼Œå¦ä¸€æ–¹é¢åªæ˜¯æ³¨æ„åˆ°è¿™æ–¹æ³• Hadley çš„æ„å›¾æ˜¯åŠ å¿«æµ‹è¯•æ—¶é—´ï¼Œåªåœ¨æœ¬åœ°è¿›è¡Œæµ‹è¯•ï¼Œå› æ­¤å¿½ç•¥äº†è¿™ç§æ— æ³•åœ¨è¿œç«¯è¿›è¡Œæµ‹è¯•çš„åœºæ™¯ã€‚</p>
<p>ä¸è¿‡æ·»åŠ è¿™ä¸ªæ–¹æ³•åé—®é¢˜ä¹Ÿä¸æ˜¯å…¨ç„¶è§£å†³ï¼Œå› ä¸ºæ­£å¦‚å‰é¢æ‰€è¯´ï¼Œ<code>devtools::check</code>ä¸­çš„å•å…ƒæµ‹è¯•ä¼šåœ¨å•ç‹¬çš„ NAMESPACE ä¸­è¿›è¡Œï¼Œå› æ­¤å³ä¾¿æ˜¯åœ¨æœ¬åœ°è¿è¡Œï¼Œå¦‚æœä¸å•ç‹¬æŒ‡å®š keyï¼Œæ£€æŸ¥è¿‡ç¨‹ä¾ç„¶ä¼šå¤±è´¥ã€‚å› æ­¤æˆ‘ä»¬ç”¨åˆ°äº†<code>skip()</code>family çš„å¦å¤–ä¸€ç§å½¢å¼<code>skip_if()</code>æ¥è¿›è¡Œäº†æ¡ä»¶åˆ¤æ–­:å³åªæœ‰æ»¡è¶³ condition çš„æ—¶å€™æ‰ä¼šè¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œåœ¨æœ¬æ¡ˆä¾‹ä¸­å…·ä½“è€Œè¨€å°±æ˜¯ option ä¸å­˜åœ¨ amap_key å‚æ•°ï¼Œåˆ™ä¸è¿›è¡Œæµ‹è¯•ï¼š</p>
<pre><code class="language-r">skip_if(is.null(getOption(&quot;amap_key&quot;)))
</code></pre>
<p>æ›´å¤š skip æ–¹æ³•è¯·å‚è€ƒ<code>help(testthat::skip)</code></p>
<p>no test çš„ Warning è¢«è§£å†³ï¼Œåªä¸è¿‡å› ä¸º CRAN ä¼šè·³è¿‡æµ‹è¯•æ­¥éª¤ï¼Œå¤„äºä¿é™©èµ·è§ï¼Œè¿˜æ˜¯åº”è¯¥åœ¨æœ¬åœ°è¿›è¡Œæ›´ä»”ç»†çš„æµ‹è¯•ã€‚</p>
<h2 id="not_cran-for-vignette">NOT_CRAN for vignette</h2>
<p><strong>Note: è¿™ä¸ªéƒ¨åˆ†ï¼Œè™½ç„¶è§£å†³äº† Warning è­¦å‘Šï¼Œä½†å®é™…ä¸Šå¤„ç†å¹¶ä¸å®Œç¾ï¼šæ— æ³•åœ¨æ–‡æ¡£ä¸­é¢„è§ˆå˜é‡ï¼Œå®é™…ä¸Šåªæ˜¯æ˜¾ç¤ºäº†é™æ€ä»£ç å—ã€‚å¦‚æœæœ‰æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œè¿˜æœ›ä¸åèµæ•™</strong></p>
<p>åœ¨ Hadley ä¸º httr ç¼–å†™çš„ vignette <a href="https://cran.r-project.org/web/packages/httr/vignettes/secrets.html">Managing secrets</a> ä¸­å¯¹äºå¦‚ä½•å¤„ç†ä¿å¯†çš„æ•°æ®æœ‰äº†å¾ˆå……åˆ†çš„è®¨è®ºã€‚</p>
<blockquote>
<p>Vignettes pose additional challenges when an API requires authentication, because you don't want to bundle your own credentials with the package! However, you can take advantage of the fact that the vignette is built locally, and only checked by CRAN.</p>
</blockquote>
<p>å› ä¸º Vignettes æ˜¯åœ¨æœ¬åœ°è¿›è¡Œç¼–è¯‘çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŒ‡å®šä»…ä»…ä½¿ç”¨ CRAN è¿›è¡Œæ£€æŸ¥å·¥ä½œï¼ˆè€Œéå†æ¬¡æ„å»ºï¼‰ã€‚</p>
<p>åªè¦åœ¨é¦–æ¬¡è°ƒç”¨ token çš„ä»£ç å—ä¹‹å‰æ·»åŠ ä»£ç å—è®¾å®š <code>knitr:opts_chunk$set</code>ï¼Œé€šå¸¸æ˜¯ vignette æ–‡å­—å¼€å§‹ä¹‹å‰ï¼Œæ–‡æ¡£çš„ YAML Header ç»“æŸä¹‹åã€‚</p>
<pre><code class="language-r">NOT_CRAN &lt;- identical(tolower(Sys.getenv(&quot;NOT_CRAN&quot;)), &quot;true&quot;),
knitr::opts_chunk$set(purl = NOT_CRAN)
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/Fig02_chunk_set.png" alt="" loading="lazy"></figure>
<p>ä¹‹ååœ¨æ‰€æœ‰éœ€è¦è°ƒç”¨ Token çš„ä»£ç å—ä¸­ï¼Œå°† eval è®¾å®šä¸º <code>eval = NOT_CRAN</code>ï¼Œä¹‹ååœ¨ CRAN æ£€æŸ¥ä¸­ vignette æ„å»ºçš„æ­¥éª¤ä¾¿ä¸ä¼šæŠ¥ ERRORã€‚</p>
<p><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/Fig03_eval_NOT_CRAN.png" alt="" loading="lazy"><br>
<em>å›¾ä¸­æœ‰é‡å¤èµ‹å€¼ï¼Œå·²ä¿®æ”¹</em></p>
<p>åœ¨è¯¥æ–¹æ³•ä¸­ï¼Œä¼šå¯¹ R è¿è¡Œç¯å¢ƒè¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœå½“å‰ç¯å¢ƒä¸º CRAN åˆ™ä¸è¿è¡Œ vignette æ–‡æ¡£ä¸­çš„ä»£ç å—ï¼Œä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼ŒRmarkdown ä¸­çš„ä»£ç å—ä¹Ÿå°±ä¸ä¼šè¿”å›æ‰§è¡Œå†…å®¹ï¼Œå› æ­¤æ–‡æ¡£ä¸­ä¹Ÿä¸ä¼šæ˜¾ç¤ºç»“æœï¼Œä»£ç å—ä»…åšé™æ€å±•ç¤ºä¹‹ç”¨ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/Fig04_no_preview.png" alt="" loading="lazy"></figure>
<h2 id="é”™è¯¯çš„æŒ£æ‰">é”™è¯¯çš„æŒ£æ‰</h2>
<p>åœ¨ç¬¬äºŒå¼ å›¾ä¸­ï¼Œå¯ä»¥å‘ç°åœ¨ä½¿ç”¨ NOT_CRAN æ¥è§£å†³ vignette é”™è¯¯ä¹‹å‰ï¼Œæˆ‘è¿˜å¸¸ä½¿ç”¨ source R script çš„æ–¹æ³•è§£å†³é—®é¢˜ï¼Œå½“æ—¶çš„è®¾æƒ³å¾ˆå®Œç¾ï¼šå°† <code>option(amap_key=&quot;My token&quot;)</code>å†™å…¥å¤–éƒ¨æ–‡ä»¶ï¼Œä¹‹åå°†å¤–éƒ¨æ–‡ä»¶æ”¾å…¥ .Rbuildignore ä¸­åœ¨ package æ‰“åŒ…çš„è¿‡ç¨‹ä¸­æ’é™¤æ‰ï¼Œæ˜¯å¦å°±èƒ½å¾—åˆ°å®Œç¾çš„è§£å†³æ–¹æ¡ˆäº†å‘¢?</p>
<p>ç„¶è€Œå®é™…ä¸Šï¼Œæ”¾å…¥ .Rbuildignore ä¸­çš„æ–‡ä»¶å› ä¸ºè¢«æ’é™¤åœ¨äº†æ‰“åŒ…ä¹‹å¤–ï¼Œè€Œæ„å»º vignette æ˜¯å®Œæˆæ‰“åŒ…ä¹‹åæ–¹æ‰è¿›è¡Œï¼Œå› æ­¤è¿™ç§æƒ…å†µä¸‹æ˜¯æ‰¾ä¸åˆ°æ–‡ä»¶åœ°å€çš„ï¼ˆå› ä¸ºæ²¡æœ‰åœ¨å·²ç»æ‰“åŒ…å®Œæˆçš„libraryç›®å½•ä¸­ï¼‰ã€‚</p>
<p>é€šè¿‡è¿™äº›æ–¹æ³•ï¼Œç›®å‰æš‚æ—¶å®ç°äº† 0 error 0 warningï¼Œå„ä½å¤„ç†è¿‡ç›¸ä¼¼é—®é¢˜çš„å‰è¾ˆå¦‚æœæœ‰æ›´åˆç†çš„è§£å†³æ–¹æ¡ˆï¼Œè¿˜æœ›èƒ½åˆ†äº«æŒ‡ç‚¹ã€‚</p>
<hr>
<p>æ¬¢è¿é€šè¿‡<a href="mailto://chenhan28@gmail.com">é‚®ç®±</a>ï¼Œ<a href="https://weibo.com/womeimingzi11">å¾®åš</a>, <a href="https://twitter.com/chenhan1992">Twitter</a>ä»¥åŠ<a href="https://www.zhihu.com/people/womeimingzi">çŸ¥ä¹</a>ä¸æˆ‘è”ç³»ã€‚å¦‚æœèƒ½å¯¹<a href="https://github.com/womeimingzi11">æˆ‘çš„ Github</a> æ„Ÿå…´è¶£ï¼Œå°±å†æ¬¢è¿ä¸è¿‡å•¦ï¼</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Shiny apps: ä½¿ç”¨ moreThanANOVA è¿›è¡Œã€Œæ­£ç¡®ã€çš„æ˜¾è‘—æ€§æ£€éªŒ]]></title>
        <id>https://womeimingzi11.github.io/post/YdOGNuodh/</id>
        <link href="https://womeimingzi11.github.io/post/YdOGNuodh/">
        </link>
        <updated>2020-06-09T06:41:26.000Z</updated>
        <summary type="html"><![CDATA[<h2 id="tldr">TL:DR</h2>
<p>ä½¿ç”¨ <a href="https://hanchen.shinyapps.io/moreThanANOVA/">moreThanANOVA</a> å¯ä»¥è‡ªåŠ¨é€‰æ‹©é€‚å½“çš„æ–¹æ³•æ˜¾è‘—æ€§æ£€éªŒå¹¶è¾“å‡ºå¤šé‡æ¯”è¾ƒçš„å›¾è¡¨ï¼ˆå¦‚é¢˜å›¾ï¼‰</p>
]]></summary>
        <content type="html"><![CDATA[<h2 id="tldr">TL:DR</h2>
<p>ä½¿ç”¨ <a href="https://hanchen.shinyapps.io/moreThanANOVA/">moreThanANOVA</a> å¯ä»¥è‡ªåŠ¨é€‰æ‹©é€‚å½“çš„æ–¹æ³•æ˜¾è‘—æ€§æ£€éªŒå¹¶è¾“å‡ºå¤šé‡æ¯”è¾ƒçš„å›¾è¡¨ï¼ˆå¦‚é¢˜å›¾ï¼‰</p>
<!-- more -->
<h2 id="anova-ä¸æ˜¯ä¸‡é‡‘æ²¹">ANOVA ä¸æ˜¯ä¸‡é‡‘æ²¹</h2>
<p>æ˜¾è‘—æ€§æ£€éªŒå¯ä»¥è¯´æ˜¯è‡ªç„¶ç§‘å­¦é¢†åŸŸä¸­æœ€å¸¸è§çš„æ“ä½œï¼Œæ¯•ç«Ÿæ¢ç©¶å¤„ç†é—´æ˜¯å¦æœ‰å·®å¼‚ã€åŒºåŸŸé—´ç‰¹å¾å¼‚åŒæ˜¯åç»­æ¢ç´¢ä»¥åŠå‡è®¾çš„ç¬¬ä¸€æ­¥ã€‚</p>
<p>ç„¶è€Œï¼Œå½“æˆ‘ä»¬é˜…è¯»æ–‡çŒ®å’ŒæŠ¥å‘Šä¹‹æ—¶ä¸éš¾å‘ç°ï¼Œå•å› ç´ æ–¹å·®åˆ†æ ANOVA ä¼¼ä¹æ˜¯è¢«ç”¨æ¥è¿›è¡Œæ˜¾è‘—æ€§æ£€éªŒçš„å”¯ä¸€æ–¹æ³•ï¼Œä½†å‡¡å±•ç¤ºæ˜¾è‘—æ€§ï¼Œå¦‚æœæ²¡ä»€ä¹ˆæ„å¤–å¿…ç„¶æ˜¯é€šè¿‡ ANOVA åšå‡ºçš„ç»“æœã€‚è€Œä¹‹æ‰€ä»¥å‡ºç°è¿™ç§çŠ¶å†µï¼Œé™¤äº†æ•°æ®ç¡®å®éœ€è¦ ANOVA æ£€éªŒï¼Œã€Œå…¶ä»–äººéƒ½ç”¨è¿™ä¸ªæ–¹æ³•ã€ä¹Ÿæ˜¯é‡è¦å› ç´ ã€‚ç„¶è€Œï¼Œç”¨çš„äººå¤šçš„æ–¹æ³•å°±ä¸€å®šæ˜¯å¯¹çš„æ–¹æ³•å—ï¼Ÿ</p>
<p><strong>å½“ç„¶ä¸æ˜¯</strong>ï¼Œä½¿ç”¨ ANOVA æ£€éªŒæ•°æ®æœ€é‡è¦çš„å‰æä¾¿æ˜¯å‡è®¾æ•°æ®ç¬¦åˆæ­£æ€åˆ†å¸ƒã€‚</p>
<p>è™½ç„¶é€šå¸¸æ¥è¯´ï¼Œå½“æ•°æ®çš„é‡è¶³å¤Ÿå¤§çš„æƒ…å†µä¸‹ï¼Œå¾€å¾€ä¼šå‘ˆç°å‡ºæ­£æ€åˆ†å¸ƒï¼Œä½†å½“å…·ä½“åˆ°æŸæ¬¡ç ”ç©¶ä¸­ï¼Œç»“æœå´å¹¶ä¸è§å¾—å¦‚æ­¤ã€‚å½“ç„¶æˆ‘ä»¬è¿˜æœ‰æ•°æ®è½¬æ¢è¿™ç±»æ“ä½œï¼Œå¯ä»¥è¯•å›¾è®©å„ç§æ•°æ®å°½å¯èƒ½çš„è¾¾åˆ°ç¬¦åˆæ­£æ€åˆ†å¸ƒï¼Œç„¶è€Œå°±åƒä¸æ˜¯æ‰€æœ‰çš„ä»˜å‡ºéƒ½æœ‰å›æŠ¥ä¸€æ ·ï¼Œä¹Ÿä¸æ˜¯æ‰€æœ‰çš„æ•°æ®è½¬æ¢éƒ½èƒ½è¾¾åˆ°æ­£æ€æœŸæœ›ï¼Œäº¦æˆ–è€…é€šè¿‡å¤æ‚çš„è½¬æ¢æ•°æ®ä¹Ÿè®¸èƒ½å¤Ÿå®ç°æ­£æ€åˆ†å¸ƒï¼Œç„¶è€Œå¤æ‚çš„è½¬æ¢æœ¬èº«åˆä¼šä»¤è§£é‡Šå·¥ä½œå˜å¾—å¤æ‚ã€‚</p>
<p>å½“ç„¶ï¼Œå³ä¾¿æ•°æ®åˆ†å¸ƒä¸ç¬¦åˆæ­£æ€åˆ†å¸ƒï¼Œä½¿ç”¨ ANOVA è¿›è¡Œæ˜¾è‘—æ€§æ£€éªŒä¹Ÿä¼šå¾—åˆ°ç»“æœï¼Œç”šè‡³æ˜¯ä½ å–œæ¬¢çš„ç»“æœã€‚ç„¶è€Œä½¿ç”¨é”™è¯¯çš„æ–¹æ³•å¾—åˆ°çš„ã€Œç¾å¥½ã€ç»“æœä¾ç„¶æ˜¯é”™è¯¯çš„ã€‚</p>
<h2 id="ä¸æ­¢æ˜¯-anova">ä¸æ­¢æ˜¯ ANOVA</h2>
<p>å¯¹äºæ— æ³•ä½¿ç”¨ ANOVA è¿›è¡Œæ˜¾è‘—æ€§æ£€éªŒçš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é€€è€Œæ±‚å…¶æ¬¡é€‰æ‹©<strong>éå‚æ•°æ£€éªŒ</strong> non-parametric testsï¼Œå…¶ä¸­æœ€å¸¸è§çš„ä¾¿æ˜¯ç§©æ£€éªŒ Rank testã€‚å¯¹äºåªæœ‰ä¸¤ç»„/å¤„ç†çš„æ•°æ®ï¼Œé€šå¸¸ä½¿ç”¨ <strong>Mannâ€“Whitney U test</strong>æˆ–<strong>Wilcox test</strong>ï¼Œå¯¹äºæœ‰ä¸‰ç»„/å¤„ç†åŠä»¥ä¸Šçš„æ•°æ®å¯ä»¥ä½¿ç”¨ <strong>Kruskal-Wallis test</strong>.</p>
<p>æ­¤å¤–ï¼Œæ ¹æ®ç»„é—´æ ·æœ¬æ•°é‡å¼‚åŒè¿˜åˆ†ä¸ºç§©å’Œæ£€éªŒ Rank Sum Test å’Œç§©åºæ£€éªŒ Signed Rank Testï¼Œå…¶ä¸­çš„ç»†èŠ‚æ­¤å¤„ä¸å†è¯¦è¿°ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹æ–‡ç« ï¼š</p>
<ol>
<li><a href="http://www.sthda.com/english/wiki/unpaired-two-samples-wilcoxon-test-in-r">Unpaired Two-Samples Wilcoxon Test in R</a></li>
<li><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/wilcox.test">wilcox.test</a></li>
</ol>
<p>è™½ç„¶éå‚æ•°æ£€éªŒå…¶æ•°æ®æ•æ„Ÿåº¦ä¸ ANOVA è¿™ç±»å‚æ•°æ£€éªŒæ•°æ®æ•æ„Ÿåº¦ç›¸æ¯”è¾ƒä½ï¼Œç„¶è€Œæ­£ç¡®çš„åˆ†ææ–¹æ³•ä¾ç„¶æ˜¯æ‰€æœ‰è®¨è®ºçš„å‰æã€‚</p>
<h2 id="æ­£ç¡®çš„æµç¨‹">æ­£ç¡®çš„æµç¨‹</h2>
<p>å› æ­¤ï¼Œä¸€æ¬¡æ­£ç¡®çš„æ˜¾è‘—æ€§æ£€éªŒçš„æµç¨‹åº”å½“ä¸ºï¼š</p>
<ol>
<li>è¾“å…¥æ•°æ®</li>
<li>æ•°æ®åˆ†å¸ƒæ¢ç´¢</li>
<li>æ•°æ®è½¬æ¢ï¼ˆå¯é€‰ï¼‰</li>
<li>æ£€éªŒæ–¹æ³•ç¡®å®š</li>
<li>æ˜¾è‘—æ€§æ£€éªŒ</li>
<li>å¤šé‡æ¯”è¾ƒ</li>
</ol>
<p>è™½ç„¶è¿™äº›æ­¥éª¤æ¯ä¸€æ­¥ä½¿ç”¨ R å®ç°éƒ½å¹¶ä¸å¤æ‚ï¼Œç„¶è€Œå½“éœ€è¦æ¯”è¾ƒç»„é—´ N ä¸ªå˜é‡çš„å·®å¼‚æ—¶ï¼Œå³ä¾¿é‡‡ç”¨äº† map-reduce æ¨¡å¼å¤„ç†ï¼Œä¾ç„¶éœ€è¦å¤§é‡çš„å·¥ä½œï¼Œæ›´ä½•å†µå¦‚ä½•å°† R console ä¸­æ‰“å°çš„ç»“æœæ•´ç†ä¸ºå¯ä»¥ç¼–è¾‘çš„è¡¨æ ¼ä»¥åŠå°†ç»“æœåˆ¶ä½œæˆå¯ä¾›å‡ºç‰ˆçš„ç¤ºæ„å›¾ï¼Œä¹Ÿä¼šéœ€è¦æ›´å¤šé¢å¤–çš„å·¥ä½œã€‚</p>
<p>åŸºäºæ­¤ï¼Œç¬”è€…ä½¿ç”¨ Shiny å°†è¿™å¥—æµç¨‹æ‰“åŒ…æˆåä¸º <a href="https://hanchen.shinyapps.io/moreThanANOVA">moreThanANOVA çš„ Shiny App </a> æ‰˜ç®¡äº Shinyapps.io.</p>
<h2 id="it-just-works">It just works</h2>
<h3 id="data-viewer">Data Viewer</h3>
<p>åœ¨ Data Viewer é¡µé¢ï¼Œé€šè¿‡ DT åŒ…å®ç°äº†å±•ç¤ºè¾“å…¥æ•°æ®çš„åŠŸèƒ½ï¼Œå½“æ²¡æœ‰ä¸Šä¼ æ•°æ®ä¹‹æ—¶ï¼Œå¯ä»¥é€šè¿‡ Data Viewer æŸ¥çœ‹ moreThanANOVA å†…ç½®çš„ç¤ºä¾‹æ•°æ®ï¼ˆ<em>æ•°æ®æœ¬èº«æ— æ„ä¹‰ï¼Œä»…ä¾›æ¼”ç¤ºä¹‹ç”¨é€”</em>ï¼‰ã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/Data_Viewer_2" alt="Data Viewer" loading="lazy"></figure>
<h3 id="distribution-determine">Distribution Determine</h3>
<p>åœ¨ Distribution Determine é¡µé¢ï¼ŒmoreThanANOVA ä¼šæ£€éªŒæ‰€æœ‰å˜é‡åœ¨ä¸åŒç»„ä¸­çš„åˆ†å¸ƒç±»å‹ï¼Œç›®å‰ä»…åˆ†ä¸º normal å’Œ skewedï¼Œç„¶è€Œå¯¹äºåŒå³°åˆ†å¸ƒç­‰å…¶ä»–åˆ†å¸ƒç±»å‹ï¼Œéå‚æ•°æ£€éªŒä¹Ÿä¾ç„¶é€‚ç”¨ï¼Œå› æ­¤ä¹‹åçš„åˆ†æç»“æœä¾ç„¶å¯é ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/data_dist" alt="" loading="lazy"></figure>
<p>å½“åŒä¸€å˜é‡åœ¨ä¸åŒç»„ä¸­çš„åˆ†å¸ƒç±»å‹ä¸ç›¸åŒæ—¶ï¼ŒmoreThanANOVA ä¼šé‡‡ç”¨éå‚æ•°æ£€éªŒè¿›è¡Œä¹‹åçš„åˆ†æï¼ŒåŒæ—¶åœ¨ Density Plot ä¸­ç»˜åˆ¶æ•°æ®åˆ†å¸ƒå¯†åº¦å›¾ã€‚</p>
<figure data-type="image" tabindex="3"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/density_plot" alt="" loading="lazy"></figure>
<h3 id="comparisons">Comparisons</h3>
<p>åœ¨ Comparisons é¡µé¢ï¼Œé¦–å…ˆ moreThanANOVA ä¼šé€šè¿‡åœ¨å‰æœŸæ­¥éª¤ä¸­ç¡®å®šçš„æ£€éªŒæ–¹æ³•ï¼Œè¿›è¡Œç»„é—´æ˜¾è‘—æ€§æ£€éªŒã€‚åŒæ—¶ä¼šå°†å‡å€¼ã€æ ‡å‡†å·®ã€ä¸­ä½æ•°ä»¥åŠå››åˆ†ä½è· Interquartile range, IQR è¾“å‡ºä¸ºå¯ä¸‹è½½çš„å¯äº¤äº’è¡¨æ ¼ã€‚</p>
<figure data-type="image" tabindex="4"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/compare_table" alt="" loading="lazy"></figure>
<p>æœ€åï¼ŒmoreThanANOVA è¿˜ä¼šç”ŸæˆåŸºäºå¤šé‡æ£€éªŒçš„å›¾å½¢ï¼Œç›®å‰å¯ä»¥è‡ªå®šä¹‰å›¾ä¸­ X/Y è½´ä»¥åŠé¢˜å¤´æ ‡ç­¾ï¼Œæ˜¾ç¤ºç›¸å…³æ€§çº§åˆ«ã€ç›¸å…³æ€§çš„è¡¨ç¤ºæ–¹æ³•ï¼ˆp æˆ–è€… *ï¼‰ã€å¤šç»„å›¾ç‰‡ä¹‹é—´çš„æ’åˆ—æ–¹å¼ä»¥åŠä¸‹è½½å›¾ç‰‡çš„å®½ã€é«˜ã€‚</p>
<p>####ä¸ºä½•é‡‡ç”¨ PDF è¾“å‡ºå›¾å½¢ï¼Ÿ<br>
ä½¿ç”¨ PDF å¯ä»¥è¾“å‡ºçŸ¢é‡å›¾ï¼Œèƒ½å¤Ÿæœ‰æ•ˆé¿å… DPI é€ æˆçš„æ¸…æ™°åº¦é—®é¢˜ï¼ŒåŒæ—¶æ‹¥æœ‰æå°çš„ä½“ç§¯ä»¥åŠä¸é”™çš„å…¼å®¹æ€§ã€‚</p>
<figure data-type="image" tabindex="5"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/post_hoc_figure.png" alt="" loading="lazy"></figure>
<p>ç›®å‰ moreThanANOVA æ‰˜ç®¡äº Rstudio æ——ä¸‹ Shinyapps.io ç½‘ç«™ï¼Œæºä»£ç æ‰˜ç®¡äº <a href="https://github.com/womeimingzi11/moreThanANOVA">GitHub</a>ã€‚æœåŠ¡è¿è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šæ°¸ä¹…ä¿å­˜ç”¨æˆ·æ•°æ®ï¼Œæ•°æ®æœ‰æ•ˆæœŸä»…ä¿ç•™è‡³ç½‘é¡µå…³é—­å‰ã€‚</p>
<p>åŒæ—¶å¦‚æœå¯¹äºæ•°æ®é«˜åº¦æ•æ„Ÿï¼Œä¹Ÿå¯ä»¥è€ƒè™‘å°†<a href="https://github.com/womeimingzi11/moreThanANOVA/fork/"> fork é¡¹ç›®</a> æˆ–ä¸‹è½½è‡³æœ¬åœ°åï¼Œæ‰‹åŠ¨è¿è¡Œ app.R åœ¨æœ¬åœ°ç”µè„‘æ‰§è¡Œæ“ä½œã€‚</p>
<p>å¦‚æœ‰ä»»ä½•ä½¿ç”¨ä¸­çš„ç–‘é—®ã€åŠŸèƒ½ä¸Šçš„å»ºè®®ä¸æ„è§ï¼Œæ¬¢è¿ä¸<a href="mailto://chenhan28@gmail.com">æˆ‘è”ç³»</a>ã€‚å½“ç„¶ä¹Ÿæ¬¢è¿ <a href="https://github.com/womeimingzi11/moreThanANOVA/star/">Star</a> ä»¥åŠè¿›è¡Œä»»ä½•æäº¤ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[R for everything: æ–¹å·®åˆ†è§£ï¼ˆVariation partitionï¼‰å˜é‡ç­›é€‰ä¸æ˜¾è‘—æ€§æ ‡æ³¨]]></title>
        <id>https://womeimingzi11.github.io/post/HpSw5NiHj/</id>
        <link href="https://womeimingzi11.github.io/post/HpSw5NiHj/">
        </link>
        <updated>2020-05-11T08:21:57.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ä½•ä¸ºæ–¹å·®åˆ†è§£">ä½•ä¸ºæ–¹å·®åˆ†è§£ï¼Ÿ</h2>
<p>å…³äºæ–¹å·®åˆ†è§£çš„æ•°å­¦åŸç†ï¼Œåœ¨ GUSTA ME è¿™ç¯‡æ–‡ç«  <strong><a href="https://mb3is.megx.net/gustame/constrained-analyses/variation-partitioning">Variation partitioning</a></strong> æœ‰éå¸¸æ¸…æ™°ä¸”å®¹æ˜“ç†è§£çš„ä»‹ç»ã€‚</p>
<p>å¼•ç”¨ç»ç®¡ä¹‹å®¶ç½‘å‹ <a href="https://bbs.pinggu.org/home.php?mod=space&amp;uid=1801145">lovecather668</a> åœ¨**<a href="https://bbs.pinggu.org/thread-1125443-1-1.html">varä¸­æ–¹å·®åˆ†è§£çš„æ„ä¹‰</a>** ä¸­çš„å›ç­”ï¼š</p>
<blockquote>
<p>VARä¸­çš„æ–¹å·®åˆ†è§£æ˜¯åˆ†æå½±å“å†…ç”Ÿå˜é‡çš„ç»“æ„å†²å‡»çš„è´¡çŒ®åº¦ã€‚ä¾‹å¦‚ï¼Œæœ‰å¥½å¤šè¡Œä¸šäº§å“çš„éœ€æ±‚å˜åŠ¨ä¼šå¯¹é’¢é“è¡Œä¸šäº§å“çš„éœ€æ±‚å˜åŠ¨äº§ç”Ÿå½±å“ï¼Œåƒå»ºæè¡Œä¸šã€æ±½è½¦è¡Œä¸šã€æœºæ¢°è¡Œä¸šã€å®¶ç”µè¡Œä¸šã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³è¦çŸ¥é“è¿™4ä¸ªè¡Œä¸šçš„éœ€æ±‚å˜åŒ–å¯¹é’¢é“è¡Œä¸šçš„éœ€æ±‚å˜åŒ–äº§ç”Ÿçš„å½±å“å“ªä¸ªå¤§ã€å“ªä¸ªå°å‘¢ï¼Œå°±å¯ä»¥ç”¨æ–¹å·®åˆ†è§£æ¥åšã€‚åšå‡ºæ¥çš„ç»“æœæ˜¯ç”¨è´¡çŒ®ç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰æ¥è¡¨ç¤ºçš„ï¼Œå¦‚å‡è®¾ç»“æœæ˜¯ä»¥ä¸Š4ä¸ªè¡Œä¸šåœ¨æŸä¸ªæ—¶ç‚¹ä¸Šçš„è´¡çŒ®ç‡åˆ†åˆ«ä¸º10%ï¼Œ12%ï¼Œ16%ï¼Œ20%ï¼ˆéšæ—¶é—´çš„å˜åŒ–ï¼Œè¿™ä¸ªè´¡çŒ®ç‡ä¹Ÿæ˜¯åœ¨å˜åŒ–çš„ï¼‰ï¼Œå…¶æ„æ€æ˜¯åœ¨è¯¥æ—¶ç‚¹é’¢é“è¡Œä¸šéœ€æ±‚çš„å˜åŠ¨ï¼Œ10%æ˜¯å»ºæè¡Œä¸šçš„éœ€æ±‚å˜åŠ¨å¼•èµ·çš„ï¼Œ12%æ˜¯æ±½è½¦è¡Œä¸šçš„éœ€æ±‚å˜åŠ¨å¼•èµ·çš„ï¼Œä»¥æ­¤ç±»æ¨.....</p>
</blockquote>
<p>åœ¨ç”Ÿå‘½ç§‘å­¦çš„å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥åŸºäº RDA ç»“æœå¾—å‡ºä¸åŒç±»å‹çš„ç¯å¢ƒå› ç´ ï¼ˆå¦‚ä½•æ°”å€™ã€åœŸå£¤æ€§è´¨ä»¥åŠæ¤ç‰©ï¼‰å¯¹ç”Ÿç‰©ç¾¤è½ç»„æˆï¼ˆå¦‚åœŸå£¤çº¿è™«ç¾¤è½ã€å¾®ç”Ÿç‰©ç¾¤è½ï¼‰çš„è§£é‡Šç¨‹åº¦ã€‚</p>
<p>Singh et al.(2018) åœ¨ Scientific Report ä¸Šå‘è¡¨çš„æ–‡ç« <a href="https://doi.org/10.1038/s41598-019-42333-4">ã€Štropical forest conversion to rubber plantation affects soil micro- &amp; mesofaunal community &amp; diversityã€‹</a>ä¸­æåˆ°äº†ä¸€å¥—å®Œæ•´çš„åŸºäº RDA çš„æ–¹å·®åˆ†è§£æ“ä½œï¼š</p>
<blockquote>
<p>We performed a redundancy analysis (RDA) based variation partitioning analysis 57 to assess the relative effects of environmental and spatial variables on community composition. We used Hellinger transformed OTU abundance data as the response variable and two sets of explanatory variables which included environmental variables (pH, Ele, TOC, AP, GSW, SX, TN, and ST) and spatial variables (geographical co-ordinates for sampling sites), respectively. Before the RDA, the environmental variables with high variance inflation factor (VIF) &gt;10 were eliminated to avoid collinearity among factors. The importance of environmental and spatial variables in explaining species composition was determined by an RDA analysis using Monte Carlo permutation tests (999 unrestricted permutations) followed by forward selection to remove the non-significant variables from each of the explanatory sets.</p>
</blockquote>
<p>å¦‚ä½•è¿›è¡Œè¿™æ ·çš„æ–¹å·®åˆ†è§£æµç¨‹ï¼ˆåŒ…æ‹¬å˜é‡ç­›é€‰ä»¥åŠå˜é‡é›†çš„æ˜¾è‘—æ€§æ ‡æ³¨ï¼‰å°±æ˜¯ä»Šå¤©è¿™ç¯‡æ–‡ç« çš„é‡ç‚¹ã€‚</p>
<h2 id="ä½¿ç”¨-r-è¿›è¡Œæ–¹å·®åˆ†è§£">ä½¿ç”¨ R è¿›è¡Œæ–¹å·®åˆ†è§£</h2>
<p>æ­£å¦‚å¤§å¤šæ•°åŸºäºç¾¤è½çš„åˆ†ææ–¹æ³•ç›¸åŒï¼Œåœ¨ R ä¸­è¿›è¡Œæ–¹å·®åˆ†è§£åŒæ ·ç¦»ä¸å¼€ <a href="https://cran.r-project.org/web/packages/vegan/vegan.pdf">vegan åŒ…</a>ï¼Œä¸»è¦ä¾èµ–ä¸¤ä¸ªåŠŸèƒ½ï¼š</p>
<ol>
<li><a href="https://www.rdocumentation.org/packages/vegan/versions/2.4-2/topics/ordistep">ordistep</a> - å˜é‡ç­›é€‰</li>
<li><a href="https://www.rdocumentation.org/packages/vegan/versions/2.4-2/topics/varpart">varpart</a> - æ–¹å·®åˆ†è§£</li>
</ol>
<p>æ•°æ®ç»§ç»­ä½¿ç”¨ä¹‹å‰çš„æ–‡ç« <a href="https://womeimingzi11.github.io/post/vY312ek1B/">ã€Šä½¿ç”¨ ggplot2 å¯è§†åŒ– RDA ç»“æœã€‹</a>ä¸­ä½¿ç”¨çš„æ¼”ç¤ºæ•°æ®ã€‚</p>
<pre><code class="language-R"># suppressMessages will hide message from loading package, it makes the output clearer
suppressMessages(library(tidyverse))
# col_types = cols() will suppress message about the column type to make the output clearer
df_com &lt;- read_csv('df_com_smp.csv', col_types = cols())
df_env &lt;- read_csv('df_env_smp.csv', col_types = cols())

# Take a glimpse about the structure of data frame
glimpse(df_com)
glimpse(df_env)

</code></pre>
<pre><code>Rows: 150
Columns: 5
$ pp [3m[38;5;246m&lt;dbl&gt;[39m[23m 2.5500000, 1.3110456, 8.2500000, 102.4900000, 21.3500000, 2.490000â€¦
$ ba [3m[38;5;246m&lt;dbl&gt;[39m[23m 28.010000, 7.316707, 13.255000, 18.516667, 52.720000, 4.965000, 61â€¦
$ fu [3m[38;5;246m&lt;dbl&gt;[39m[23m 2.5500000, 1.3378838, 3.3550000, 20.9466667, 14.8466667, 1.2450000â€¦
$ pr [3m[38;5;246m&lt;dbl&gt;[39m[23m 2.5500000, 1.3378838, 0.0000000, 0.0000000, 0.0000000, 0.0000000, â€¦
$ om [3m[38;5;246m&lt;dbl&gt;[39m[23m 15.280000, 5.953381, 14.850000, 23.500000, 5.623333, 2.475000, 31.â€¦
Rows: 150
Columns: 13
$ pH  [3m[38;5;246m&lt;dbl&gt;[39m[23m -1.63965465, 0.94291257, -1.33875709, -1.20359469, -1.17624072, 0â€¦
$ MOI [3m[38;5;246m&lt;dbl&gt;[39m[23m -0.1610384, -0.5549069, -0.2762522, -0.1658411, 1.0043821, 0.5467â€¦
$ TN  [3m[38;5;246m&lt;dbl&gt;[39m[23m -0.116240631, -0.791972999, 0.199881689, -0.260084650, 0.29187495â€¦
$ TP  [3m[38;5;246m&lt;dbl&gt;[39m[23m -0.44892589, 0.02952209, -0.14900328, -0.45606691, -0.47748995, -â€¦
$ AP  [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.17966965, -0.78701735, -0.10273314, 0.09277663, 2.24338416, 0.5â€¦
$ NH4 [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.4471754, -0.3426843, 0.7179844, -0.1328073, 0.7924569, -0.36525â€¦
$ NO3 [3m[38;5;246m&lt;dbl&gt;[39m[23m -0.51485153, -0.41977560, -0.49221441, -0.16774892, -0.58276291, â€¦
$ SOC [3m[38;5;246m&lt;dbl&gt;[39m[23m -0.292278803, -0.697789311, 0.461059956, -0.007572046, 0.03580922â€¦
$ MAT [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.84202205, -1.55196703, -0.84801694, 0.78335952, -0.28932636, -0â€¦
$ MAP [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.02487222, 0.27013035, 1.21243154, -0.87351309, -0.22471654, 1.2â€¦
$ PBM [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.17638650, -0.02465146, 0.73829039, -0.80968336, 0.12645186, 2.1â€¦
$ PCV [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.426595458, 0.008333099, -0.793336422, -0.514494850, 0.182609082â€¦
$ PSR [3m[38;5;246m&lt;dbl&gt;[39m[23m 0.22757812, -0.83529465, 0.83493399, -1.29081156, 0.98677296, 0.6â€¦
</code></pre>
<p>æŒ‰ç…§ varpart åœ¨æ–‡æ¡£ä¸­çš„è¯´æ˜ï¼š</p>
<blockquote>
<p>The functions partition the variation in Y into components accounted for by two to four explanatory tables and their combined effects. If Y is a multicolumn data frame or matrix, the partitioning is based on redundancy analysis (RDA, see rda), and if Y is a single variable, the partitioning is based on linear regression. If Y are dissimilarities, the decomposition is based on distance-based redundancy analysis (db-RDA, see capscale) following McArdle &amp; Anderson (2001). The input dissimilarities must be compatible to the results of dist. Vegan functions vegdist, designdist, raupcrick and betadiver produce such objects, as do many other dissimilarity functions in R packages. However, symmetric square matrices are not recognized as dissimilarities but must be transformed with as.dist. Partitioning will be made to squared dissimilarities analogously to using variance with rectangular data -- unless sqrt.dist = TRUE was specified.</p>
</blockquote>
<p>å¯¹äºç¾¤è½çŸ©é˜µï¼Œæ–¹å·®åˆ†è§£æ˜¯æŒ‰ç…§ RDA ç»“æœæ¥è¿›è¡Œå¤„ç†çš„ï¼Œå› æ­¤ç­›é€‰å˜é‡çš„æµç¨‹å¯åœ¨ RDA åˆ†æçš„è¿‡ç¨‹ä¸­å®Œæˆã€‚</p>
<h3 id="ä¸ºä½•è¦ç­›é€‰å˜é‡">ä¸ºä½•è¦ç­›é€‰å˜é‡ï¼Ÿ</h3>
<p>åœ¨å¤šå› ç´ çš„åˆ†æä¸­ï¼Œä¾‹å¦‚ RDA åˆ†æå’Œå¤šå…ƒçº¿æ€§å›å½’ï¼Œä»»ä½•å¢åŠ æ–°çš„å˜é‡ï¼Œéƒ½ä¼šä½¿å¾—æ¨¡å‹ã€Œçœ‹èµ·æ¥ã€æ‹Ÿåˆå¾—æ›´å¥½ï¼Œç„¶è€Œå®é™…æƒ…å†µæ˜¾ç„¶å¹¶éå¦‚æ­¤ï¼Œä¸ºäº†è§£å†³è¿‡æ‹Ÿåˆé—®é¢˜<strong>è°ƒæ•´ R æ–¹</strong>æ˜¯ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„æŒ‡æ ‡ï¼Œå…·ä½“çš„è§£é‡Šå¯ä»¥æŸ¥çœ‹ <a href="https://www.statisticshowto.com/adjusted-r2/">Adjusted R2 / Adjusted R-Squared: What is it used for?</a>ã€‚</p>
<p>å›åˆ°æ­£é¢˜ï¼Œå¯¹äº RDA åˆ†æé€‰æ‹©å˜é‡ï¼Œordistep æä¾›äº†ä¸‰ç§æ–¹æ³• backward, forward, bothï¼Œå³ä»å…¨æ¨¡å‹é€æ¸æ¶ˆé™¤å˜é‡ã€ä»é›¶æ¨¡å‹é€æ¸å¢åŠ å˜é‡ä»¥åŠåŒå‘é€‰æ‹©å˜é‡ã€‚è¿™é‡Œæˆ‘ä»¬åŒæ—¶è¿›è¡Œä¸‰ç§å˜é‡é€‰æ‹©çš„æ–¹å¼ã€‚</p>
<pre><code class="language-R"># suppressMessages will hide message from loading package, it makes the output clearer
suppressMessages(library(vegan))

# Create the full model
rda_full &lt;- rda(df_com~., data = df_env)

# Create the zero model
rda_null &lt;- rda(df_com~1, data = df_env)

# backward selection
# trace = 0 prevent ordistep print the selection progress from outputing to the console
# it makes the output clearer.
rda_back &lt;- ordistep(rda_full, direction = 'backward',trace = 0)

# forward selection
rda_frwd &lt;- ordistep(rda_null, formula(rda_full), direction = 'forward',trace = 0)

# bothward selection 
rda_both &lt;- ordistep(rda_null, formula(rda_full), direction = 'both',trace = 0)

rda_back
rda_frwd
rda_both
</code></pre>
<pre><code>Call: rda(formula = df_com ~ pH + MOI + TN + TP + NO3 + SOC + MAT, data
= df_env)

                Inertia Proportion Rank
Total         2031.7341     1.0000     
Constrained    860.1782     0.4234    5
Unconstrained 1171.5559     0.5766    5
Inertia is variance 

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4  RDA5 
747.1  77.3  32.2   2.5   1.0 

Eigenvalues for unconstrained axes:
  PC1   PC2   PC3   PC4   PC5 
755.6 247.3 108.6  46.6  13.5 




Call: rda(formula = df_com ~ MOI + NO3 + TN + SOC, data = df_env)

                Inertia Proportion Rank
Total         2031.7341     1.0000     
Constrained    790.2092     0.3889    4
Unconstrained 1241.5248     0.6111    5
Inertia is variance 

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4 
714.8  70.1   4.3   1.0 

Eigenvalues for unconstrained axes:
  PC1   PC2   PC3   PC4   PC5 
787.6 277.0 114.1  48.7  14.0 




Call: rda(formula = df_com ~ MOI + NO3 + TN + SOC, data = df_env)

                Inertia Proportion Rank
Total         2031.7341     1.0000     
Constrained    790.2092     0.3889    4
Unconstrained 1241.5248     0.6111    5
Inertia is variance 

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4 
714.8  70.1   4.3   1.0 

Eigenvalues for unconstrained axes:
  PC1   PC2   PC3   PC4   PC5 
787.6 277.0 114.1  48.7  14.0 
</code></pre>
<p>æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©æœ€ç»ˆçš„æ¨¡å‹ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©å‘åæ¶ˆé™¤æ³•é€‰æ‹©çš„æ¨¡å‹ä½œä¸º RDA æœ€ç»ˆçš„ç»“æœã€‚åŒæ—¶è¿™ä¹Ÿæ˜¯æ–¹å·®åˆ†è§£çš„æœ€ç»ˆæ¨¡å‹ï¼Œå³ <code>df_com ~ pH + MOI + TN + TP + NO3 + SOC + MAT</code>ï¼Œå…¶ä¸­ MAT æ˜¯æ°”å€™å› ç´ ï¼Œæˆ‘ä»¬å°†å…¶é€‰å…¥æ°”å€™å› ç´ é›† df_climï¼Œ å…¶ä½™å‡ä¸ºåœŸå£¤æ€§è´¨å› ç´ é›† df_soilï¼Œæ¤ç‰©å› ç´ æ²¡æœ‰é€‰å…¥æ¨¡å‹ã€‚</p>
<pre><code class="language-R"># Divide the environmental data.frame by different categories.
df_clim &lt;- df_env %&gt;% select(MAT)
df_soil &lt;- df_env %&gt;% select(pH,MOI,TN,TP,NO3,SOC)

# Perform variation partitioning analysis, the first variable is the community matrix
# the second and third variables are climate variable set and soil property variable set
vpt &lt;- varpart(df_com, df_clim, df_soil)

vpt

plot(
    vpt,
    bg = 2:5,
    id.size = 1.1,
    cex = 1.2,
    Xnames = c('Climate', 'Soil properties')
)
title('Variation partitioning by varpart from vegan')
</code></pre>
<pre><code>Partition of variance in RDA 

Call: varpart(Y = df_com, X = df_clim, df_soil)

Explanatory tables:
X1:  df_clim
X2:  df_soil 

No. of explanatory tables: 2 
Total variation (SS): 302728 
            Variance: 2031.7 
No. of observations: 150 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1            1   0.00855       0.00186     TRUE
[b+c] = X2            6   0.41263       0.38799     TRUE
[a+b+c] = X1+X2       7   0.42337       0.39495     TRUE
Individual fractions                                    
[a] = X1|X2           1                 0.00696     TRUE
[b]                   0                -0.00510    FALSE
[c] = X2|X1           6                 0.39309     TRUE
[d] = Residuals                         0.60505    FALSE
---
Use function â€˜rdaâ€™ to test significance of fractions of interest
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/output_5_1.png" alt="" loading="lazy"></figure>
<p>æ ¹æ® RDA å’Œæ–¹å·®åˆ†è§£çš„ç»“æœï¼ˆå®é™…ä¸Šæ˜¯ç›¸åŒçš„ç»“æœï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ°”å€™å› ç´ ä¸åœŸå£¤æ€§è´¨å…±åŒè§£é‡Šäº† 39.5% çš„ç¾¤è½ç»“æ„å˜å¼‚ï¼Œå…¶ä¸­åœŸå£¤æ€§è´¨è§£é‡Šäº† 38.8% çš„ç¾¤è½ç»„æˆå˜å¼‚ï¼Œæ°”å€™è§£é‡Šäº† 0.2% çš„ç¾¤è½ç»„æˆå˜å¼‚ã€‚ç„¶è€Œå¯¹äºäºŒè€…æ˜¯å¦æ˜¾è‘—ï¼Œè¿˜éœ€è¦è¿›ä¸€æ­¥æ£€éªŒã€‚</p>
<pre><code class="language-R"># Define formula of soil property set and climate set to test.
# Set the variable from other category as condition
formula_soil &lt;- formula(df_com ~ pH+MOI+TN+TP+NO3+SOC + Condition(MAT))
formula_clim &lt;- formula(df_com ~ Condition(pH)+Condition(MOI)+Condition(TN)+Condition(TP)+Condition(NO3)+Condition(SOC) + MAT)

anova(rda(formula_soil, data = df_env))
anova(rda(formula_clim, data = df_env))
</code></pre>
<table>
<caption>A anova.cca: 2 Ã— 4</caption>
<thead>
	<tr><th></th><th scope=col>Df</th><th scope=col>Variance</th><th scope=col>F</th><th scope=col>Pr(&gt;F)</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>Model</th><td>  6</td><td> 842.7984</td><td>17.02542</td><td>0.001</td></tr>
	<tr><th scope=row>Residual</th><td>142</td><td>1171.5559</td><td>      NA</td><td>   NA</td></tr>
</tbody>
</table>
<table>
<caption>A anova.cca: 2 Ã— 4</caption>
<thead>
	<tr><th></th><th scope=col>Df</th><th scope=col>Variance</th><th scope=col>F</th><th scope=col>Pr(&gt;F)</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>Model</th><td>  1</td><td>  21.81623</td><td>2.644266</td><td>0.083</td></tr>
	<tr><th scope=row>Residual</th><td>142</td><td>1171.55586</td><td>      NA</td><td>   NA</td></tr>
</tbody>
</table>
<p>ç»“åˆå•å› ç´ æ–¹å·®åˆ†æ ANOVA å¾—åˆ°çš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºæœ€ç»ˆç»“è®ºï¼ŒåœŸå£¤æ€§è´¨èƒ½å¤Ÿæ˜¾è‘—è§£é‡Š 38.8% çš„ç¾¤è½ç»„æˆå˜å¼‚ï¼Œæ°”å€™å› ç´ å¯¹äºç¾¤è½ç»“æ„å˜å¼‚çš„è§£é‡Šä¸æ˜¾è‘—ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[R for Everything: ä½¿ç”¨ ggplot2 å¯è§†åŒ– RDA ç»“æœ]]></title>
        <id>https://womeimingzi11.github.io/post/vY312ek1B/</id>
        <link href="https://womeimingzi11.github.io/post/vY312ek1B/">
        </link>
        <updated>2020-04-28T09:05:16.000Z</updated>
        <content type="html"><![CDATA[<h1 id="using-r-for-everything-ggplot2-å¯è§†åŒ–-rda-ç»“æœ">Using R for Everything: ggplot2 å¯è§†åŒ– RDA ç»“æœ</h1>
<p>å…³äº RDAï¼ˆRedundancy analysis å†—ä½™åˆ†æï¼‰æ˜¯ä»€ä¹ˆï¼Œç›¸ä¿¡å¯¹äºå·²ç»æœ‰å¯è§†åŒ–éœ€æ±‚çš„åŒå­¦æ¥è¯´å·²ç»ä¸ç”¨æ›´å¤šçš„è§£é‡Šäº†ã€‚</p>
<p>åœ¨ R ä¸­å¸¸ç”¨æ¥è¿›è¡Œ RDA åˆ†æå’Œç»˜åˆ¶å·¥ä½œçš„æ˜¯ <a href="https://cran.r-project.org/web/packages/vegan/vegan.pdf">vegan</a> å’Œ <a href="https://github.com/gavinsimpson/ggvegan">ggvegan</a> è¿™ä¸¤ä¸ªåŒ…ã€‚ç„¶è€Œï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæœ€å¸¸é‡åˆ°çš„é—®é¢˜æ˜¯è™½ç„¶è¿™äº›åŒ…å†…å»ºçš„ plot ç­‰åŠŸèƒ½å¯ä»¥ç»˜åˆ¶å‡ºåŸºæœ¬å¯ç”¨çš„åŒ…ï¼Œä½†æƒ³è¦è¿›ä¸€æ­¥çš„å®šåˆ¶å›¾å½¢å´æ²¡é‚£ä¹ˆå®¹æ˜“ã€‚</p>
<p>æƒ³è¦ç»˜åˆ¶å‡ºä¸€å‰¯è‡ªå·±æ»¡æ„ã€ç¼–è¾‘æ»¡æ„ã€å¯¼å¸ˆæ»¡æ„æœ€ä¸»è¦çš„æ˜¯å®¡ç¨¿äººæ»¡æ„çš„ RDA ç»“æœï¼Œä½œä¸ºæœ€å¼ºå¯è§†åŒ–å·¥å…·ä¹‹ä¸€çš„ <a href="https://ggplot2.tidyverse.org/">ggplot2</a> åŒ…æ¯‹åº¸ç½®ç–‘æ˜¯æœ€ä½³çš„é€‰æ‹©ã€‚</p>
<h2 id="æˆ‘ä»¬éœ€è¦ä»€ä¹ˆæ ·çš„-rda-å›¾">æˆ‘ä»¬éœ€è¦ä»€ä¹ˆæ ·çš„ RDA å›¾</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥æ€è€ƒæˆ‘ä»¬éœ€è¦ä»€ä¹ˆæ ·çš„ RDA å›¾ï¼ŸæŒ‰ç…§ä¸–çºªéœ€æ±‚ä»¥åŠå®¡ç¨¿äººçš„å»ºè®®ï¼š</p>
<blockquote>
<p>I would recommend showing in bold the variables with significant correlations</p>
</blockquote>
<p>ç¬”è€…æœ€åçš„ç›®æ ‡æ˜¯ç»˜åˆ¶ä¸€å¹…ï¼š</p>
<pre><code>1. æ˜¾ç¤ºç‰©ç§ä¿¡æ¯ï¼ˆå®é™…ä¸Šæ˜¯å“åº”å˜é‡çŸ©é˜µï¼‰ï¼›
2. ç¯å¢ƒå˜é‡ï¼ˆå®é™…ä¸Šæ˜¯è§£é‡Šå˜é‡çŸ©é˜µï¼‰ï¼›
3. åœ¨ä¸¤è½´ä¸Šèƒ½æ˜¾ç¤ºå„è‡ªçš„è§£é‡Šåº¦ï¼›
4. æ ‡è®°æœ‰æ˜¾è‘—æ€§çš„è§£é‡Šå˜é‡ã€‚
</code></pre>
<p>ä»¥ç¬”è€…å¯¹ plot.rda ä»¥åŠ autoplot.rda è¿™ä¸¤ä¸ª vegan å’Œ ggvegan å†…å»ºå‡½æ•°çš„æµ…è–„äº†è§£ï¼Œä¼¼ä¹å¾ˆéš¾å®Œæˆã€‚</p>
<h3 id="å¦‚ä½•æ ‡è®°æœ‰æ˜¾è‘—æ€§çš„è§£é‡Šå˜é‡">å¦‚ä½•ã€Œæ ‡è®°æœ‰æ˜¾è‘—æ€§çš„è§£é‡Šå˜é‡ã€ï¼Ÿ</h3>
<p>å¦‚æœè¿›è¡Œè¿‡ RDA åˆ†æä¸éš¾å‘ç°ï¼Œä½¿ç”¨ vegan å†…å»ºçš„ rda æ˜¯æ²¡æœ‰æ ‡è®°è§£é‡Šå˜é‡çš„æ˜¾è‘—æ€§çš„ã€‚å…¶å®è¿™ç§æ˜¾è‘—æ€§éœ€è¦ vegan å†…å»ºçš„ envfit å‡½æ•°æ¥å¾—åˆ°ä¸€ä¸ªåŠå…¶è¿‘ä¼¼çš„ç»“æœã€‚é€šå¸¸è¿™ä¸ªæ–¹æ³•åœ¨è®ºæ–‡ä¸­ä¼šå†™ä½œï¼š</p>
<blockquote>
<p>Monte Carlo permutation (999 permutations) was used to identify axes with significant eigenvalues and species-environment correlations.</p>
</blockquote>
<p>ç”±äºæ˜¯è¿›è¡Œäº† 999 æ¬¡ï¼ˆé»˜è®¤å‚æ•°å¯ä»¥ä¿®æ”¹ï¼‰çš„è’™ç‰¹å¡æ´›æŠ½æ ·ï¼Œå› æ­¤è¿™ä¸ªç»“æœæ˜¯<strong>åŠå…¶è¿‘ä¼¼</strong>çš„ç»“æœï¼Œç›´æ¥ç”¨ä½œ RDA ä¸­è§£é‡Šå˜é‡çš„æ˜¾è‘—æ€§æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ç„¶è€Œï¼Œenvfit è¾“å‡ºçš„ç»“æœå¹¶éæ ‡å‡†çš„ data.frame æˆ–è€…ç±»ä¼¼çš„ç»“æœï¼Œæ— æ³•æ–¹ä¾¿çš„è¾“å‡ºæˆ–è€…è¿›è¡Œåˆ†æï¼Œåç»­æˆ‘ä»¬è¿˜ä¼šè¿›è¡Œç»“æœæå–çš„æ­¥éª¤ï¼Œæš‚ä¸”æŒ‰ä¸‹ä¸è¡¨ã€‚</p>
<h2 id="rda-å’Œ-envfit-åˆ†æ">RDA å’Œ ENVFIT åˆ†æ</h2>
<p>æ­¤ä¾‹ï¼Œæˆ‘ä»¬ä½¿ç”¨éšæœºæŠ½å–çš„ 150 æ¡åœŸå£¤çº¿è™«ç¾¤è½ç¾¤è½æ•°æ®ä»¥åŠå¯¹åº”çš„ç¯å¢ƒæ•°æ®ï¼Œç”±äºä¸å½±å“åç»­çš„ç†è§£ä»¥åŠç‰ˆæƒè€ƒé‡ï¼Œå¯¹å„å‚æ•°åä¸å†è§£é‡Šã€‚</p>
<p>æ¯ä¸€æ­¥çš„æ“ä½œä»¥åŠåŸå› ä»¥æ³¨é‡Šçš„å½¢å¼å‘ˆç°ã€‚</p>
<pre><code class="language-R">library('tidyverse')

# read Environmental Variables
df_env &lt;- read_csv('df_env_smp.csv')
# read Community composition matrix
df_com &lt;- read_csv('df_com_smp.csv')

# View the structure of data
head(df_env)
head(df_com)
</code></pre>
<pre><code>Parsed with column specification:
cols(
  pH = [32mcol_double()[39m,
  MOI = [32mcol_double()[39m,
  TN = [32mcol_double()[39m,
  TP = [32mcol_double()[39m,
  AP = [32mcol_double()[39m,
  NH4 = [32mcol_double()[39m,
  NO3 = [32mcol_double()[39m,
  SOC = [32mcol_double()[39m,
  MAT = [32mcol_double()[39m,
  MAP = [32mcol_double()[39m,
  PBM = [32mcol_double()[39m,
  PCV = [32mcol_double()[39m,
  PSR = [32mcol_double()[39m
)

Parsed with column specification:
cols(
  pp = [32mcol_double()[39m,
  ba = [32mcol_double()[39m,
  fu = [32mcol_double()[39m,
  pr = [32mcol_double()[39m,
  om = [32mcol_double()[39m
)
</code></pre>
<table>
<caption>A tibble: 6 Ã— 13</caption>
<thead>
	<tr><th scope=col>pH</th><th scope=col>MOI</th><th scope=col>TN</th><th scope=col>TP</th><th scope=col>AP</th><th scope=col>NH4</th><th scope=col>NO3</th><th scope=col>SOC</th><th scope=col>MAT</th><th scope=col>MAP</th><th scope=col>PBM</th><th scope=col>PCV</th><th scope=col>PSR</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>-1.6396547</td><td>-0.1610384</td><td>-0.1162406</td><td>-0.44892589</td><td> 0.17966965</td><td> 0.4471754</td><td>-0.5148515</td><td>-0.292278803</td><td> 0.8420221</td><td> 0.02487222</td><td> 0.17638650</td><td> 0.426595458</td><td> 0.2275781</td></tr>
	<tr><td> 0.9429126</td><td>-0.5549069</td><td>-0.7919730</td><td> 0.02952209</td><td>-0.78701735</td><td>-0.3426843</td><td>-0.4197756</td><td>-0.697789311</td><td>-1.5519670</td><td> 0.27013035</td><td>-0.02465146</td><td> 0.008333099</td><td>-0.8352947</td></tr>
	<tr><td>-1.3387571</td><td>-0.2762522</td><td> 0.1998817</td><td>-0.14900328</td><td>-0.10273314</td><td> 0.7179844</td><td>-0.4922144</td><td> 0.461059956</td><td>-0.8480169</td><td> 1.21243154</td><td> 0.73829039</td><td>-0.793336422</td><td> 0.8349340</td></tr>
	<tr><td>-1.2035947</td><td>-0.1658411</td><td>-0.2600847</td><td>-0.45606691</td><td> 0.09277663</td><td>-0.1328073</td><td>-0.1677489</td><td>-0.007572046</td><td> 0.7833595</td><td>-0.87351309</td><td>-0.80968336</td><td>-0.514494850</td><td>-1.2908116</td></tr>
	<tr><td>-1.1762407</td><td> 1.0043821</td><td> 0.2918750</td><td>-0.47748995</td><td> 2.24338416</td><td> 0.7924569</td><td>-0.5827629</td><td> 0.035809220</td><td>-0.2893264</td><td>-0.22471654</td><td> 0.12645186</td><td> 0.182609082</td><td> 0.9867730</td></tr>
	<tr><td> 0.4263991</td><td> 0.5467350</td><td>-0.3570957</td><td>-0.12043922</td><td> 0.54896611</td><td>-0.3652517</td><td>-0.5540892</td><td>-0.360483891</td><td>-0.8480169</td><td> 1.21243154</td><td> 2.11789718</td><td>-0.026522097</td><td> 0.6830950</td></tr>
</tbody>
</table>
<table>
<caption>A tibble: 6 Ã— 5</caption>
<thead>
	<tr><th scope=col>pp</th><th scope=col>ba</th><th scope=col>fu</th><th scope=col>pr</th><th scope=col>om</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>  2.550000</td><td>28.010000</td><td> 2.550000</td><td>2.550000</td><td>15.280000</td></tr>
	<tr><td>  1.311046</td><td> 7.316707</td><td> 1.337884</td><td>1.337884</td><td> 5.953381</td></tr>
	<tr><td>  8.250000</td><td>13.255000</td><td> 3.355000</td><td>0.000000</td><td>14.850000</td></tr>
	<tr><td>102.490000</td><td>18.516667</td><td>20.946667</td><td>0.000000</td><td>23.500000</td></tr>
	<tr><td> 21.350000</td><td>52.720000</td><td>14.846667</td><td>0.000000</td><td> 5.623333</td></tr>
	<tr><td>  2.490000</td><td> 4.965000</td><td> 1.245000</td><td>0.000000</td><td> 2.475000</td></tr>
</tbody>
</table>
<pre><code class="language-R">library('vegan')

# Performing RDA and viewing the results
res_rda &lt;- rda(df_com, df_env)
res_rda

# Performing ENVFIT
res_envfit &lt;- envfit(df_com, df_env)

# However, the result of ENVFIT is not in the data.frame format, we should extract useful information from it.
res_envfit
</code></pre>
<pre><code>Call: rda(X = df_com, Y = df_env)

                Inertia Proportion Rank
Total         2031.7341     1.0000     
Constrained    895.7317     0.4409    5
Unconstrained 1136.0024     0.5591    5
Inertia is variance 

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4  RDA5 
754.0  88.3  45.4   6.2   1.8 

Eigenvalues for unconstrained axes:
  PC1   PC2   PC3   PC4   PC5 
747.4 235.0  96.3  44.7  12.6 





***VECTORS

          pp       ba     r2 Pr(&gt;r)    
pH  -0.94935  0.31421 0.0809  0.003 ** 
MOI  0.79143  0.61126 0.2636  0.001 ***
TN   0.91399  0.40574 0.0887  0.004 ** 
TP   0.86358 -0.50421 0.0002  0.984    
AP   0.99269  0.12071 0.0575  0.026 *  
NH4  0.94495 -0.32722 0.0462  0.033 *  
NO3  0.52786  0.84933 0.1430  0.002 ** 
SOC  0.81629  0.57764 0.1440  0.001 ***
MAT  0.10537 -0.99443 0.0118  0.405    
MAP -0.18615 -0.98252 0.0073  0.579    
PBM  0.75360  0.65733 0.0096  0.508    
PCV  0.57508  0.81810 0.0380  0.072 .  
PSR  0.88521 -0.46519 0.0062  0.639    
---
Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
Permutation: free
Number of permutations: 999
</code></pre>
<p>æ­£å¦‚æˆ‘ä»¬åœ¨æ³¨é‡Šæåˆ°çš„ï¼ŒENVFIT å¹¶ä¸æ˜¯ä»¥ data.frame çš„å½¢å¼æä¾›æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦é€šè¿‡ä¸€äº›æå–çš„æ“ä½œæ‰èƒ½è·å¾—ä¸ç»“æœç›¸åŒçš„è¡¨æ ¼ã€‚ç”±äºè¿™ç±»æ“ä½œç»å¸¸ä½¿ç”¨ï¼Œå› æ­¤æˆ‘ä»¬å°†å…¶åŒ…è£…æˆ function å¹¶å‘½åä¸º envfit_to_df</p>
<pre><code class="language-R"># Here, env_obj indicates the result of envfit. In this case, it's the res_envfit.
# r2_dig is the significant figure of R2
# p_dig is the significant figure of p value
envfit_to_df &lt;- function(env_obj,
                         r2_dig = 6,
                         p_dig = 3) {
  r2_fmt &lt;- as.character(paste('%.', r2_dig, 'f', sep = ''))
  p_fmt &lt;- as.character(paste('%.', p_dig, 'f', sep = ''))
  tibble(
      # the name of explainary variables
    factor = names(env_obj$vectors$r),
      # list or vector of R2
    r2 = env_obj$vectors$r,
      # list or vector of p values
    pvals = env_obj$vectors$pvals
  ) %&gt;%
    # generate significant levels by p values
    mutate(sig = case_when(
      pvals &lt;= 0.001 ~ '***',
      pvals &lt;= 0.01 ~ '**',
      pvals &lt;= 0.05 ~ '*',
      TRUE ~ ' '
    )) %&gt;%
    # format the significant figure by format definition before.
    mutate(pvals = sprintf('%.3f', pvals),
           r2 = sprintf(r2_fmt, r2))
}
# Convert result of ENVFIT to data.frame, in fact, it's a tibble.
df_env &lt;- envfit_to_df(res_envfit, r2_dig = 3)
df_env
</code></pre>
<table>
<caption>A tibble: 13 Ã— 4</caption>
<thead>
	<tr><th scope=col>factor</th><th scope=col>r2</th><th scope=col>pvals</th><th scope=col>sig</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td>pH </td><td>0.081</td><td>0.003</td><td>** </td></tr>
	<tr><td>MOI</td><td>0.264</td><td>0.001</td><td>***</td></tr>
	<tr><td>TN </td><td>0.089</td><td>0.004</td><td>** </td></tr>
	<tr><td>TP </td><td>0.000</td><td>0.984</td><td>   </td></tr>
	<tr><td>AP </td><td>0.058</td><td>0.026</td><td>*  </td></tr>
	<tr><td>NH4</td><td>0.046</td><td>0.033</td><td>*  </td></tr>
	<tr><td>NO3</td><td>0.143</td><td>0.002</td><td>** </td></tr>
	<tr><td>SOC</td><td>0.144</td><td>0.001</td><td>***</td></tr>
	<tr><td>MAT</td><td>0.012</td><td>0.405</td><td>   </td></tr>
	<tr><td>MAP</td><td>0.007</td><td>0.579</td><td>   </td></tr>
	<tr><td>PBM</td><td>0.010</td><td>0.508</td><td>   </td></tr>
	<tr><td>PCV</td><td>0.038</td><td>0.072</td><td>   </td></tr>
	<tr><td>PSR</td><td>0.006</td><td>0.639</td><td>   </td></tr>
</tbody>
</table>
<p>æˆªæ­¢åˆ°ç›®å‰ï¼Œæˆ‘ä»¬å·²ç»å‡†å¤‡å®Œæˆäº† RDA åˆ†æä»¥åŠ ENVFIT åˆ†æï¼Œå¹¶å°†æ•°æ®è½¬æ¢æˆä¸ºäº†æ»¡è¶³å¯è§†åŒ–éœ€æ±‚çš„æ ¼å¼ã€‚</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯éœ€è¦è¿›è¡Œå¯è§†åŒ–ä½œä¸šã€‚æ­¤ä¾‹ï¼Œç¬”è€…ä»…éœ€è¦æ˜¾ç¤ºç¯å¢ƒå˜é‡ä¸ç‰©ç§ä¿¡æ¯ï¼Œä¸éœ€è¦æ˜¾ç¤ºæ ·åœ°ä¿¡æ¯ï¼Œå› æ­¤ç»˜åˆ¶ä¸­ä»…ä¿ç•™äº†æ‰€éœ€çš„ä¿¡æ¯ï¼Œå¦‚éœ€æ˜¾ç¤ºæ ·åœ°ä¿¡æ¯ï¼Œè¯·æŒ‰å®é™…éœ€æ±‚æ›´æ”¹ã€‚</p>
<p>ç»˜åˆ¶ RDA å›¾å½¢æ˜¯å¸¸ç”¨çš„æ“ä½œï¼Œå› æ­¤åŒæ ·å°†å®ƒåŒ…è£…æˆä¸º function å¹¶å‘½åä¸º <code>ggRDA</code></p>
<pre><code class="language-R"># Here, rda_obj means the object which is from vegan::rda
# sp_size means the text size of species
# arrow_txt_size means the environmet variable names at the end of the arrow
# Because not every RDA plot needs indicate significant correlations, the envfit_df is optional here.
ggRDA &lt;- function(rda_obj,sp_size = 4,arrow_txt_size = 4, envfit_df) {
    # ggplot doesn't support rda object directly, we use ggvegan::fortify function to convert the rda to data.frame
    fmod &lt;- fortify(rda_obj)
    # to get the arrow of biplot, we plot rda by vegan::plot.rda function firstly. 
    # The arrow attributes contain in the attributes(plot_obejct$biplot)$arrow.mul
    basplot &lt;- plot(rda_obj)
    mult &lt;- attributes(basplot$biplot)$arrow.mul
  
    # To check if envfit_df exists or not
    # If envfit_df exists, join the fortified rda_obj and envfit to mark which variable is significant.
    if(missingArg(envfit_df)){
        bplt_df &lt;- filter(fmod, Score == &quot;biplot&quot;) %&gt;%
        # If there is no requirement to mark significant variable
        # use the sytle of sinificant (black bolder solid arrow)
        # to paint the arrow
        mutate(bold = 'sig')
    } else {
        bplt_df &lt;- filter(fmod, Score == &quot;biplot&quot;) %&gt;%
        left_join(envfit_df, by = c('Label' = 'factor')) %&gt;%
        # To mark the significant variables as sig, not significant variables as ns
        # these information are stored in bold column
        mutate(bold = ifelse(str_detect(sig, fixed('*')), 'sig', 'ns'))
    }
  ggplot(fmod, aes(x = RDA1, y = RDA2)) +
    coord_fixed() +
    geom_segment(data = bplt_df,
                 # mult and RDA1/RDA2 are from fortified RDA data.frame
                 # they contain the direction and effects of every variabl
                 # their products are the direction and length of arrows
                 aes(x = 0, xend = mult * RDA1,
                     y = 0, yend = mult * RDA2,
                     # Use different arrow size to indicate the significant level
                     size = bold,
                     # Use different arrow color to indicate the significant level
                     color = bold,
                     # Use different arrow linetype to indicate the significant level
                     linetype = bold),
                 #############################
                 # Q:Why use three different attibution to control the significant levels?
                     # It is redundancy, isn't it?
                 # A: In fact, it's not easy to recongize the significant level by one kind attribution
                     # Becasue it is not delicate to indicate it with supper bold and supper thin arrow,
                     # by the same logic, high contrast colors are not delicate neither.
                     # As for the line type, some arrow are really short, it's not easy to recognize
                     # weather it is solid or dashed line at all.
                     # To sum up, we use three different attributions
                     # to indicate the same difference to avoid any misleading.
                 #############################
                 # to control the size of the header of arrow
                 arrow = arrow(length = unit(0.25, &quot;cm&quot;)), 
                ) +
    # Add the text of variable name at the end of arrow
    geom_text(data =  subset(fmod, Score == &quot;biplot&quot;),
              aes(x = (mult + mult/10) * RDA1,
                   #we add 10% to the text to push it slightly out from arrows
                  y = (mult + mult/10) * RDA2,
                  label = Label),
              size = arrow_txt_size,
               #otherwise you could use hjust and vjust. I prefer this option
              hjust = 0.5) +
    # Add the text of species
    geom_text(
      data = subset(fmod, Score == &quot;species&quot;),
      aes(colour = &quot;species&quot;,label = Label),
      size = sp_size
    )
}
</code></pre>
<p>è™½ç„¶ä½¿ç”¨ ggRDA å¯ä»¥ç›´æ¥ç»˜åˆ¶å›¾å½¢ï¼Œä½†é€šå¸¸ä¸ºäº†ç¾è§‚ï¼Œå¯¹äºç‰¹å®šçš„å‚æ•°è¿˜éœ€è¦è¿›ä¸€æ­¥çš„è°ƒæ•´ã€‚</p>
<p>æ³¨æ„ï¼Œç”±äºåœ¨ ggRDA ä¸­ä½¿ç”¨äº† vegan::plot.rda ç»˜åˆ¶å›¾åƒï¼Œæ‰€ä»¥åœ¨ä¸‹é¢çš„è°ƒç”¨ ggRDA ä¼šé¦–å…ˆç»˜åˆ¶ä¸€æ¬¡ç®€æ˜“çš„ rda å›¾åƒä¹‹åï¼Œå†æ˜¾ç¤ºå‡º ggplot2 ç»˜åˆ¶çš„å›¾å½¢ï¼Œä¸å½±å“åç»­çš„è¾“å‡ºä¿å­˜ã€‚</p>
<pre><code class="language-R">library(ggvegan)
# Get the amount of explanation by each axis
# gernerally, we choose the first two axes.
exp_by_x &lt;- (as.list(res_rda$CCA$eig)$RDA1)/(res_rda$tot.chi) * 100
exp_by_y &lt;- (as.list(res_rda$CCA$eig)$RDA2)/(res_rda$tot.chi) * 100
    
ggRDA(res_rda, envfit_df = df_env, sp_size = 5) +
    # Generally theme_classic is a good choice to paint a figure
    theme_classic() +
    # In general, we don't need to show the legend in RDA figure
    theme(legend.position = &quot;none&quot;) +
    xlab(paste('RDA1 (', round(exp_by_x, 2), '%)', sep = '')) +
    ylab(paste('RDA2 (', round(exp_by_y, 2), '%)', sep = '')) +
    # scale_XXXXX_manual series provide the ability
    # to define the style of legend by variable value
    scale_size_manual(values = c('ns' = .6,
                                 'sig' = .8)) +
    # Q: What's species here? I don't remember their is a significant level which is called 'species'
    # A: Indeed, their is no significant 'species'. However, 
        # the species name in RDA which is generated from geom_text contains colour attribution.
    scale_colour_manual(values = c(
        'ns' = '#606060',
        'sig' = 'black',
        'species' = 'red'
      )) +
    scale_linetype_manual(values = c('ns' = 8, 'sig' = 1))
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/output_8_1.png" alt="" loading="lazy"></figure>
<p>æœ€åå¾ˆç®€å•äº†ï¼Œä½¿ç”¨ ggsave å°† RDA å›¾ä¿å­˜æˆä½ éœ€è¦çš„æ ¼å¼å°±å¯ä»¥ã€‚</p>
<p>Tips: è‡ªç„¶ç§‘å­¦æœŸåˆŠçš„æŠ•ç¨¿ç³»ç»Ÿé€šå¸¸æ”¯æŒä¸Šä¼  PDF æ ¼å¼çš„å›¾ç‰‡ï¼Œæ ¹æ®å®é™…æƒ…å†µä¹Ÿæ¨èä½¿ç”¨ ggsave è¾“å‡º PDF æ ¼å¼ã€‚</p>
<p>æ­¤æ—¶æ— éœ€è®¾ç½® DPI ä¹Ÿæ— æ³•è®¾ç½® DPIï¼Œè¿™æ˜¯å› ä¸ºï¼Œggsave ä¿å­˜çš„ PDF æ–‡ä»¶ä¼šä¼˜å…ˆå°†å›¾ç‰‡è¾“å‡ºä¸ºçŸ¢é‡å›¾ï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯å›¾ç‰‡æ— è®ºå¦‚ä½•æ”¾å¤§ï¼Œéƒ½ä¸ä¼šå˜å¾—æ¨¡ç³Šï¼Œè€ŒæœŸåˆŠçš„æ’ç‰ˆç³»ç»Ÿä¹Ÿèƒ½å¾ˆå¥½çš„å¤„ç†è¿™ç§çŸ¢é‡å›¾ã€‚</p>
<p>åªè¦ç»™ PDF å›¾ç‰‡è®¾å®šä¸€ä¸ªåˆé€‚çš„å®½é«˜ï¼Œå°±æ— éœ€æ‹…å¿ƒå›¾ç‰‡ä¼šå˜å¾—ä¸æ¸…æ™°ç­‰å¥‡å¥‡æ€ªæ€ªçœ‹ä¼¼ç„å­¦çš„é—®é¢˜äº†ã€‚</p>
<p>ä¸è¿‡å¦‚æœæœ‰ä¿®æ”¹å­—ä½“çš„éœ€æ±‚ï¼Œä¹Ÿè®¸ PDF ä¼šæŠ¥é”™ï¼Œç±»ä¼¼äºå­—ä½“æ— æ³•åµŒå…¥ï¼Œæ­¤æ—¶è¾“å‡ºçš„ PDF æ–‡ä»¶æ‰€æœ‰çš„æ–‡å­—éƒ½ä¼šæ¶ˆå¤±ã€‚å…³äºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåç»­ä¹Ÿè®¸ä¼šè¿›è¡Œè¿›ä¸€æ­¥çš„è®¨è®ºã€‚</p>
<pre><code class="language-R">ggsave('RDA.pdf',width = 7)
</code></pre>
<pre><code>Saving 7 x 7 in image
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[è®¾å¤‡ç®¡ç†å™¨ä¸­çš„ MVSI Card Reader USB Device driver æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ç§»é™¤å…¶å ç”¨ç›˜ç¬¦ï¼Ÿ]]></title>
        <id>https://womeimingzi11.github.io/post/she-bei-guan-li-qi-zhong-de-mvsi-card-reader-usb-device-driver-shi-shi-me-ru-he-yi-chu-qi-zhan-yong-pan-fu/</id>
        <link href="https://womeimingzi11.github.io/post/she-bei-guan-li-qi-zhong-de-mvsi-card-reader-usb-device-driver-shi-shi-me-ru-he-yi-chu-qi-zhan-yong-pan-fu/">
        </link>
        <updated>2020-03-23T07:58:19.000Z</updated>
        <content type="html"><![CDATA[<p>æœ€è¿‘å¾®ç”µè„‘æ·»ç½®äº†ä¸€å—æœºæ¢°ç¡¬ç›˜ï¼Œæ¯•ç«Ÿåœ¨ SSD ä»·æ ¼é£æ¶¨çš„è¿™ä¸ªæ—¶æœŸé‡Œï¼ŒåŸæœ¬è®¡åˆ’ä¸€æ­¥åˆ°ä½ 1T NVME çš„è®¡åˆ’è¢«è…°æ–©è‡³ 512 GBã€‚è™½ç„¶æ—¥å¸¸çš„ä½¿ç”¨ä¸­ä¸ä¼šé‡åˆ°ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯æƒ³è¦ä¿å­˜ä¸€äº›èµ„æ–™ä¾ç„¶æœ‰æ‰è¥Ÿè§è‚˜çš„å±€ä¿ƒæ„Ÿã€‚</p>
<p>ç„¶è€Œå½“ç¡¬ç›˜å®‰è£…åœå½“ï¼Œéœ€è¦è®¾å®šç›˜ç¬¦ä¹‹æ—¶ï¼Œå´å‘ç°ç›˜ç¬¦ç¼–å·å·²ç»è¢«å ç”¨äº†ã€‚åŸæœ¬ç”µè„‘ä¸­çš„ NVME ç¡¬ç›˜ä»…ä¸€ä¸ªåˆ†åŒº C ç›˜ï¼ŒæŒ‰ç…§é¢„æƒ³æœºæ¢°ç¡¬ç›˜åº”è¯¥ç´§æ¥ç€è®¾å®šä¸º D ç›˜ã€‚ç„¶è€Œè®¾å®šèœå•ä¸­æ–°ç›˜ç¬¦å´åªèƒ½ E ç›˜èµ·è·³ï¼Œè¿™è¯´æ˜æœ‰ä¸€ä¸ªè®¾å¤‡å ç”¨äº† D ç›˜ã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/Snipaste_2020-03-22_21-27-53.png" alt="" loading="lazy"></figure>
<p>ç„¶è€Œå®é™…æƒ…å†µæ˜¯ç”µè„‘é™¤äº†ä¸€å— NVME ç¡¬ç›˜å¹¶æ²¡æœ‰å…¶ä»–çš„å­˜å‚¨è®¾å¤‡ã€‚æŸ¥çœ‹è®¾å¤‡ç®¡ç†å™¨çš„ç£ç›˜æŠŠé©±åŠ¨å™¨ç»„ã€‚å‘ç°é™¤äº† <strong>NVME ç¡¬ç›˜</strong>ï¼ˆHS-SSD-C2000pro 512G å…·ä½“äº§å“æ˜¯æµ·åº· C2000 Proï¼‰ã€<strong>æœºæ¢°ç¡¬ç›˜</strong> ï¼ˆHGST XXXX æ—¥ç«‹ä¼ä¸šç¡¬ç›˜ï¼‰ã€<strong>Hyper-V è™šæ‹Ÿç¡¬ç›˜</strong>ï¼ˆMicrosoft è™šæ‹Ÿç£ç›˜ï¼Œè¿™ä¸ªä¸æœ¬æ¬¡çš„è®¨è®ºæ— å…³ï¼‰ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªåä¸º <strong>MVSI Card Reader USB Device driver</strong> çš„è®¾å¤‡ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/Snipaste_2020-03-22_21-29-47.png" alt="Snipaste_2020-03-22_21-29-47" loading="lazy"></figure>
<p>æŒ‰ç…§è®¾å¤‡çš„åå­—ï¼Œå¤§æ¦‚æ˜¯ä¸€æ¬¾ USB è¯»å¡å™¨ã€‚ç„¶è€Œæˆ‘çš„æœºç®±æœ¬èº«(TT å¯èˆªè€… F1 é™éŸ³ç‰ˆ)å¹¶æ²¡æœ‰è¯»å¡å™¨ï¼Œå†µä¸”æˆ‘ä¹Ÿæ²¡æœ‰æ¥å…¥å…¶ä»–çš„ USB è¯»å¡å™¨ï¼Œè«éæ˜¯é¼ æ ‡é”®ç›˜åˆæŠ½é£äº†â€”â€”æ¯•ç«Ÿæ›¾ç»é‡åˆ°è¿‡ USB é”®é¼ æ’å…¥ç”µè„‘åæ— æ³•å¼•å¯¼è®¾å¤‡çš„å¥‡è‘©æ•…éšœã€‚</p>
<p>ä¸è¿‡åœ¨å°è¯•æ’æ‹”é”®é¼ ä¹‹å‰ï¼Œè¿˜æ˜¯å†³å®šå…ˆæŠŠè¿™ä¸ª MVSI Card Reader USB Device driver æœä¸€æœçœ‹çœ‹æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ã€‚ä¸å¹¸çš„æ˜¯æœåˆ°çš„æœ‰æ•ˆç»“æœå¹¶ä¸æ˜¯éå¸¸ä¸°å¯Œã€‚</p>
<figure data-type="image" tabindex="3"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/Snipaste_2020-03-22_21-31-24.png" alt="Snipaste_2020-03-22_21-31-24" loading="lazy"></figure>
<p>è™½ç„¶ç¬¬ä¸€ä¸ªæ¡ç›®ä¼¼ä¹æ˜¯è®¾å¤‡çš„é©±åŠ¨ä¸‹è½½ï¼Œä½†æ˜¯ç‚¹è¿›å»å°±æœ‰ä¸€è‚¡æµ“æµ“çš„ä¸èƒ½è§£å†³é—®é¢˜çš„æ„Ÿè§‰ã€‚ç®€ä»‹åŸºæœ¬ä¸Šæ˜¯æ¨¡å¼åŒ–çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰è®¾å¤‡æœ¬èº«ç›¸å…³çš„å†…å®¹ã€‚æˆªå›¾ä¹Ÿæ˜¯ä¸æ–‡æ— å…³çš„æ ·å­ï¼Œè™½ç„¶æä¾›äº†é©±åŠ¨ç¨‹åºä¸‹è½½çš„é“¾æ¥ï¼Œä½†æ˜¯æˆ‘å¹¶ä¸éœ€è¦ä¸‹è½½é©±åŠ¨å‘€ï¼ŒWindows å·²ç»å¸®æˆ‘è£…å¥½é©±åŠ¨äº†ï¼Œæ•…æ­¤å…ˆå°†è®¾å¤‡æ”¾åœ¨ä¸€è¾¹ã€‚</p>
<figure data-type="image" tabindex="4"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/Snipaste_2020-03-22_22-14-33.png" alt="Snipaste_2020-03-22_22-14-33" loading="lazy"></figure>
<p>ç¬¬äºŒä¸ªæœç´¢æ¡ç›®â€¦â€¦æ—¥è¯­çš„ï¼Ÿå…ˆä¸çœ‹äº†â€¦â€¦</p>
<p>ç¬¬ä¸‰ä¸ªæœç´¢æ¡ç›®ï¼Œæ¬¸ï¼ŒJBL Pebblesï¼Ÿè™½ç„¶é¡µé¢å†…å¹¶æ²¡æœ‰å‡ºç°ä»»ä½• MVSI å­—æ ·ï¼Œä½†æ˜¯å·§åˆçš„æ˜¯ï¼Œæˆ‘çš„ç”µè„‘ä¸Šä¹Ÿæ¥å…¥äº†ä¸€å° JBL Pebbles USB éŸ³ç®±ã€‚</p>
<p>æ­¤æ—¶å†æ‰«ä¸€çœ¼ç¬¬äºŒæ¡æœç´¢æ¡ç›®ï¼Œä¼¼ä¹è¯´åˆ°äº† uaudio0 å­—æ ·ï¼Ÿè™½ç„¶å¯¹äºè®¾å¤‡ unix ä¸‹çš„è®¿é—®åç§°ä¸ç†Ÿæ‚‰â€”â€”å…¶å®æ’åˆ°æˆ‘çš„ MBP ä¸‹å°±èƒ½æŸ¥çœ‹äº†ï¼Œä½†æ˜¯è°è®©æˆ‘æ‡’å‘¢â€”â€”ä¸è¿‡ audio å¤§æ¦‚æ˜¯éŸ³é¢‘è®¾å¤‡çš„ç›¸å…³çš„å§ã€‚è€ç€æ€§å­çœ‹ä½œè€…çš„ Tweetï¼Œä¼¼ä¹åœ¨è¯´è‡ªå·±çš„ JBL Pebbles æ’å…¥ç”µè„‘åä¹Ÿä¼šæœ‰ä¸€ä¸ª Removable SCSI è®¾å¤‡ï¼Œåå­—ä¹Ÿæ˜¯  MVSI Card Reader USB Device driverã€‚</p>
<figure data-type="image" tabindex="5"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/Snipaste_2020-03-22_21-30-53.png" alt="Snipaste_2020-03-22_21-30-53" loading="lazy"></figure>
<p>è€ƒè™‘åˆ°å·§åˆä¸ä¼šåŒæ—¶å‡ºç°ä¸¤æ¬¡ï¼ˆæ— æ¥æºï¼Œæˆ‘ç°ç¼–çš„ï¼‰ï¼Œæœæ–­æ‹”ä¸‹ JBL Pebblesï¼Œè®¾å¤‡ç®¡ç†å™¨ä¸­çš„  MVSI Card Reader USB Device driver è®¾å¤‡æ¶ˆå¤±ï¼Œåœ¨ç£ç›˜ç®¡ç†å™¨ä¸­ä¹Ÿèƒ½å°†æœºæ¢°ç¡¬ç›˜è®¾ç½®æˆä¸º D ç›˜äº†ï¼Œdoneï¼</p>
<figure data-type="image" tabindex="6"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/Snipaste_2020-03-22_22-17-07.png" alt="Snipaste_2020-03-22_22-17-07" loading="lazy"></figure>
<p>äº‹åå›æƒ³èµ·æ¥ï¼ŒçŒœæµ‹æ˜¯å› ä¸ºé‡‡ç”¨ USB è¿æ¥ç”µè„‘çš„ JBL Pebbles éŸ³ç®±ä¼šé‡‡ç”¨ USB DAC çš„æ–¹å¼æ¥å®ç°å·¥ä½œã€‚ä½†å·§åˆçš„æ˜¯è¿™å° USB DAC è¿˜é¢„ç•™äº†è¯»å¡å™¨çš„æ¥å£ï¼Œè™½ç„¶ JBL Pebbles å¹¶æ²¡æœ‰è¯»å¡çš„åŠŸèƒ½ã€‚</p>
<p>ä¸è¿‡è™½ç„¶ç›˜ç¬¦çš„é—®é¢˜å·²ç»è§£å†³äº†ï¼Œä½†æ˜¯å…¶å®è¿˜æœ‰ä¸€ä¸ªå°ç‘•ç–µï¼Œé‚£å°±æ˜¯ Windows Traybar é‡Œé¢ä¼šä¸€ç›´æœ‰ä¸€ä¸ªå¿«é€Ÿç§»é™¤è®¾å¤‡çš„å›¾æ ‡ï¼Œå¹¶ä¸”æ€»æœ‰ä¸€ä¸ªçœç•¥å·è®¾å¤‡ï¼Œä¸”æ— æ³•ç‚¹å‡»ã€‚</p>
<figure data-type="image" tabindex="7"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/Snipaste_2020-03-22_22-09-17.png" alt="Snipaste_2020-03-22_22-09-17" loading="lazy"></figure>
<p>è§£å†³æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œåªè¦ä»è®¾å¤‡ç®¡ç†å™¨ä¸­é€‰ä¸­ MVSI Card Reader USB Device driver ç„¶åå°†å…¶ç¦ç”¨å³å¯ã€‚ç›®å‰æ²¡æœ‰å‘ç°å‰¯ä½œç”¨ã€‚</p>
<figure data-type="image" tabindex="8"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/Snipaste_2020-03-22_22-17-07.png" alt="Snipaste_2020-03-22_22-17-07" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[R for Everything: ä½¿ç”¨ ggplot2 å¯è§†åŒ–æ–°å‹å† çŠ¶ç—…æ¯’è‚ºç‚åœ¨ä¸­å›½çš„ç¡®è¯Šåˆ†å¸ƒ]]></title>
        <id>https://womeimingzi11.github.io/post/map_visualization_covid19_by_ggplot2/</id>
        <link href="https://womeimingzi11.github.io/post/map_visualization_covid19_by_ggplot2/">
        </link>
        <updated>2020-03-08T13:36:10.000Z</updated>
        <content type="html"><![CDATA[<p>è¿™ç¯‡æ–‡ç« å—åˆ° Anisa Dhana çš„åšæ–‡ <a href="https://datascienceplus.com/map-visualization-of-covid19-across-world/">â€˜Map Visualization of COVID-19 Across<br>
the World with Râ€™</a> å¯å‘ï¼Œå°è¯•ä½¿ç”¨ R è¯­è¨€ç»˜åˆ¶æ–°å† è‚ºç‚ COVID-19 åœ¨å›½å†…çš„ç¡®è¯Šã€æ²»æ„ˆå’Œæ­»äº¡åœ°å›¾ã€‚</p>
<h2 id="æ•°æ®å‡†å¤‡">æ•°æ®å‡†å¤‡</h2>
<h3 id="covid-19-data">COVID-19 Data</h3>
<p>ç»˜åˆ¶åœ°å›¾çš„ç¬¬ä¸€æ­¥æ˜¯æ”¶é›†æ•°æ®ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ„Ÿè°¢çº¦ç¿°éœæ™®é‡‘æ–¯ CSSE <a href="https://data.humdata.org/dataset/novel-coronavirus-2019-ncov-cases">Johns Hopkins CSSE</a>, ä»–ä»¬å°†å…¨çƒçš„ç–«æƒ…æ•°æ®æŒ‰ç…§æ—¥æœŸåˆ¶ä½œæˆäº†å•ä¸€çš„ CSV æ–‡ä»¶æ–¹ä¾¿è¿›è¡Œå„ç±»åˆ†æå’Œç»Ÿè®¡ã€‚æˆ‘ä»¬å¯ä»¥ä» <a href="https://github.com/CSSEGISandData/COVID-19">Github</a> é¡µé¢è·å¾—éœ€è¦çš„æ•°æ®ã€‚</p>
<p>P.S. éå¸¸å»ºè®®å¤§å®¶ç›´æ¥ä½¿ç”¨ read_csv ä»æº URL ç›´æ¥è·å–æ•°æ®ï¼Œè¿™æ ·ä¾¿äºæ—¥åç»´æŠ¤æ›´æ–°ã€‚ä½†æ˜¯å› ä¸ºä¸ªäººåŸå› ï¼Œæ¡ˆä¾‹ä¸­ä½¿ç”¨ä¸‹è½½è‡³æœ¬åœ°çš„ csv ä½œä¸ºæ•°æ®æºã€‚æ­¤æ“ä½œä¸å½±å“åç»­çš„ä»»åŠ¡ã€‚</p>
<pre><code>library(tidyverse)

# Read the daily CSV file from Jons Hopkins CSSE I highly recommand to read_csv
# from url directly. But for my personal reason I have to download csv and read
# it from local path.

# df_origin &lt;-
# read_csv('http://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_daily_reports/03-07-2020.csv')
df_origin &lt;- read_csv(&quot;03-07-2020.csv&quot;)

# Replace the slash into underline to make it easyily to filter
names(df_origin) &lt;- names(df_origin) %&gt;% str_replace_all(&quot;/&quot;, &quot;_&quot;)

# Keep the data of mainland and three regions of China
df_cov_china &lt;- filter(df_origin, Country_Region %in% c(&quot;Mainland China&quot;, &quot;Taiwan&quot;, 
    &quot;Hong Kong&quot;, &quot;Macao&quot;))

head(df_cov_china)

## # A tibble: 6 x 8
##   Province_State Country_Region `Last Update`       Confirmed Deaths Recovered
##   &lt;chr&gt;          &lt;chr&gt;          &lt;dttm&gt;                  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
## 1 Hubei          Mainland China 2020-03-07 11:13:04     67666   2959     43500
## 2 Guangdong      Mainland China 2020-03-07 10:43:02      1352      7      1237
## 3 Henan          Mainland China 2020-03-07 11:23:10      1272     22      1244
## 4 Zhejiang       Mainland China 2020-03-07 09:03:05      1215      1      1154
## 5 Hunan          Mainland China 2020-03-07 09:03:05      1018      4       960
## 6 Anhui          Mainland China 2020-03-06 03:23:06       990      6       979
## # ... with 2 more variables: Latitude &lt;dbl&gt;, Longitude &lt;dbl&gt;
</code></pre>
<h3 id="map-data">Map Data</h3>
<p>æˆ‘ä»¬é‡‡ç”¨äº†åŒ…å«ä¸¤å²¸ä¸‰åœ°ã€è—å—ã€é˜¿å…‹èµ›é’¦ä»¥åŠå—æµ·ä¹æ®µçº¿çš„å®Œæ•´ä¸­åäººæ°‘å…±å’Œå›½çš„è¡Œæ”¿åŒºåˆ’åœ°å›¾ã€‚è¿™äº›æ•°æ®å°†ä¼šæ‰˜ç®¡åœ¨ <a href="https://raw.githubusercontent.com/womeimingzi11/womeimingzi11.github.io/master/mapData.zip">Github</a> ä¸Šè¿›è¡Œåˆ†äº«ï¼Œå¤§å®¶å¯ä»¥æŒ‰éœ€å–ç”¨ã€‚</p>
<pre><code>library(rgdal)

# Read China Admistrative Area data from Shapefile.  To avoid the compatibility
# issue across systems, including Unix-like system and Windows. I highly
# recommand to use the file.path function to create the file paths.
map_cn_area &lt;- file.path(&quot;mapData&quot;, &quot;China_adm_area.shp&quot;) %&gt;% readOGR()

## OGR data source with driver: ESRI Shapefile 
## Source: &quot;C:\Users\chenh\OneDrive\Develop Learn\R\Map Visualization of COVID-19 Across China with R\mapData\China_adm_area.shp&quot;, layer: &quot;China_adm_area&quot;
## with 34 features
## It has 10 fields

# Conver the SpatialPolygonsDataFrame to DataFrame which can be held by ggplot2
df_cn_area &lt;- fortify(map_cn_area)

# Read the names of Province or region, and convert the name from PinYin to
# English.  This can match the Province name between WHO data and map data.
ls_province_name &lt;- map_cn_area@data$ID %&gt;% str_replace(&quot;Xianggang&quot;, &quot;Hong Kong&quot;) %&gt;% 
    str_replace(&quot;Aomen&quot;, &quot;Macao&quot;)

# The id is the unique serial to recongize the different province from map data.
ls_id &lt;- unique(df_cn_area$id)

# The orders of id and province name is all the same, the bind operation will
# combine the province name and id in different data.frame Use Proveince_State to
# Join data from WHO data and map data
df_final &lt;- df_cn_area %&gt;% left_join(bind_cols(Province_State = ls_province_name, 
    id = ls_id)) %&gt;% left_join(df_cov_china, by = &quot;Province_State&quot;)

# Read the boundary of provinces and regions from shapefile, it will be a
# SpatialLinesDataFrame
map_cn_bord &lt;- file.path(&quot;mapData&quot;, &quot;China_adm_bord.shp&quot;) %&gt;% readOGR()

## OGR data source with driver: ESRI Shapefile 
## Source: &quot;C:\Users\chenh\OneDrive\Develop Learn\R\Map Visualization of COVID-19 Across China with R\mapData\China_adm_bord.shp&quot;, layer: &quot;China_adm_bord&quot;
## with 1785 features
## It has 8 fields
## Integer64 fields read as strings:  FNODE_ TNODE_ LPOLY_ RPOLY_ BOU2_4M_ BOU2_4M_ID

df_cn_bord &lt;- fortify(map_cn_bord)
</code></pre>
<h2 id="æ•°æ®å¯è§†åŒ–">æ•°æ®å¯è§†åŒ–</h2>
<p>å½“æ‰€æœ‰çš„æ•°æ®å‡†å¤‡å®Œæˆï¼Œä¾¿å¯ä»¥ä½¿ç”¨ ggplot2 è¿›è¡Œå¯è§†åŒ–æ“ä½œã€‚ä½¿ç”¨ geom_polygon æ¥ç»˜åˆ¶ä¸åŒè¡Œæ”¿åŒºï¼Œå› ä¸ºæ•°æ®ç±»å‹æ˜¯ <code>SpatialPolygonsDataFrame</code> è€Œä½¿ç”¨ geom_path æ¥ç»˜åˆ¶è¡Œæ”¿åŒºçš„è¾¹ç•Œï¼Œå› ä¸ºæ•°æ®ç±»å‹æ˜¯<code>SpatialLinesDataFrame</code>ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦é¢å¤–è€ƒè™‘çš„é—®é¢˜æ˜¯ï¼Œå› ä¸ºæ­¦æ±‰çš„æ‚£è€…æ•°é‡æ•°å€äºå›½å†…å…¶ä»–åŒºåŸŸèŒƒå›´å†…çš„æ‚£è€…æ•°é‡ï¼Œæ•…æ­¤ä¸ºäº†èƒ½å¤Ÿè¾ƒä¸ºæœ‰å±‚æ¬¡çš„æ˜¾ç¤ºç—…æ‚£æ•°é‡ï¼Œæˆ‘ä»¬å°†æ•°æ®è¿›è¡Œ<em>å¹³æ–¹æ ¹å¼€æ–¹</em>å¤„ç†ã€‚</p>
<pre><code>library(ggplot2)
# The group is unique serial of each province and region, in this case, it is
# similar with id.  Use geom_polygon to plot the area part, and use geom_path to
# plot the boundary part.  To make the data can be comparable, the patients in
# Hubei Province are multiple times than those in other provinces and regions,
# the data is root-square transformed.
ggplot() + geom_polygon(aes(x = long, y = lat, group = group, fill = sqrt(Confirmed)), 
    data = df_final) + geom_path(aes(x = long, y = lat, group = group), color = &quot;black&quot;, 
    data = df_cn_bord) + labs(caption = &quot;Data Repository provided by Johns Hopkins CSSE. Visualization by Han Chen&quot;) + 
    guides(fill = guide_legend(title = &quot;ç¡®è¯Šäººæ•°\nï¼ˆå¼€å¹³æ–¹å¤„ç†ï¼‰&quot;)) + theme(text = element_text(color = &quot;#22211d&quot;), 
    plot.background = element_rect(fill = &quot;#ffffff&quot;, color = NA), panel.background = element_rect(fill = &quot;#ffffff&quot;, 
        color = NA), legend.background = element_rect(fill = &quot;#ffffff&quot;, color = NA))
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/mapVisualization_confirmed-1.png" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[R for Everything: ä½¿ç”¨ ggplot2 ç»˜åˆ¶ RasterLayer åœ°å›¾]]></title>
        <id>https://womeimingzi11.github.io/post/using-r-for-everything-shi-yong-ggplot2-hui-zhi-rasterlayer-di-tu/</id>
        <link href="https://womeimingzi11.github.io/post/using-r-for-everything-shi-yong-ggplot2-hui-zhi-rasterlayer-di-tu/">
        </link>
        <updated>2020-02-19T12:32:06.000Z</updated>
        <content type="html"><![CDATA[<p>author: Han (<a href="mailto:chenhan28@gmail.com" class="email">chenhan28@gmail.com</a>)<br>
åœ¨æœ€è¿‘åˆšåˆšå®Œæˆçš„ä¸€ç¯‡ SCI æ–‡ç« ä¸­ï¼Œä¸ºäº†æè¿°å®éªŒçš„é‡‡æ ·èŒƒå›´ï¼Œé€šè¿‡ ggplot2 åŒ… (Wickham et al. 2019) å°†ä¸€ç»„ RasterLayer ç»˜åˆ¶æˆä¸ºäº†é’è—é«˜åŸçš„åœ°å½¢å›¾ã€‚è€ƒè™‘åˆ°ä½¿ç”¨ R ç»˜åˆ¶åœ°å›¾çš„ä¸­æ–‡å†…å®¹è¾ƒå°‘ï¼Œæˆ‘ä»¬è¿›è¡Œä¸€æ¬¡å›é¡¾ã€‚</p>
<p><strong>PS å› ä¸ºä¸æ˜¯åœ°ç†æ–¹é¢çš„æ–‡ç« /ä¸“ä¸šï¼Œæ‰€ä»¥åœ¨ä¸“ä¸šæ€§æ–¹é¢æœ‰æ¬ ç¼ºï¼Œä½†å¯¹äºè‡ªç„¶ç§‘å­¦ç±»æ–‡ç« ä¸­è¿›è¡Œå±•ç¤ºåŸºæœ¬ä¸Šæ˜¯è¶³å¤Ÿäº†ã€‚</strong></p>
<h2 id="ä¸ºä»€ä¹ˆç”¨-ggplot2-ç”»åœ°å›¾">ä¸ºä»€ä¹ˆç”¨ ggplot2 ç”»åœ°å›¾ï¼Ÿ</h2>
<p><strong>å› ä¸ºæˆ‘èƒ½ï¼ï¼ˆæ‘Šæ‰‹</strong></p>
<p>å®é™…ä¸ŠåŸå› å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>ggplot2 æ˜¯éå¸¸å¼ºå¤§çš„ç»˜å›¾å·¥å…·ï¼Œé…åˆä¸Š ggplot2 çš„è¡ç”ŸåŒ…ï¼Œè¿™å¥—å·¥å…·é“¾åŸºæœ¬èƒ½æ»¡è¶³ç”Ÿæ€å­¦é¢†åŸŸå‡ ä¹æ‰€æœ‰çš„ç»˜å›¾éœ€æ±‚ã€‚</p>
</li>
<li>
<p>å¦‚æœå¯¹ Photoshop è¿™ç±»å›¾åƒå¤„ç†è½¯ä»¶ç†Ÿæ‚‰ï¼Œå°±ä¼šå‘ç°ä½¿ç”¨ ggplot2 ç”»å›¾ï¼Œé€»è¾‘ä¸Šå’Œ PS æ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œä¾¿äºå¿«é€Ÿä¸Šæ‰‹å’Œä¿®æ”¹ç”Ÿæˆçš„å›¾åƒâ€”â€”å¤©çŸ¥é“æŠŠè‹±æ–‡å›¾æ”¹æˆä¸­æ–‡å›¾æœ‰å¤šçƒ¦äºº</p>
</li>
<li>
<p>æ­¤å¤–ç›¸æ¯”äº ArcGIS è¿™ç±»è½¯ä»¶ R è¿™ç±»è·¨å¹³å°è½¯ä»¶å‡ ä¹å¯ä»¥åœ¨ä»»ä½•ç¯å¢ƒä¸‹å®Œæˆç»˜å›¾ä»»åŠ¡ï¼Œç”šè‡³å¯ä»¥åœ¨å®¶ä¸­çš„æœºé¡¶ç›’å®‰è£… Rï¼Œåªä¸è¿‡æ…¢åˆ°å¤©é•¿åœ°ä¹…è€Œå·²ã€‚</p>
</li>
<li>
<p>å…è´¹å…è´¹å…è´¹</p>
</li>
</ol>
<p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹æœ€ç»ˆçš„å±•ç¤ºæ•ˆæœã€‚<strong>ä¸ºäº†é¿å…æ–‡ç« ç‰ˆæƒå’Œæ•°æ®å…±äº«é—®é¢˜ï¼Œåœ°å›¾ä¸Šæ ·ç‚¹å‡å»é™¤ï¼Œä»…ä¾›å‚è€ƒã€‚</strong></p>
<figure data-type="image" tabindex="1"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/gmap.jpg" alt="Demo without points" loading="lazy"></figure>
<h2 id="ä»€ä¹ˆæ˜¯-rasterlayer">ä»€ä¹ˆæ˜¯ RasterLayerï¼Ÿ</h2>
<p>å…³äº RasterLayer çš„å®šä¹‰ï¼Œåœ¨ <a href="https://rspatial.org/raster/spatial/4-rasterdata.html">Spatial Data Science (Feed the Future n.d.)</a> ä¸­æœ‰å¾ˆå¥½çš„è§£é‡Šã€‚</p>
<blockquote>
<p>A RasterLayer object represents single-layer (variable) raster data. A RasterLayer object always stores a number of fundamental parameters that describe it. These include the number of columns and rows, the spatial extent, and the Coordinate Reference System. In addition, a RasterLayer can store information about the file in which the raster cell values are stored (if there is such a file). A RasterLayer can also hold the raster cell values in memory.</p>
</blockquote>
<p>åœ¨ R ä¸­æåŠçš„ RasterLayer é€šå¸¸æŒ‡çš„æ˜¯ç”± sp åŒ… (Pebesma et al. 2019) æä¾›çš„ RasterLayer ç±»ï¼Œæ¯ä¸€ä¸ª RasterLayer ä»£è¡¨ä¸€å±‚ raster æ …æ ¼æ•°æ®ï¼Œå…¶ä¸­è®°å½•äº† raster æ•°æ®çš„åŸºç¡€ä¿¡æ¯ï¼Œä¾‹å¦‚è¡Œã€åˆ—ã€ç©ºé—´èŒƒå›´ã€å‚è€ƒç³»ã€‚è€Œå¯¹ RasterLayer è¿›è¡Œæ“ä½œæœ€å¸¸ç”¨çš„å·¥å…·æ˜¯ raster åŒ… (Hijmans et al. 2020)ã€‚</p>
<h2 id="æ•°æ®å‡†å¤‡">æ•°æ®å‡†å¤‡</h2>
<p>æ‰€éœ€åŠ è½½åŒ…ï¼š 1. <code>elevatr</code>(Hollister and Shah 2018)ï¼›2. <code>raster</code>ï¼› 3. <code>tidyverse</code> (Wickham and RStudio 2019)</p>
<p>å…·ä½“åˆ°è¿™ä¸€æ¬¡çš„åœ°å›¾ç»˜åˆ¶ä¸­ï¼Œæˆ‘ä»¬éœ€è¦<strong>ä¸¤ä¸ª</strong> RasterLayer â€”â€” 1. ä½œä¸ºèƒŒæ™¯å±‚çš„ <code>bg_rst</code>ï¼Œä»¥åŠ 2.ç”¨ä½œå±•ç¤ºåœ°å½¢çš„ <code>tp_rst</code>ã€‚é‚£ä¹ˆå¦‚ä½•è·å¾—è¿™ä¸¤ä¸ª RasterLayer å‘¢ï¼Ÿ<code>elevatr</code> åŒ…æä¾›äº†ä¸“é—¨ç”¨äºè·å–é«˜ç¨‹æ …æ ¼æ•°æ®çš„æ–¹æ³• <code>get_elev_raster</code>.</p>
<p>ä¸è¿‡åœ¨è·å–é«˜ç¨‹æ•°æ®ä¹‹å‰ï¼Œéœ€è¦é¦–å…ˆæŒ‡å®šåœ°å›¾ç»˜åˆ¶çŸ©å½¢è¾¹ç•Œã€‚ä¹‹åæ–¹å¯ä½¿ç”¨ <code>get_elev_raster</code> æ¥è·å–è¾¹ç•ŒèŒƒå›´å†…çš„é«˜ç¨‹æ•°æ®ï¼Œä½¿ç”¨ <code>z</code> å‚æ•° (zoom) ç¡®å®šç¼©æ”¾ç¨‹åº¦ã€‚å› ä¸ºé€šè¿‡ <code>get_elev_raster</code> è·å–é«˜ç¨‹ raster çš„æ–¹æ³•æ˜¯è·å–æœåŠ¡å™¨ä¸è‡ªå®šä¹‰è¾¹ç•Œçš„æœ€å°å…¬å€æ•°ï¼ˆä¸å‡†ç¡®çš„è¯´æ³•ï¼‰ï¼Œæ‰€ä»¥éœ€è¦å¯¹è·å–çš„åŸå§‹ RasterLayer å†æ¬¡å‰ªåˆ‡ï¼Œä»¥ä¾¿å¾—åˆ°åœ°å›¾ç»˜åˆ¶çŸ©å½¢è¾¹ç•Œå†…çš„æ•°æ®ã€‚</p>
<pre><code class="language-r">library(elevatr)  # Get rasterlay from AWS by `get_elev_raster` fucntion
library(raster)  # Manipulate RasterLayer object
library(tidyverse)  # Tidy is everything.

# Set the extent we want to plot
ext_sample &lt;- extent(70, 105, 25, 45)

# Preparing for getting the elevation raster data, make a blank RasterLayer,
# becasue the first parameter of get_elev_raster is a target Rasterlayer.
bg_init &lt;- raster(ext = ext_sample, resolution = 0.01)
# Get elevation raster with zoom 5, then only keep the extend we want to plot
# later.
bg_rst &lt;- get_elev_raster(bg_init, z = 5) %&gt;% crop(ext_sample)
</code></pre>
<p><code>bg_rst</code> å°±æ˜¯åœ°å›¾èƒŒæ™¯ä¸­ç°è‰²çš„è¾…åŠ©éƒ¨åˆ†çš„æ•°æ®å°±å‡†å¤‡å¥½äº†ã€‚</p>
<pre><code class="language-r"># Let's check the detail of bg_rst, the Background RasterLayer
bg_rst
</code></pre>
<pre><code>## class      : RasterLayer 
## dimensions : 1075, 1591, 1710325  (nrow, ncol, ncell)
## resolution : 0.022, 0.0186  (x, y)
## extent     : 70.008, 105.01, 25.0029, 44.9979  (xmin, xmax, ymin, ymax)
## crs        : +proj=longlat +datum=WGS84 +no_defs 
## source     : memory
## names      : layer 
## values     : -156.1392, 8006.811  (min, max)
</code></pre>
<p>éšåæˆ‘ä»¬éœ€è¦ä¸‹è½½é’è—é«˜åŸçš„å¤šè¾¹å½¢æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©å¼ é•±é”‚ (2002) ç­‰äººåœ¨ã€Šè®ºé’è—é«˜åŸèŒƒå›´ä¸é¢ç§¯ã€‹ä¸€æ–‡æä¾›çš„é’è—é«˜åŸèŒƒå›´ä¸ç•Œçº¿åœ°ç†ä¿¡æ¯ç³»ç»Ÿæ•°æ®ã€‚ä»<a href="http://www.geodoi.ac.cn/WebCn/doi.aspx?Id=135">ã€Šå…¨çƒå˜åŒ–ç§‘å­¦ç ”ç©¶æ•°æ®å‡ºç‰ˆç³»ç»Ÿã€‹</a>ä¸‹è½½å³å¯ã€‚è¿™é‡Œæˆ‘é€‰æ‹©äº† <code>DBATP.zip</code> ä¸‹è½½ï¼Œå¯¹åº”çš„æ–‡ä»¶æ ¼å¼ä¸º Shaplefileï¼Œä½¿ç”¨ rgdal åŒ… (Bivand et al. 2019) æä¾›çš„ <code>readOGR</code> æ–¹æ³•è¯»å–å…¶ä¸­çš„ <code>DBATP_Polygon.shp</code>ï¼Œä¿å­˜çš„æ•°æ®ç±»å‹ä¸º<code>tp_ext</code>ï¼ˆç±»å‹ä¸º SpatialPolygonsDataFrameï¼‰ã€‚ä¹‹åå°†<code>bg_rst</code> æ•°æ®æŒ‰ç…§ <code>tp_ext</code> å½¢çŠ¶è¿›è¡Œå¤„ç†ï¼Œè·å¾—ç¬¦åˆé’è—é«˜åŸèŒƒå›´çš„ RasterLayer <code>tp_rst</code>ã€‚</p>
<pre><code class="language-r">library(rgdal)
# Read the SpatialPolygon File from DBATP_Polygon.shp
tp_ext &lt;- readOGR(&quot;DBATP/DBATP_Polygon.shp&quot;)
</code></pre>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;/Users/chenhan/OneDrive/Develop Learn/R/Blog_Archive/plotMapByGGplot/DBATP/DBATP_Polygon.shp&quot;, layer: &quot;DBATP_Polygon&quot;
## with 1 features
## It has 1 fields
</code></pre>
<pre><code class="language-r"># Keep the shpae of the Tibetan Plateau
tp_rst &lt;- mask(bg_rst, tp_ext)
</code></pre>
<p>ä¸ºäº†ä¾¿äºå®šä½ï¼Œæˆ‘ä»¬è¿˜å°†åœ¨å›¾ç‰‡ä¸Šç»˜åˆ¶åœ°æ ‡åç§° <code>city_ls</code>ï¼Œä»¥åŠé‡‡æ ·ç‚¹ä½ç½®åŠå…¶ç±»å‹ <code>hbt_coord</code>ã€‚</p>
<p>PS.å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µç¡®å®šæ•°æ®çš„å­˜å‚¨ç±»å‹ï¼Œè¿™é‡Œå› ä¸ºä¸ªäººé¡¹ç›®çš„å®é™…æƒ…å†µï¼Œæ•°æ®å¹¶æ²¡æœ‰ä¿å­˜æˆä¸ºå¸¸è§çš„ data.freame æˆ–è€… tibble ä¹‹ç±»çš„ç±»è¡¨æ ¼å½¢å¼ã€‚<strong>æ³¨æ„ç»˜å›¾è¿‡ç¨‹ä¸­å‰åå¯¹åº”å³å¯</strong>ã€‚</p>
<pre><code class="language-r"># Create the list of landmarks which we want to mark
city_ls &lt;- list(x = c(91.1, 86.925278, 101.7781), y = c(29.65, 27.988056, 36.6169), 
    label = c(&quot;Lhasa&quot;, &quot;Qomolangma&quot;, &quot;Xi'Ning&quot;))
str(city_ls)
</code></pre>
<pre><code>## List of 3
##  $ x    : num [1:3] 91.1 86.9 101.8
##  $ y    : num [1:3] 29.6 28 36.6
##  $ label: chr [1:3] &quot;Lhasa&quot; &quot;Qomolangma&quot; &quot;Xi'Ning&quot;
</code></pre>
<pre><code class="language-r"># Read point with latitude and longitude. This operation is not needed for
# everyone, actually it depends on the actual data structure.
hbt_coord &lt;- read_rds(&quot;hbt_coord.rds&quot;) %&gt;% mutate(Ecosystem = ifelse(hbt == &quot;M&quot;, 
    &quot;Alpine Meadow&quot;, &quot;Alpine Steppe&quot;))
str(hbt_coord)
</code></pre>
<pre><code>## tibble [432 Ã— 4] (S3: tbl_df/tbl/data.frame)
##  $ hbt      : chr [1:432] &quot;M&quot; &quot;M&quot; &quot;M&quot; &quot;M&quot; ...
##  $ lon      : num [1:432] 101 101 101 100 100 ...
##  $ lat      : num [1:432] 35.3 35 35 34.5 34.5 ...
##  $ Ecosystem: chr [1:432] &quot;Alpine Meadow&quot; &quot;Alpine Meadow&quot; &quot;Alpine Meadow&quot; &quot;Alpine Meadow&quot; ...
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼Œå‰é¢çš„æ“ä½œä¸­ï¼Œæˆ‘ä»¬è£å‰ª RasterLayer ç”¨åˆ°äº† crop å’Œ mask ä¸¤ç§æ“ä½œï¼Œå…³äºè¿™ä¸¤ç§æ“ä½œçš„è§£é‡Šï¼Œæˆ‘ç”¨ä¸€å¼ å›¾æ¥è§£é‡Šï¼š</p>
<figure data-type="image" tabindex="2"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/JPEG%E5%9B%BE%E5%83%8F-606FC26ACE54-1.jpeg" alt="Differences between crop and mask" loading="lazy"></figure>
<p>ç®€è€Œè¨€ä¹‹ï¼Œä¸¤ç§æ“ä½œéƒ½ä¼šå¾—åˆ°æ›´å°çš„çŸ©å½¢å›¾å½¢ï¼Œä½†æ˜¯ä½¿ç”¨ mask æ–¹æ³•ä¼šåœ¨å¤šè¾¹å½¢åŒºåŸŸå¤–çš„çŸ©å½¢éƒ¨åˆ†å¡«å…… NA ä½¿è¢«è£å‰ª RasterLayer çœ‹èµ·æ¥æˆä¸ºå¤šè¾¹å½¢ã€‚</p>
<h2 id="åœ°å›¾ç»˜åˆ¶">åœ°å›¾ç»˜åˆ¶</h2>
<p>æ‰€éœ€åŠ è½½åŒ…ï¼š <code>scales</code> (Wickham, Seidel, and RStudio 2019)</p>
<p>ä¸è¿‡åœ¨è¿›è¡Œç»˜å›¾ä¹‹å‰ï¼Œè¿˜éœ€è¦å¯¹ RasterLayer æ•°æ®è¿›è¡Œä¸€äº›å°çš„è°ƒæ•´ï¼Œä»¥ä¾¿ä¸ <code>ggplot2</code> çš„åŠŸèƒ½å…¼å®¹ã€‚é¦–å…ˆå°†ä¸¤ä¸ª RasterLayer è½¬æ¢ä¸º data.frame ä¿ç•™ xyï¼Œxy ä¸ºç»çº¬åº¦ï¼Œåº”ç‚¹ä¸Šçš„å€¼å°†ä¼šä¿ç•™æˆä¸ RasterLayer ä¸­ names ç›¸åŒçš„åˆ—åï¼Œæ¯”å¦‚ <code>bg_rst</code> è½¬æ¢ä¸º data.frame ååˆ—åå°±æ˜¯ x, y, layerã€‚ä¹‹åæˆ‘ä»¬å°† layerï¼ˆåœ¨æ­¤å¤„ä¸ºå½“å‰ä¸ºæ­¢çš„æµ·æ‹”é«˜åº¦ï¼‰è½¬æ¢æ•°å€¼èŒƒå›´ï¼Œå› ä¸ºä¿ç•™åŸå§‹çš„æ•°æ®ç”¨ä½œåé¢çš„é€æ˜åº¦ä¼šè®©æ•´å¼ å›¾åƒç°è’™è’™ã€‚</p>
<p>ä¸è¿‡è¦æ³¨æ„çš„æ˜¯ï¼Œæ­£å¦‚æˆ‘ä»¬å‰é¢è¯´åˆ°çš„ mask åçš„ RasterLayer ä¼šå°†åŒºåŸŸå¤–çš„æ•°æ®æ ‡è®°ä¸º NAï¼Œå¦‚æœç›´æ¥ä½¿ç”¨ NA ç»˜å›¾å°†ä¼šå‡ºç°å„ç§å¥‡æ€ªçš„æ•ˆæœï¼Œå› æ­¤æˆ‘ä»¬é€‰æ‹©å°† NA æ•°æ®æ›´æ¢ä¸º 0ï¼Œå°†åŒºåŸŸå†…çš„æ•°æ®æ›´æ¢ä¸º 1ï¼Œå°†ä¸¤ç§å€¼ç”¨ä½œå›¾åƒçš„ alpha å°±ä¼šç»˜åˆ¶å‡ºå‡†ç¡®çš„é’è—é«˜åŸæ ·å¼ã€‚</p>
<p>æ²¡çœ‹æ‡‚å’‹åŠï¼Ÿå‘†èƒ¶å¸ƒï¼åŠ¨æ‰‹è¯•è¯•ä¸è¿›è¡Œ NA è½¬æ¢çš„æ•ˆæœä¾¿çŸ¥é“äº†ã€‚</p>
<pre><code class="language-r"># scales package provide rescale function which can convert the range of numbers
# list to another range.
library(scales)
</code></pre>
<pre><code>## 
## Attaching package: 'scales'

## The following object is masked from 'package:purrr':
## 
##     discard

## The following object is masked from 'package:readr':
## 
##     col_factor
</code></pre>
<pre><code class="language-r"># First convert RasterLayer as Data.Frame with xy coordinate system.  Then
# rescale the elevaion to alpha, as the background part, super high alpha value
# is not a good idea, which range is the best? It depends by the actual. Save the
# alpha value with colname 'alpha'
bg_rst_df &lt;- as.data.frame(bg_rst, xy = TRUE) %&gt;% mutate(alpha = rescale(layer, to = c(0.25, 
    0.75)))

# NA will be generated by the mask function, if use NA and evelation as the alpha
# of Topographic figure, it will be dizzy, and for color Topographic figure
# please don't use the greyscale and color for the evelation simultaneously. Just
# use alpha to control the shape of regional shpae.
tp_rst_df &lt;- as.data.frame(tp_rst, xy = TRUE) %&gt;% mutate(alpha = ifelse(is.na(layer), 
    0, 1))
</code></pre>
<p>å½“æ•°æ®å‡†å¤‡å®Œæ¯•ï¼Œæˆ‘ä»¬å°±å¼€å§‹å›¾å½¢çš„ç»˜åˆ¶ã€‚é¦–å…ˆè¿›è¡Œåœ°å½¢å›¾å åŠ åˆ°èƒŒæ™¯åœ°å½¢çš„ç»˜åˆ¶ã€‚å› ä¸ºå‘½ä»¤è¾ƒå¤šï¼Œå¹¶ä¸”å‡ä»¥æ³¨é‡Šçš„å½¢å¼æ ‡æ³¨åˆ°ä»£ç ä¸­ï¼Œæ•…æ­¤ä¸å†æå‰è®²è§£ã€‚</p>
<pre><code class="language-r"># sacle_parm as a parameter controls the sclae of the hole figure, it will be
# used to control the size of text, point, legend, etc. to fit the size of
# figure.
scale_parm &lt;- 2
# Init ggplot
gmap &lt;- ggplot() + # plot the backgroun layer, set the alpha without color will make a grey
# background
geom_raster(data = bg_rst_df, aes(x = x, y = y, alpha = alpha)) + # plot the topographic layer, set alpha to keep the shape of Tibetan Plateau
# (TP). Color indicates the elevation.
geom_raster(data = tp_rst_df, aes(x = x, y = y, fill = layer, alpha = alpha)) + # terrain.colors is an built-in function to generate a list of color palettes.
# set the legend title of evelation by name parameter.
scale_fill_gradientn(colours = terrain.colors(100), name = &quot;Elevation (m)&quot;) + # As we said before, the alphas is used to determine the shpae of TP, we don't
# need to show them as legends.
scale_alpha(guide = &quot;none&quot;) + # Project this figure as a map but not a normal figure
coord_quickmap() + # Set preset theme makes things easire
theme_minimal() + # Set the limititions of axes. `expand` parameter will remove the gaps between
# the rectangle map and axes.  If you are not sure what's this mean, remove the
# parameter by yourself and you will find it out.
scale_x_continuous(limits = c(70, 105), expand = c(0, 0)) + scale_y_continuous(limits = c(25, 
    45), expand = c(0, 0)) + # Set the titles of axis
labs(x = &quot;Longtitude (E)&quot;, y = &quot;Laitude (N)&quot;) + # remove the background color and background grid, you know the classical
# ggplot's grid, don't you?
theme(panel.grid = element_blank(), panel.background = element_blank()) + # Set the size of axis and legend
theme(axis.title = element_text(size = 7 * scale_parm), axis.text = element_text(size = 6 * 
    scale_parm)) + theme(legend.key.width = unit(0.2 * scale_parm, &quot;cm&quot;), legend.key.height = unit(0.5 * 
    scale_parm, &quot;cm&quot;), legend.text = element_text(size = 5 * scale_parm), legend.title = element_text(size = 6 * 
    scale_parm))

# Preview will slow down the process of operations, I highly recommand do not
# preveiw the ggplot and save it as a file directly.
</code></pre>
<p>ä¸Šè¿°æ“ä½œå®Œæ¯•ï¼Œå¦‚æœæ²¡æœ‰æ„å¤–ï¼Œå°±å¯ä»¥è·å¾—ä¸€å¼ æ•ˆæœå°šå¯çš„åº•å›¾äº†ã€‚ä½†æ˜¯ï¼Œä¸ªäººå¼ºçƒˆå»ºè®®ä¸è¿›è¡Œé¢„è§ˆå›¾åƒï¼Œç›´æ¥è¿›è¡Œåç»­çš„æ“ä½œï¼Œå› ä¸ºç»˜åˆ¶å½“å‰ç²¾åº¦çš„åº•å›¾éœ€è¦èŠ±è´¹è¾ƒé•¿çš„æ—¶é—´ã€‚æˆ–è€…å¯ä»¥ä½¿ç”¨ <code>ggsave</code> æ–¹æ³•è¾“å‡ºä¸ºæ–‡ä»¶è¿›è¡Œé¢„è§ˆï¼Œè¿™æ ·å¦‚æœæ•ˆæœæ»¡æ„ï¼Œå¯ä»¥ç›´æ¥ç”¨ä½œæˆå“ï¼Œé¿å…é¢„è§ˆåå†æ¬¡ç»˜åˆ¶æ•ˆç‡è¾ƒä½ã€‚</p>
<p>éšåæˆ‘ä»¬å†å°†åœ°æ ‡ä¸ºæ­¢æ·»åŠ åˆ°åº•å›¾ä¸Šã€‚</p>
<pre><code class="language-r">gmap &lt;- gmap +
  # Add the city_ls to the main plot as landmarks.
  geom_text(
    mapping = aes(x = x, y = y, label = label),
    # geom_text don't support the structure we used. 
    # convert the list into data.frame, every element is used as column here.
    data = bind_cols(city_ls),
    size = 2 * scale_parm
  )
</code></pre>
<p>æœ€åå°†é‡‡æ ·ç‚¹æ·»åŠ åˆ°åº•å›¾ä¸Šã€‚æ³¨æ„ âš ï¸ ç”±äºç‰ˆæƒå’Œæ•°æ®åˆ†äº«çš„åŸå› ï¼Œæˆ‘å°†é‡‡æ ·ç‚¹çš„åæ ‡è®¾ç½®ä¸º 0ï¼Œ0ï¼Œæ•…æ­¤å›¾ç‰‡ä¸Šä¸ä¼šæ˜¾ç¤ºä»»ä½•é‡‡æ ·ç‚¹ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µè®¾ç½®ï¼</p>
<pre><code class="language-r">gmap &lt;- gmap +
  # Add the sample sites to the main plot as points.
  # Due to the copyright of my scholar article and data share policy, I won't point my sample sites to the picuture, the coordinations of point is 0,0 here.
  geom_point(
    mapping = aes(
      # x = lon,
      x = 0,
      y = 0,
      # y = lat,
      col = Ecosystem,
      shape = Ecosystem
    ),
    data = hbt_coord,
    # Don't set the size as 0 until you don't want to see anything here.
    # Don't set the size as 0 until you don't want to see anything here.
    # Don't set the size as 0 until you don't want to see anything here.
    size = 0 * scale_parm
  ) +
  # Convert the color as legend class, becasuse the shape legend is legend class.
  # If there is no class conversion, the shape and color will be showed as two legends.
  # Then select colour as guides and site a larger size to make it more readable.
  # Don't know what's these means? Commit below code will show you everything.
  scale_color_discrete(guide = &quot;legend&quot;) +
  guides(colour = guide_legend(override.aes = list(size = .8 * scale_parm)))
</code></pre>
<p>å¦‚æœå¯¹è¾“å‡ºç»“æœæ»¡æ„ï¼Œé‚£ä¹ˆå¯ä»¥è·³è¿‡ä¸‹é¢è¿™ä¸€æ­¥ï¼Œç›´æ¥è¿›è¡Œ <code>ggsave</code> æ“ä½œä¿å­˜å›¾åƒã€‚ä¸è¿‡åœ¨è¿™é‡Œï¼Œä¿å­˜å›¾åƒä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¿®æ”¹å›¾ç‰‡çš„ç©ºç™½åŒºåŸŸ margins æ¥è®©å›¾åƒæ›´åˆé€‚ä¸€äº›ã€‚</p>
<pre><code class="language-r">gmap &lt;- gmap +
  theme(plot.margin =
          # Set marigns of figure, the order of parameters is top, right, bottom, left
          unit(
            c(0 * scale_parm, 0 * scale_parm, -.2 * scale_parm, .2 * scale_parm),
            &quot;cm&quot;
          ))
</code></pre>
<p>æœ€åå¯¼å‡ºå›¾åƒå³å¯ã€‚<code>ggsvae</code> æä¾›äº†ä¸°å¯Œçš„å‚æ•°å®šä¹‰è¾“å‡ºçš„å›¾åƒã€‚å¯¹äºéœ€è¦æŠ•ç¨¿ SCI çš„æ–‡ç« ï¼Œé€šå¸¸ Author Guidelines è¦æ±‚æä¾›ä¸ä½äº 300 DPI çš„å›¾ç‰‡æ–‡ä»¶ã€‚å¦‚æœå…è®¸ï¼Œä¿å­˜ä¸º PDF æ–‡ä»¶ä¼šæ˜¯ä¸é”™çš„æ–¹æ³•ï¼Œæ¯•ç«Ÿé€šç”¨æ€§å’Œæ–‡ä»¶å¤§å°éƒ½èƒ½å¾—åˆ°å¾ˆå¥½çš„æ»¡è¶³ã€‚</p>
<pre><code class="language-r">ggsave(filename = &quot;gmap.pdf&quot;, plot = gmap, width = 9 * scale_parm, height = 6.2 * 
    scale_parm, units = &quot;cm&quot;, dpi = 600)
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://picgo-1256649726.cos.ap-chengdu.myqcloud.com/gmap.jpg" alt="" loading="lazy"></figure>
<p>æœ€åï¼Œå¦‚æœæœ‰ä»»ä½•æ›´å¥½çš„æ„è§å’Œå»ºè®®ï¼Œæ¢ç”¨é€šè¿‡ä»»ä½•å½¢å¼ä¸æˆ‘äº¤æµã€‚ç¥å¤§å®¶éƒ½èƒ½åˆ¶ä½œå‡ºä»¤è‡ªå·±ï¼ˆä¸»è¦æ˜¯æ‚å¿—ï¼‰æ»¡æ„çš„ä½œå“ã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®-å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ® [å‚è€ƒæ–‡çŒ®]</h2>
<div id="refs" class="references hanging-indent" markdown="1">
<div id="ref-bivand_rgdal_2019" markdown="1">
<p>Bivand, Roger, Tim Keitt, Barry Rowlingson, Edzer Pebesma, Michael Sumner, Robert Hijmans, Even Rouault, Frank Warmerdam, Jeroen Ooms, and Colin Rundel. 2019. â€œRgdal: Bindings for the â€™Geospatialâ€™ Data Abstraction Library.â€ <a href="https://CRAN.R-project.org/package=rgdal">https://CRAN.R-project.org/package=rgdal</a>.</p>
</div>
<div id="ref-feed_the_future_raster_nodate" markdown="1">
<p>Feed the Future. n.d. â€œRaster Data â€” R Spatial.â€ Blog. <em>Spatial Data Science</em>. Accessed February 19, 2020. <a href="https://rspatial.org/raster/spatial/4-rasterdata.html">https://rspatial.org/raster/spatial/4-rasterdata.html</a>.</p>
</div>
<div id="ref-hijmans_raster_2020" markdown="1">
<p>Hijmans, Robert J., Jacob van Etten, Michael Sumner, Joe Cheng, Andrew Bevan, Roger Bivand, Lorenzo Busetto, et al. 2020. â€œRaster: Geographic Data Analysis and Modeling.â€ <a href="https://CRAN.R-project.org/package=raster">https://CRAN.R-project.org/package=raster</a>.</p>
</div>
<div id="ref-hollister_elevatr_2018" markdown="1">
<p>Hollister, Jeffrey, and Tarak Shah. 2018. â€œElevatr: Access Elevation Data from Various APIs.â€ <a href="https://github.com/jhollist/elevatr">https://github.com/jhollist/elevatr</a>.</p>
</div>
<div id="ref-pebesma_sp_2019" markdown="1">
<p>Pebesma, Edzer, Roger Bivand, Barry Rowlingson, Virgilio Gomez-Rubio, Robert Hijmans, Michael Sumner, Don MacQueen, Jim Lemon, Josh Oâ€™Brien, and Joseph Oâ€™Rourke. 2019. â€œSp: Classes and Methods for Spatial Data.â€ <a href="https://CRAN.R-project.org/package=sp">https://CRAN.R-project.org/package=sp</a>.</p>
</div>
<div id="ref-wickham_ggplot2_2019" markdown="1">
<p>Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, and RStudio. 2019. â€œGgplot2: Create Elegant Data Visualisations Using the Grammar of Graphics.â€ <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>.</p>
</div>
<div id="ref-wickham_tidyverse_2019" markdown="1">
<p>Wickham, Hadley, and RStudio. 2019. â€œTidyverse: Easily Install and Load the â€™Tidyverseâ€™.â€ <a href="https://CRAN.R-project.org/package=tidyverse">https://CRAN.R-project.org/package=tidyverse</a>.</p>
</div>
<div id="ref-wickham_scales_2019" markdown="1">
<p>Wickham, Hadley, Dana Seidel, and RStudio. 2019. â€œScales: Scale Functions for Visualization.â€ <a href="https://CRAN.R-project.org/package=scales">https://CRAN.R-project.org/package=scales</a>.</p>
</div>
<div id="ref-__2002" markdown="1">
<p>å¼ é•±é”‚, æç‚³å…ƒ, and éƒ‘åº¦. 2002. â€œè®ºé’è—é«˜åŸèŒƒå›´ä¸é¢ç§¯.â€ <em>åœ°ç†å­¦æŠ¥</em> 21 (1): 1â€“8. <a href="https://doi.org/10.11821/yj2002010001">https://doi.org/10.11821/yj2002010001</a>.</p>
</div>
</div>
]]></content>
    </entry>
</feed>